define("wkview:widget/doc_header/doc_header.js",function(e,a,i){var t=e("wkcommon:widget/lib/tangram/base/base.js"),n=e("wkcommon:widget/ui/js_core/util/util.js"),o=e("wkcommon:widget/lib/fis/data/data.js"),s=(o.get("WkInfo"),function(e){for(var a=0;a<e.wraps.length;a++)!function(a){n.delegate("#"+e.wraps[a],"a","click",function(i){t.event.stop(i);var n=0==a?1:0;t.g(e.wraps[a]).style.display="none",t.g(e.wraps[n]).style.display="inline"})}(a)});i.exports.docDesc=s});
;define("wkview:widget/doc_info/doc_info.js",function(){});
;define("wkview:widget/edit_doc/edit_doc.js",function(require,exports,module){var T=require("wkcommon:widget/lib/tangram/base/base.js"),D=require("wkcommon:widget/ui/js_core/dialog/dialog.js"),Data=require("wkcommon:widget/lib/fis/data/data.js"),WkInfo=Data.get("WkInfo"),C=require("wkcommon:widget/ui/js_core/category/category.js"),Dialog=function(){var e=null;return function(){return e||(e=D.dialogCreate()),e}}(),editDoc=function(vo){var GUID=T.lang.guid(),_on=function(e,t,i){return T.g(e)?T.event.on(e,t,i):void 0},_viewTpl={creater:{editTitle:{normal:'<a href="'+(4==WkInfo.DocInfo.flag?"/lec":"")+'/new?act=update&id={docId}&fr=view" title="\u66f4\u6539\u6587\u6863\u540d\u79f0"><b class="ic ic-editTitle"></b></a>',update:'<b class="ic ic-editTitle" title="\u60a8\u4fee\u6539\u7684\u5185\u5bb9\u6b63\u5728\u63d0\u4ea4\u4e2d"></b>'},editDesc:{normal:'<a href="'+(4==WkInfo.DocInfo.flag?"/lec":"")+'/new?act=update&id={docId}&fr=view" title="\u66f4\u6539\u6587\u6863\u7b80\u4ecb"><b class="ic ic-editDesc"></b></a>',update:'<b class="ic ic-editDesc" title="\u60a8\u4fee\u6539\u7684\u5185\u5bb9\u6b63\u5728\u63d0\u4ea4\u4e2d"></b>'},editPrice:'<a id="editDocPrice" title="\u8d22\u5bcc\u503c\u8bbe\u5b9a" href="javascript:void(0);"><b class="ic view-sps ic-price"></b></a>',editCate:'<a id="editDocCate" title="\u66f4\u6539\u5206\u7c7b" href="javascript:void(0);"><b class="ic ic-editCate"></b></a>'},admin:function(e){e=e||[];for(var t,i=['<a id="__ID__" href="javascript:void(0);" class="bt ui-btn ui-btn-26-light" title="__TITLE__" >','<b class="btc">','<b class="btText">__TITLE__</b>',"</b>","</a>"].join(""),o=0,n=e.length,a=[];n>o;o+=1)t=e[o],a.push(i.replace(/__ID__/g,t.id).replace(/__TITLE__/g,t.title));return a.join("")}},_cases={creater:function(){var creater=_viewTpl.creater,docId=WkInfo.DocInfo.docId;T.g("edit-docTitle").innerHTML=creater.editTitle[vo.status].replace("{docId}",docId),T.g("edit-docDesc").innerHTML=creater.editDesc[vo.status].replace("{docId}",docId),T.g("edit-docPrice").innerHTML=creater.editPrice,T.g("edit-docPrice").style.display="",T.g("page-curmbs").innerHTML+=creater.editCate,T.event.on("editDocPrice","click",function(){T.ajax.post("/doc/interface/docCount",["atype=docCount&","doc_id="+WkInfo.DocInfo.docId].join(""),function(xhr,responseText){_task.editPrice(eval("("+responseText+")").downloadCount)})}),T.event.on("editDocCate","click",_task.editCat)},admin:function(){var e=T.g;e("page-curmbs").innerHTML+=_viewTpl.admin(vo.list),e("docCreater")&&(e("docCreater").innerHTML+='\u3000<a href="http://wenku.baidu.com/filter?uname='+WkInfo.DocInfo.creater+'" class="bt ui-btn ui-btn-26-light" target="_blank"><b class="btc"><b class="btText">\u7ba1\u7406</b></b></a>'),_on("adminEditCat","click",_task.editCat),_on("adminDelDoc","click",_task.delDoc),_on("adminSetPrivate","click",_task.setPrivate),_on("adminAddLibrary","click",_task.addLibrary)},all:function(){_cases.creater(),_cases.admin()}},_task={editCat:function(){var e,t,i,o="category-wrap-"+T.lang.guid(),n=WkInfo.DocInfo.cats.split("-");Dialog().confirm({title:"\u66f4\u6539\u5206\u7c7b",content:'<div id="'+o+'" class="ml20"></div><div class="category-edit-tips mt10 ml20"></div>',width:635,height:340,onRendered:function(){e=T.g(o),t=T.q("category-edit-tips")[0],i=C.categoryCreate({el:e,defaults:n,doctype:WkInfo.DocInfo.docTypeNum})},onOk:function(){if(i.check()){var e=i.getCategory(),o=top.location.href;T.ajax.post(WkInfo.Urls.submitClassUpdate,["ct=20006&","doc_id="+WkInfo.DocInfo.docId+"&","cid1="+e[0]+"&","cid2="+e[1]+"&","cid3="+e[2]+"&","cid4="+e[3]+"&","new_upload=1&","retType=newResponse&","oe=json&","opuid="+T.url.getQueryValue(o,"opuid")+"&","opuname="+T.url.getQueryValue(o,"opuname")+"&","power="+T.url.getQueryValue(o,"power")+"&","token="+T.url.getQueryValue(o,"token")].join(""),function(e,t){try{t=T.json.parse(t)}catch(i){}Dialog().alert(0==t.errno?{title:"\u63d0\u793a",content:"\u60a8\u7684\u6587\u6863\u5206\u7c7b\u4fee\u6539\u6210\u529f\uff01",onOk:function(){location.reload(!0)}}:{title:"\u63d0\u793a",content:t.msg})})}else t.innerHTML=i.getMsg(),T.dom.addClass(t,"c-red")}}),i.on("onChange",function(){i.check(),T.dom.removeClass(t,"c-red"),t.innerHTML=i.getMsg()})},editPrice:function(e){var t=e>=100&&0!=WkInfo.DocInfo.price?"\u60a8\u7684\u6587\u6863\u5df2\u88ab\u4e0b\u8f7d"+e+"\u6b21\uff08\u5efa\u8bae\u60a8\u4fee\u6539\u4e3a\u514d\u8d39\u6587\u6863\uff0c\u4e0e\u5404\u4f4d\u7f51\u53cb\u514d\u8d39\u5206\u4eab\u4f60\u7684\u6587\u6863\u54e6~\uff09":"\u60a8\u7684\u6587\u6863\u5df2\u88ab\u4e0b\u8f7d"+e+"\u6b21",i=['<dl class="edit-docprice">',"<dt>\u8bf7\u9009\u62e9\u4e0b\u8f7d\u6240\u9700\u79ef\u5206\uff1a</dt>","<dd>",'<form id="editPrice-'+GUID+'" action="'+WkInfo.Urls.submitPriceUpdate+'" method="post">','<input class="radio-price" name="sell" type="radio" value="0" />\u514d\u8d39','<input class="radio-price edit-docprice-pay" name="sell" type="radio" value="1" />','<input type="hidden" name="retType" value="num">','<input type="hidden" name="ct" value="20007">','<input type="hidden" name="doc_id" value="{docId}">','<input type="hidden" name="new_upload" value="1">','<input type="hidden" name="lu" value="http://wenku.baidu.com/view/{docId}.html">','<select id="selectDocPrice-'+GUID+'" name="price">','<option value="0">0</option>','<option value="1">1</option>','<option value="2">2</option>','<option value="5">5</option>','<option value="8">8</option>','<option value="10">10</option>','<option value="20">20</option>',"</select>",'<a href="http://www.baidu.com/search/wenku/help.html#\u5982\u4f55\u5408\u7406\u6807\u4ef7">\u5982\u4f55\u5408\u7406\u6807\u4ef7</a>',"</form>","</dd>",'<dd style="margin-top:10px;color:red;">'+t+"</dd>","</dl>"].join("");Dialog().confirm({title:"\u66f4\u6539\u4e0b\u8f7d\u5206\u6570",content:i.replace(/{docId}/g,WkInfo.DocInfo.docId),width:380,height:220,onRendered:function(){var e=T.q("radio-price"),t=T.g("selectDocPrice-"+GUID),i=T.g("selectDocPrice-"+GUID).getElementsByTagName("option");T.event.on(t,"change",function(){e[1].checked="checked"}),T.event.on(e[0],"click",function(){i[0].selected=!0}),0==WkInfo.DocInfo.price?(e[0].checked="checked",i[0].selected=!0):(e[1].checked="checked",T.array.each(i,function(e){e.value==WkInfo.DocInfo.price&&(e.selected=!0)}))},onOk:function(){0==T.g("editPrice-"+GUID).sell.value&&(T.g("editPrice-"+GUID).price.value=0),T.ajax.form(T.g("editPrice-"+GUID),{async:!0,onsuccess:function(e,t){var i={errno:-1};try{i=T.json.parse(t)}catch(o){}Dialog().alert(0==t||0==i.errno?{title:"\u4fee\u6539\u63d0\u793a",content:"\u4fee\u6539\u79ef\u5206\u6210\u529f\uff01",onOk:function(){window.location.reload()}}:{title:"\u4fee\u6539\u63d0\u793a",content:"\u4fee\u6539\u79ef\u5206\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01"})}}),Dialog().hide()}})},delReason:function(){for(var e=[{value:6,reason:"\u542b\u6709\u5e7f\u544a"},{value:13,reason:"\u590d\u5236\u767e\u5ea6\u5176\u4ed6\u4ea7\u54c1"},{value:9,reason:"\u6807\u9898\u4e0d\u89c4\u8303"},{value:8,reason:"\u5f71\u54cd\u9605\u8bfb"},{value:5,reason:"\u4e0d\u826f\u4fe1\u606f"},{value:7,reason:"\u5185\u5bb9\u4e0d\u5b8c\u6574"},{value:14,reason:"\u6cc4\u9732\u4e2a\u4eba\u4fe1\u606f"},{value:31,reason:"\u6709\u7248\u6743\u4fb5\u6743\u4e89\u8bae"}],t="",i=0;i<e.length;i++)t+='<label for="sub_status_'+i+'"><input type="radio" value="'+e[i].value+'" name="sub_status" id="sub_status_'+i+'"><span>'+e[i].reason+"</span></label>";return t},delDoc:function(){T.dom.query("input[name='sub_status']",T.g("delDoc"))[0];Dialog().confirm({title:"\u8bf7\u9009\u62e9\u5220\u9664\u539f\u56e0",width:360,height:225,btnText:["\u5220\u9664","\u53d6\u6d88"],content:'<div class="delReason" id="delReason">'+_task.delReason()+"</div>",onOk:function(){for(var e=T.dom.query("input[name='sub_status']",T.g("delReason")),t=!1,i=0;i<e.length;i++)if(e[i].checked){t=e[i].value;break}if(t){var o=T.dom.query("input[name='sub_status']",T.g("delDoc"))[0];o.value=t,T.ajax.form(T.g("delDoc"),{async:!0,onsuccess:function(e,t){Dialog().alert(0==t?{title:"\u5220\u9664\u63d0\u793a",width:280,height:160,content:"\u5220\u9664\u6587\u6863\u6210\u529f\uff01",onOk:function(){window.location.reload()}}:{title:"\u5220\u9664\u63d0\u793a",width:280,height:160,content:"\u5220\u9664\u6587\u6863\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01"})}})}},onRendered:function(){var e=T.g("WkDialogOk");e.className="bt ui-btn ui-btn-26-disabled mv10";var t=T.g("delReason").getElementsByTagName("label");T.array.each(t,function(t){T.on(t,"click",function(){e.className="bt ui-btn ui-btn-26-green mv10"})})}})},setPrivate:function(){confirm("\u786e\u8ba4\u8be5\u6587\u6863\u8f6c\u4e3a\u79c1\u6709\u5417\uff1f")&&T.ajax.form(T.g("setPrivate"),{async:!0,onsuccess:function(e,t){Dialog().alert(0==t?{title:"\u6210\u529f\u63d0\u793a",width:280,height:220,content:"\u6587\u6863\u8f6c\u4e3a\u79c1\u6709\u6210\u529f\uff01",onOk:function(){window.location.reload()}}:{title:"\u5931\u8d25\u63d0\u793a",width:280,height:220,content:"\u6587\u6863\u8f6c\u4e3a\u79c1\u6709\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01"})}})},addLibrary:function(){T.g("addLibrary").submit()}};_cases[vo.who]()};module.exports.editDoc=editDoc});
;define("wkview:widget/doc_remind/doc_remind.js",function(){});
;define("wkview:widget/doc_upload/doc_upload.js",function(){});
;define("wkview:widget/userEvaluation/userEvaluation.js",function(t,e,a){var i=t("wkcommon:widget/ui/lib/jquery/jquery.js"),n=t("wkcommon:widget/lib/tangram/base/base.js"),o=t("wkcommon:widget/ui/js_core/log/log.js");a.exports.userEvaluation=function(t){var e=["","\u5f88\u5dee","\u8f83\u5dee","\u8fd8\u884c","\u63a8\u8350","\u529b\u8350"],a="/doc/submit/value",t=i("#"+t),s=t.find(".evaluate-title"),u=t.find(".value-star"),l=t.find(".value-tip"),r=t.siblings(".value-pop"),c=+t.attr("data-value")||-1,v=+t.attr("data-doc-value")||0,d=0,h=t.attr("data-id"),f=this,m={ct:"20009",doc_id:h,value_score:null};this.init=function(){this.initValue(),0>c&&this.initEvent()},this.initValue=function(){this.getData(),c>0&&(s.html("\u5df2\u8bc4\u4ef7: "),this.evaluate(c+1))},this.getData=function(){var t="/doc/interface/docCount?viewCountIncr=1&doc_id="+h+"&sl="+window.screenLeft;i.getJSON(t,function(t){v=(t.float_valueAverage/2).toFixed(1),n.lang.eventCenter.dispatchEvent("docCount.response",{data:t})})},this.evaluate=function(t){t--,u.each(function(e,a){t>=e?i(a).removeClass("ic-star-t-off").addClass("ic-star-t-on"):i(a).addClass("ic-star-t-off").removeClass("ic-star-t-on")}),l.html(e[t+1])},this.initEvent=function(){var t=null;u.each(function(e,a){var n=i(a);n.hover(function(){t&&clearTimeout(t),0>c&&f.evaluate(e+1)},function(){0>c&&(t=setTimeout(function(){f.evaluate(0)},50))}),n.click(function(){0>c&&(d=e+1)&&f.submit(e+1)})})},this.disabledForm=function(){f.evaluate(v),c=v},this.showTotalTips=function(t){t&&(r.find("p").html(t),r.fadeIn(500))},this.hideTotalTips=function(){r.fadeOut(500)},this.submitCallBack=function(t){switch(+t){case 0:f.evaluate(d),c=d,f.showTotalTips("\u8bc4\u4ef7\u6210\u529f\uff01"),s.html("\u60a8\u5df2\u8bc4\u4ef7\uff1a");break;case 45:f.showTotalTips("\u4e0d\u80fd\u8bc4\u4ef7\u81ea\u5df2\u7684\u6587\u6863\uff01"),n.lang.eventCenter.dispatchEvent("user-evaluation-error"),f.disabledForm();break;case 6:f.showTotalTips("\u60a8\u4e4b\u524d\u5df2\u7ecf\u8bc4\u4ef7\u8fc7\u4e86\uff01"),n.lang.eventCenter.dispatchEvent("user-evaluation-error",{btnTxt:"\u5df2\u8bc4\u4ef7"}),f.evaluate(d),c=d,s.html("\u60a8\u5df2\u8bc4\u4ef7\uff1a");break;case 4:f.showTotalTips("\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\uff01"),n.lang.eventCenter.dispatchEvent("user-evaluation-error"),f.disabledForm();break;case 5:f.showTotalTips("\u4f11\u606f\u4e00\u4e0b\u518d\u8bc4\u4ef7\u5427\uff01");break;default:f.showTotalTips("\u7cfb\u7edf\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01")}setTimeout(function(){f.hideTotalTips()},1500)},this.submit=function(t){return 1>t||t>5?void f.showTotalTips("\u63d0\u4ea4\u6570\u636e\u5931\u8d25"):(m.value_score=t,o.xsend(1,100030,{value_score:m.value_score}),void i.post(a,m,function(t){try{"string"===i.type(t)&&(t=i.parseJSON(t))}catch(e){}f.submitCallBack(t.errno,t.float_value_average)}))}}});
;define("wkview:widget/relate_book/relate_book.js",function(e,t,n){var o=e("wkcommon:widget/ui/lib/jquery/jquery.js"),i=e("wkcommon:widget/ui/js_core/log/log.js"),r=e("wkcommon:widget/ui/js_core/mvp/template/template.js").template,c=function(){function e(e,t){var n=0,o=0;str_cut=new String,o=e.length;for(var i=0;o>i;i++)if(a=e.charAt(i),n++,escape(a).length>4&&n++,str_cut=str_cut.concat(a),n>=t)return str_cut=str_cut.concat("...");return t>n?e:void 0}function t(){try{o.getJSON(x,{doc_id:f},function(e){var t=e.data;t.info&&t.info.total_count&&(q=t.info.total_count,_=t,n(t))})}catch(e){}}function n(t){t.substr=e,p=o(r(b,t)),w.replaceWith(p),g=p.find(".page-pre").eq(0),m=p.find(".page-next").eq(0),v=p.find(".page-item"),k=p.find(".bd").eq(0),s(),c(),d(j),i.xsend(1,100084)}function c(){g.on("click",l),m.on("click",u),v.each(function(e,t){o(t).on("click",function(){return j=e,d(e),s(),!1})}),k.delegate("li","mouseenter",function(){o(this).hasClass("special")||(o(this).siblings("li").removeClass("on"),o(this).addClass("on"))})}function s(){return j>0?g.removeClass("page-null"):g.addClass("page-null"),q-1>j?m.removeClass("page-null"):m.addClass("page-null"),v.removeClass("page-cur"),v.eq(j).addClass("page-cur"),i.xsend(1,100085,{act:"page",pn:j}),!1}function l(){return j>0&&(j--,d(j),s()),!1}function u(){return q-1>j&&(j++,d(j),s()),!1}function d(t){var n,a=_.list;a[t].substr=e,n=o(r(C,a[t])),k.empty().append(n)}var f,p,g,m,v,k,_,h={},w=o(".aside .relate-doc"),b=o("#relateBookTpl").val(),C=o("#relateBookListTpl").val(),j=0,q=0,x="/rec/main/getrecbookbundles";return h.init=function(e){f=e,t()},h}();n.exports.relateBook=c});
;define("wkview:widget/down_doc/down_doc.js",function(e,t,a){var o=e("wkcommon:widget/lib/tangram/base/base.js"),n=e("wkcommon:widget/ui/js_core/dialog/dialog.js"),i=e("wkcommon:widget/lib/fis/data/data.js"),c=i.get("WkInfo"),l=(i.get("UserInfo"),e("wkcommon:widget/ui/js_core/log/log.js")),r=function(){var e=null;return function(){return e||(e=n.dialogCreate()),e}}(),s=function(){var e=function(e){this.vo=e};return o.object.extend(e.prototype,{init:function(){this.toggleSize()},show:function(){var e=o.g(this.vo.el),t=o.g(this.vo.panel);e.style.display="block"==e.style.display?"none":"block",t.style.display="block"==t.style.display?"none":"block",this.bind(),this.setCode("normal")},bind:function(){var e=this;o.event.on(this.vo.view,"click",function(){var t="normal"==e.statusType?!0:!1,a={viewImg:t?"450-500":"630-500",viewSize:t?"450*500":"630*500",width:t?520:700,height:t?660:660,content:'<div class="viewReader"><p><img src="http://img.baidu.com/img/iknow/docshare/{viewImg}.jpg" alt="" /></p>\u5c3a\u5bf8 {viewSize}pix</div>'};r().alert({title:"\u5206\u4eab\u6587\u6863",content:a.content.replace(/{(viewImg|viewSize)}/g,function(e,t){return a[t]}),width:a.width,height:a.height,btnText:["\u8fd4\u56de"],onOk:function(){r().hide()}})}),o.event.on(this.vo.closePanel,"click",function(){var t=o.g(e.vo.el),a=o.g(e.vo.panel);t.style.display="none",a.style.display="none"}),o.event.on(this.vo.copy,"click",function(){e.copyToClipboard()})},setCode:function(e){var t=this,a=this.vo.toggleSize,n=this.vo.codeText,i=['<object width="{width}" height="{height}" align="middle" id="reader" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">','	<param value="window" name="wmode">','	<param value="true" name="allowfullscreen">','	<param name="allowscriptaccess" value="always">','	<param value="{value}" name="movie">','	<embed width="{width}" align="middle" height="{height}" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" name="reader" src="{value}" wmode="window" allowscriptaccess="always" bgcolor="#FFFFFF" ver="9.0.0"></embed>',"</object>"].join(""),l=function(e){var t="http://wenku.baidu.com/static/flash/{reader}?docurl=http://wenku.baidu.com/play&amp;docid={docId}&amp;title={docTitle}&amp;doctype={docType}&amp;fpn={pg}&amp;npn={pg}&amp;readertype=external&catal={catal}&amp;cdnurl={cdn}",a={reader:"txt"===c.DocInfo.docType?"txtreader.swf":"apireader.swf",docId:c.DocInfo.docId,docTitle:encodeURIComponent(c.DocInfo.title),docType:c.DocInfo.docType,pg:"txt"==c.DocInfo.docType?50:5,catal:c.DocInfo.catal,cdn:"http://txt.wenku.baidu.com/play"};return t=t.replace(/{(reader|docId|docTitle|docType|pg|catal|cdn)}/g,function(e,t){return a[t]}),e.replace(/{value}/g,t)},r={normal:function(){o.g(n).value=l(i.replace(/{width}/g,450).replace(/{height}/g,500)),t.statusType="normal",o.g(a[0]).checked="true",o.g(a[1]).checked=""},big:function(){o.g(n).value=l(i.replace(/{width}/g,630).replace(/{height}/g,500)),t.statusType="big",o.g(a[0]).checked="",o.g(a[1]).checked="true"}};r[e]()},showDetail:function(){alert(1);var e=o.g("show_detail_down");o.event.on(e,"click",function(){window.open("http://wenku.baidu.com/view/58aa2640e45c3b3567ec8bd5.html")})},toggleSize:function(){var e=this,t=this.vo.toggleSize;o.array.each(t,function(a,n){o.event.on(o.g(a),"click",function(){o.g(t[0==n?1:0]).checked="",this.checked="true",e.setCode(/normalSize-\d+/.test(a)?"normal":"big")})})},copyToClipboard:function(e){var e=o.g(this.vo.codeText).value;if(l.send("api","share",{subtype:"copy"}),window.clipboardData)window.clipboardData.clearData(),window.clipboardData.setData("Text",e),o.g(this.vo.copyResult).innerHTML="\u590d\u5236\u6210\u529f\uff01";else if(-1!=navigator.userAgent.indexOf("Opera"))window.location=e;else if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(t){alert("\u88ab\u6d4f\u89c8\u5668\u62d2\u7edd\uff01\n\u8bf7\u5728\u6d4f\u89c8\u5668\u5730\u5740\u680f\u8f93\u5165'about:config'\u5e76\u56de\u8f66\n\u7136\u540e\u5c06'signed.applets.codebase_principal_support'\u8bbe\u7f6e\u4e3a'true'")}var a=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!a)return;var n=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!n)return;n.addDataFlavor("text/unicode");var i=new Object,i=(new Object,Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString)),c=e;i.data=c,n.setTransferData("text/unicode",i,2*c.length);var r=Components.interfaces.nsIClipboard;if(!a)return!1;a.setData(n,null,r.kGlobalClipboard),o.g(this.vo.copyResult).innerHTML="\u590d\u5236\u6210\u529f\uff01"}alert("\u4f60\u7684\u6d4f\u89c8\u5668\u7981\u7528\u4e86\u81ea\u52a8\u590d\u5236\u529f\u80fd\uff0c\u8bf7\u4f60\u624b\u52a8\u590d\u5236\u3002"),o.g(this.vo.codeText).select()}}),e}(),d=function(e){var t=new s(e);return t.init(),t};a.exports.shareToCreate=d});
;define("wkview:widget/other_like_doc/other_like_doc.js",function(){});
;define("wkview:widget/relate_doc/relate_doc.js",function(){});
;define("wkview:widget/resource_recom_youke/resource_recom_youke.js",function(e){e.async(["wkcommon:widget/ui/lib/jquery/jquery.js","wkcommon:widget/lib/tangram/base/base.js","wkcommon:widget/ui/js_core/log/log.js","wkview:widget/ui/underscore/underscore.js","wkcommon:widget/lib/fis/data/data.js","wktopic:widget/ui/tab/tab.js"],function(e,t,o,i,n,c){var a=n.get("WkInfo"),s=a.DocInfo.docId;e.ajax({url:"/portal/interface/DocTbxxInfoDocs?doc_id="+s+"&t="+(new Date).getTime(),async:!0,type:"get",success:function(t){if(0===t.status.code){o.xsend(1,100655);var n=e("#resource-youke");n.html(i.template(e("#resource-youke-tpl").html(),{resourceList:t.data})),n.find("a.disabled").on("click",function(e){e.preventDefault()}),new c({mod:n,tabContent:".tabcontent",tabSite:".tabsite",delayTime:100,indexControl:"hover"})}}})})});
;define("wkview:widget/same_series_doc/same_series_doc.js",function(){});
;define("wkview:widget/doc_reader/doc_reader.js",function(require,exports,module){var baidu=require("wkcommon:widget/lib/tangram/base/base.js"),$=require("wkcommon:widget/ui/lib/jquery/jquery.js"),T=baidu,util=require("wkcommon:widget/ui/js_core/util/util.js"),viewUtil=require("wkview:widget/ui/util/util.js"),log=require("wkcommon:widget/ui/js_core/log/log.js"),login=require("wkcommon:widget/ui/js_core/login/login.js").login,Data=require("wkcommon:widget/lib/fis/data/data.js"),WkInfo=Data.get("WkInfo"),tipsCreate=require("wkcommon:widget/ui/js_core/tips/tips.js").tipsCreate,flashReaderCreater=require("wkview:widget/ui/flashReaderCreater/flashReaderCreater.js").flashReaderCreater,bd=baidu,bdD=bd.dom,bdE=bd.event,bdSwf=bd.swf,bdL=bd.lang,bdO=bd.object,bdCookie=bd.cookie,guid=bdL.guid(),_instance=!1,_option={},_savedBookmark=!1,_currentScreen="window",toolsList=[],currentToolsId=!1,arrhideBlock=["#bd .reader_tools_bar",".user-bar","#hd","#page-curmbs","#bd .hd",".other-like-doc","#bd .aside","#ft","#bd .ft",".relate-doc",".doc-header","#docBubble","#wk-2d-bar-code"],_init=function(){var e=_option,t=bdD.g(e.container);t.innerHTML=['<div id="reader_wrap_'+guid+'">','<div id="reader_box_'+guid+'" class="flash_reader_box">','<div id="reader_container_'+guid+'" style="height:100%;"></div>',"</div>","</div>"].join(""),e.container=t,e.readerWrap=bd.g("reader_wrap_"+guid),e.readerBox=bd.g("reader_box_"+guid),e.readerContainer=bd.g("reader_container_"+guid);var o=bd.browser.firefox;if(o&&13>o){var r=bdD.q("main")[0];bdD.setStyles(r,{position:"absolute",width:"716px"})}_savedBookmark=!!parseInt(e.newmark.split("|")[0]),_resize(),_createReader(),"undefined"!=typeof PDC&&(PDC.mark("c_tti_renderPlayer"),console.log("c_tti_renderPlayer"))},_resize=function(){var e,t=_option,o=_isPPt();e=o?574:baidu.page.getViewHeight(),e=300>e?300:e,t.height=e,t.readerWrap.style.height=e+"px",t.readerBox.style.height=_getReaderBoxH()+"px";var r=_getReader();r&&(r.height=_getReaderBoxH()),"window"!=_currentScreen&&_resizeReaderContainer()},_getReaderBoxH=function(){return _option.height},_isPPt=function(){return/(ppt|pps|pot|pptx|dps)/.test(_option.docType)},_transferData=function(e){return viewUitl.transferData(e)},_getViewedPage=function(){var e=_option.docID;return viewUtil.getViewedPage(e)},_getBookmark=function(){var e=bdCookie.get("newMark");if(e){if(e=e.split("|"),e[0]!==_option.docID)return"0|0";e=e.slice(1,3).join("|");var t=location.pathname;t=t.slice(0,t.lastIndexOf("/")),bdCookie.remove("newMark",{path:t+"/"})}else e=_getViewedPage();return e},_createReader=function(){var e=_option,t=encodeURIComponent(["\u6211\u6b63\u5728@\u767e\u5ea6\u6587\u5e93 \u9605\u8bfb\u3010",WkInfo.DocInfo.title,"\u3011\u8fd9\u7bc7\u6587\u7ae0\uff0c\u63a8\u8350\u7ed9\u5927\u5bb6\uff01\u7528\u6587\u5e93\u5ba2\u6237\u7aef\u53ef\u4ee5\u514d\u8d22\u5bcc\u503c\u4e0b\u8f7d\u8be5\u6587\u6863\uff0c\u5ba2\u6237\u7aef\u4e0b\u8f7d\u5730\u5740\uff1ahttp://",location.host+"/apps?fr=2001 \u60f3\u7acb\u5373\u9605\u8bfb\u8be5\u6587\u6863\u70b9\u8fd9\u91cc\uff1a"].join("")),o=encodeURIComponent("http://img.baidu.com/img/iknow/wenku/erweima2001.jpg"),r=encodeURIComponent(location.href),i=["http://service.weibo.com/share/share.php?appkey=2273341579","url="+r,"title="+t,"pic="+o].join("&"),n=["http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+r,"title="+t,"pic="+o].join("&");flashReaderCreater({el:e.readerContainer,id:"reader_"+guid,sectionId:e.sectionId,templateType:e.templateType||"doc",vars:{docid:e.docID,ext:e.docType,bookmark:_getBookmark(),cid:e.cid,cid1:e.cid1,cid2:e.cid2,cid3:e.cid3,catal:e.catal,isLogin:e.isLogin,newmark:e.newmark,isPayDoc:e.isPayDoc,availablePageNum:e.availablePageNum,share1_url:n,share2_url:i,price:e.price,totalpage:parseInt(WkInfo.DocInfo.totalPageNum,10)}}),_bind(),T.browser.firefox&&T.platform.isX11&&(T.lang.eventCenter.addEventListener("DialogShowAfter",function(){T.dom.g("mask").style.background="transparent"}),T.lang.eventCenter.addEventListener("WkLogin.showAfter",function(){T.dom.g(WkLogin.dialog._mask._eid).style.backgroundColor="",WkLogin.dialog._mask.bgColor=""}))},_getReader=function(){return bdSwf.getMovie("reader_"+guid)},_readerScroll=function(e){var t=e>0?-3:3,o=_getReader();o.NS_IK_doMouseWheel(t)},_bind=function(){var e=function(){var e=T.dom.query("embed",_option.readerContainer),t=T.dom.query("object",_option.readerContainer);return e.length?e[0]:t.length?t[0]:null}();e&&T.on(e,"focus",function(){T.lang.eventCenter.dispatchEvent("flash-reader-focus"),console.log("flash reader focus")}),bdE.on(_option.readerContainer,"mousewheel",function(e){var e=e||window.event,t=e.originalEvent.wheelDelta;_readerScroll(t),bdE.stop(e)}),baidu.browser.firefox&&_option.readerContainer.addEventListener("DOMMouseScroll",function(e){var e=e||window.e,t=e.detail;_readerScroll(-t),bdE.stop(e)},!1);var t={37:"left",39:"right"},o={left:function(){_getReader().NS_IK_leftKeyCode()},right:function(){_getReader().NS_IK_rightKeyCode()}};bdE.on(document,"keydown",function(e){var e=e||window.event,r=e.which||e.keyCode,i=t[r];i&&(o[i](),log.send("view","keycode"+i))}),util.windowResize(_resize)},_jumpToReader=function(){T.lang.eventCenter.dispatchEvent("flash-reader-focus"),"screen"!=_currentScreen&&("fuckIE"===window.docReaderHideIEtxt?setTimeout(function(){window.docReaderHideIEtxt=0},1500):viewUtil.scrollToEl(_option.readerWrap))},_setBookMark=function(e){var t=_getReader(),o=(_option.isLogin,_option.isPrivate),r=[],i=1,n=1,d='<FONT FACE="\u5b8b\u4f53" SIZE="12" COLOR="#000000">\u8be5\u6587\u6863\u4e3a\u79c1\u6709\u6587\u6863\uff0c\u6682\u65e0\u6cd5\u4f7f\u7528\u4e66\u7b7e\u529f\u80fd\u3002</FONT>',a='<FONT FACE="\u5b8b\u4f53" SIZE="12" COLOR="#000000">\u6dfb\u52a0\u4e66\u7b7e\u6210\u529f\uff0c\u53ef\u4ee5\u8fdb\u5165\u6211\u4e66\u623f\u4e2d\u67e5\u770b</FONT><FONT><a target="_blank" href="/room?fr=view">>>\u70b9\u51fb\u67e5\u770b</a></FONT>',s='<FONT FACE="\u5b8b\u4f53" SIZE="12" COLOR="#000000">\u6dfb\u52a0\u4e66\u7b7e\u6210\u529f\uff01<br/>\u65b0\u6dfb\u52a0\u7684\u4e66\u7b7e\u5c06\u8986\u76d6\u4e4b\u524d\u7684\u4e66\u7b7e\u3002</FONT><FONT><a target="_blank" href="/room?fr=view">>>\u70b9\u51fb\u67e5\u770b</a></FONT>',l='<FONT FACE="\u5b8b\u4f53" SIZE="12" COLOR="#f00000">\u6dfb\u52a0\u4e66\u7b7e\u5931\u8d25\uff0c\u8bf7\u60a8\u7a0d\u540e\u91cd\u65b0\u5c1d\u8bd5\uff01</FONT>';return o?(t.showNewMarkInfo(d,0),!1):(e?(r=e.split("|"),i=r[0],n=r[1]):(i=t.NS_IK_getPagethOnClose(),n=t.NS_IK_getPageOffset(),e=[i,"|",n].join("")),void login.checksynch(function(){bd.ajax.post(_option.$SUBMIT$,["ct="+_option.$NEW_MARK$,"doc_id="+_option.docID,"page="+i,"offset="+n].join("&"),function(e,o){var r=bd.json.parse(o);r.save?_savedBookmark?t.showNewMarkInfo(s,1):(t.showNewMarkInfo(a,1),_savedBookmark=!0):t.showNewMarkInfo(l,0)})},function(){_saveViewedPage(),_toggleScreen(0),t.NS_IK_exitFullscreen(),login.log()}))},_saveViewedPage=function(){{var e=_option.docID,t=_getReader();bdCookie.get("viewedPg")}try{var o=t.NS_IK_getPagethOnClose(),r=t.NS_IK_getPageOffset()}catch(i){return}viewUtil.saveViewedPage(e,o,r)},_toggleScreen=function(e){e?setTimeout(_doScreen,100):setTimeout(_doWindow,100)},_doScreen=function(){if("screen"!=_currentScreen&&!_isPPt()){_currentScreen="screen";var e=_option,t=(e.readerContainer,0),o=arrhideBlock.length,r=baidu.browser.firefox;if(r&&13>r){e.readerWrap.style.marginTop="1px";var i=bdD.q("main")[0];i.style.width="txt"===e.docType?"900px":"100%"}for(;o>t;t++){var n=bdD.query(arrhideBlock[t])[0];n&&bdD.addClass(n,"reader_fullScreen_hidden")}_resize(),bdD.query(".body")[0].style.margin="0",r&&13>r||(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"),_resizeReaderContainer()}},_resizeReaderContainer=function(){var e=_option,t=e.readerContainer,o=e.docType,r=bdD.query(".page")[0],i=baidu.page,n=i.getViewHeight();n=300>n?"300px":"100%";var d=i.getViewWidth();d=400>d?"400px":"100%";var a=baidu.browser.firefox;t.style.cssText="height:"+n+";width:"+d,"txt"!=o?r.style.width="auto":(r.style.width=a?"980px":"900px",document.body.style.backgroundColor="#3a3734",a&&setTimeout(function(){document.documentElement.style.backgroundColor="#3a3734"},100)),r=null},_doWindow=function(){if("window"!=_currentScreen&&!_isPPt()){_currentScreen="window";var e=_option,t=(e.readerContainer,bdD.query(".page")[0]),o=e.docType,r=0,i=arrhideBlock.length,n=baidu.browser.firefox;if(n&&13>n){e.readerWrap.style.marginTop="";var d=bdD.q("main")[0];d.style.width="716px"}for(;i>r;r++){var a=bdD.query(arrhideBlock[r])[0];a&&bdD.removeClass(a,"reader_fullScreen_hidden")}_resize(),bdD.query(".body")[0].style.margin="",n&&13>n||(document.body.style.overflow="",document.documentElement.style.overflow=""),t.style.width="","txt"==o&&(document.body.style.backgroundColor="#fff"),document.documentElement.style.backgroundColor="#fff",baidu.browser.ie||setTimeout(function(){document.body.style.backgroundColor="transparent",document.documentElement.style.backgroundColor="transparent"},300),util.ieReflow(),t=null}},getTips=function(){var e=bdD.g("reader_tools_tip"+guid);if(!e){var t=['<div class="mod ui-panel ui-panel-'+WkInfo.DocInfo.docType+' trg-bl reader_tools_tips" id="reader_tools_tip'+guid+'">','<div class="tips-wrap">','<span class="trangle"></span>','<div class="inner">','<div class="hd">','<span class="act">','<a href="###" class="ir close reader_tips_close">&Chi;</a>',"</span>","</div>",'<div class="bd">','<div class="reader_tools_tips_content_wrap" id="reader_tools_tips_content_wrap_'+guid+'"></div>','<div class="reader_tools_tips_btn_wrap" id="reader_tools_tips_btn_wrap_'+guid+'"></div>',"</div>","</div>","</div>",'<iframe style="width:100%;height:100%;" frameborder="0"></iframe>',"</div>"].join("");bdD.insertHTML(_option.readerBox,"beforeEnd",t),e=bdD.g("reader_tools_tip"+guid),bdE.on(e,"click",function(t){var t=t||window.event,o=bdE.getTarget(t);bdD.hasClass(o,"reader_tips_close")&&tipsHide(),bdD.hasAttr(o,"data-tips-resolve")&&(tipsHide(),bdL.eventCenter.dispatchEvent(currentToolsId.replace("_panel",".resolve"),e)),bdD.hasAttr(o,"data-tips-reject")&&(tipsHide(),bdL.eventCenter.dispatchEvent(currentToolsId.replace("_panel",".reject"),e))})}return e=bdD.g("reader_tools_tip"+guid)},tipsHide=function(){var e=$(".reader_tools_tips"),t=_getReader();bdL.eventCenter.dispatchEvent("readerToolsTips.hideBefore",{tips:e}),e.hide(),t.NS_IK_unpopPanel&&t.NS_IK_unpopPanel(),bdL.eventCenter.dispatchEvent("readerToolsTips.hideAfter",{tips:e})},bindTools=function(e){var t=e+"_panel",o=null;return function(){return tipsHide(),o=getTips(),bdD.removeClass(o,currentToolsId),currentToolsId=t,bdL.eventCenter.dispatchEvent(e+".click",{show:function(e){if(t===this.getCurrentToolsId()){var e=bd.object.extend({content:""},e);o.style.width=e.width+"px",o.style.height=e.height+"px";var r=this.getContainer(),i=bdD.g("reader_tools_tips_btn_wrap_"+guid),n=e.btnText;if($(r).empty(),bdL.isElement(e.content)?(r.appendChild(e.content),e.content.style.display="block"):r.innerHTML=e.content,n){var d=['<a href="###" class="bt ui-btn ui-btn-26-green mr10" data-tips-resolve="1"><b class="btc" data-tips-resolve="1"><b class="btText" data-tips-resolve="1">'+n[0]+"</b></b></a>",'<a href="###" class="bt ui-btn ui-btn-26-light mr10" data-tips-reject="1"><b class="btc" data-tips-reject="1"><b class="btText" data-tips-reject="1">'+(n[1]||"")+"</b></b></a>"];i.innerHTML=1==n.length?d[0]:d.join(""),i.style.display="block"}else i.style.display="none";bdL.eventCenter.dispatchEvent("readerToolsTips.showBefore",{tips:o}),bdD.addClass(o,t),o.style.display="block",bdL.eventCenter.dispatchEvent("readerToolsTips.showAfter",{tips:o})}},hide:function(){tipsHide()},getCurrentToolsId:function(){return currentToolsId},getContainer:function(){return bdD.g("reader_tools_tips_content_wrap_"+guid)}}),!1}},isLogin=function(e){var e=e||"";return WkInfo.PageInfo.isLogin?!0:(login.log(null,null,{fromMod:e}),!1)},MONITOR_SEND=function(e,t){var o,r="http://static.tieba.baidu.com/tb/pms/img/st.gif?p=112&b=0&";if(o=1==t?view.BCS_MIGRATE_BEFORE||.5:view.BCS_MIGRATE_AFTER||.5,Math.random()<o){r+=e;var i=new Image;i.src=r}"undefined"==typeof PDC||window.WK_PDC_TTI_FLAG||(PDC.tti(),PDC.mark("fs"),setTimeout(function(){PDC.send&&PDC.send()},1e3),window.WK_PDC_TTI_FLAG=!0,console.log("fs"))},doc_reader={create:function(e){return _instance?_instance:(e=bdO.extend({newmark:0,catal:0,docType:0,tools:[]},e),e.docType=viewUtil.docTypeNumToString(e.docType),e.container&&e.docID?(_option=e,_init(),_instance={getGuid:function(){return guid},resize:_resize,isPPt:_isPPt,getReader:_getReader,screen:_currentScreen,getCurrentToolsId:function(){return currentToolsId}},bdL.module("view.jumpToReader",_jumpToReader),bdL.module("view.saveViewedPage",_saveViewedPage),bdL.module("view.MONITOR_SEND",MONITOR_SEND),bdL.module("wenku.setBookMark",_setBookMark),bdL.module("wenku.toggleScreen",_toggleScreen),bdL.module("wenku.isLogin",isLogin),bdL.module("wenku.AS_SHARE_1",tipsHide),bdL.module("wenku.AS_SHARE_2",tipsHide),bdL.module("wenku.AS_UNPOP_JS_PANEL",tipsHide),bdL.module("wenku.AS_SHARE_3",bindTools("weixin")),bdL.module("wenku.AS_SHARE_MORE",bindTools("share")),bdL.module("wenku.AS_ADD_DOC_FOLDER",bindTools("addAlbum")),bdE.on(window,"unload",_saveViewedPage),$(document).on("click",function(e){$(e.target).parents(".reader_tools_tips").length||$(e.target).parents(".tree-node").length||$(e.target).hasClass("tree-node")||$(e.target).parents(".flash_reader_box").length||tipsHide()}),window.MONITOR_SEND=MONITOR_SEND,_instance):void 0)}};module.exports.doc_reader=doc_reader,module.exports.addAlbum=function(e){var _VCT={view:{noAlbum:{title:"\u63d0\u793a",style:{width:260,height:70},tpl:'<p class="noalbum">\u60a8\u8fd8\u6ca1\u6709\u6587\u8f91\uff0c\u8bf7<a href="/album/new">\u521b\u5efa\u6587\u8f91</a></p>',dom:function(e){return e.tpl}},hasAlbum:{title:"\u52a0\u5165\u6587\u8f91",style:{width:358,height:222},tpl:'<dl class="addAblum"><dt>{title}</dt><dd><form method="post" id="form-AddAblum" action="/album/submit/albumAddDoc">{viewDom}<input type="hidden" value="20017" name="ct" /><input type="hidden" value="http://wenku.baidu.com/view/{docid}.html" name="docs[0]"><input type="hidden" name="radio" value="" /><input type="hidden" name="newtype" value="1" /></form></dd></dl>',itemTpl:'<p><input id="album-{ablumId}" value ="{ablumId}" name="album_id" type="radio" {checked} />{albumTitle}</p>',dom:function(e,t){var o="";T.array.each(t,function(r,i){var n=0==i?'checked="checked"':"";o+=e.itemTpl.replace(/{ablumId}/g,t[i].album_id).replace("{albumTitle}",t[i].title).replace("{checked}",n)});var r=WkInfo.DocInfo.title;return r=T.string.getByteLength(r)<26?r:T.string.subByte(r,26,"..."),e.tpl=e.tpl.replace("{title}","\u628a&nbsp;&nbsp;<strong>"+r+"&nbsp;&nbsp;</strong>\u6587\u6863\u52a0\u5165\u6587\u8f91").replace("{viewDom}",o).replace("{docid}",WkInfo.DocInfo.docId),e.tpl}},alertCon:'<div class="addAblum-alert">{con}</div>'},cases:function(){WkInfo.UserInfo.userGradeNum<1?_VCT.tasks.gradeError():_VCT.tasks.getAblumList()},tasks:{gradeError:function(){e.show({title:"\u51fa\u9519\u5566\uff01",content:_VCT.view.alertCon.replace("{con}","\u4e00\u7ea7\u7528\u6237\u6682\u65f6\u8fd8\u4e0d\u80fd\u521b\u5efa\u6587\u8f91<br/>\u518d\u52a0\u628a\u6cb9\u54e6\uff01"),width:260,height:120})},getAblumList:function(){T.ajax.post("/album/async","type=user_album",function(xhr,responseText){var ablbumList=eval("("+responseText+")");_VCT.tasks.selcetAblum(ablbumList)})},selcetAblum:function(t){var o=0==t.length?"noAlbum":"hasAlbum",r=_VCT.view[o];if(0==t.length)e.show({title:r.title,content:r.dom(r,t),width:r.style.width,height:r.style.height});else{e.show({title:r.title,content:r.dom(r,t),width:r.style.width,height:r.style.height,btnText:["\u52a0\u5165","\u53d6\u6d88"]});var i=function(){_VCT.tasks.post(),baidu.lang.eventCenter.removeEventListener("addAlbum.resolve",i)};baidu.lang.eventCenter.addEventListener("addAlbum.resolve",i)}},post:function(){T.ajax.form(T.g("form-AddAblum"),{async:!0,onsuccess:function(t,o){var r={};try{r=T.json.parse(o)}catch(i){}var n="0"==r.errno?0:1,d=[{title:"\u52a0\u5165\u6587\u8f91\u6210\u529f",content:'<div class="reader_tips_fav"><b class="fav_sucess ic"></b><strong>\u52a0\u5165\u6587\u8f91\u6210\u529f</strong></div>',width:200,height:120},{title:"\u52a0\u5165\u6587\u8f91\u5931\u8d25",content:"\u8be5\u6587\u6863\u5df2\u7ecf\u52a0\u5165\u5230\u8be5\u6587\u8f91<br/>\u4e0d\u80fd\u91cd\u590d\u6dfb\u52a0",width:260,height:150}];e.show({title:d[n].title,content:_VCT.view.alertCon.replace("{con}",d[n].content),width:d[n].width,height:d[n].height,btnText:["\u786e\u5b9a"]})}})}}};_VCT.cases()}});
;define("wkview:widget/doc_reader/move.model.js",function(e,o,t){var i=e("wkcommon:widget/lib/tangram/base/base.js"),r=e("wkcommon:widget/ui/js_core/mvp/model/model.js").Model,n=e("wkview:widget/ui/view/mediator/mediator.js").mediator,d=e("wkcommon:widget/lib/fis/data/data.js"),s=d.get("WkInfo"),a=i.lang.createClass(function(e){this._init(e)},{superClass:r}).extend({mediator:n,_init:function(){this.mediator.on("m:create-dir",i.fn.bind(this.createDir,this)),this.mediator.on("m:move-docs",i.fn.bind(this.moveDocs,this)),this.mediator.on("m:get-fold-sons",i.fn.bind(this.getFoldSons,this)),this.mediator.on("m:get-view-fold-info",i.fn.bind(this.getViewFoldInfo,this))},getViewFoldInfo:function(e){var o,t=e.promise,i=e.data;return o={app:"get_view_fold_info",fold_id:i.id||0},this._request(s.Urls.interfaceGetViewFoldInfo,o,function(e,o){t.resolve(o)}),t},getFoldSons:function(e){var o,t=e.promise,i=e.data;return o={app:"get_fold_son",fold_id:i.id||0},this._request(s.Urls.interfaceGetFoldSon,o,function(e,o){t.resolve(o)}),t},moveDocs:function(e){var o,t=e.promise,i=e.data;return o={ct:20145,doc_id_str:i.doc_id,intodoc_fold_id:i.to,fold_id:i.fold_id},this._request(s.Urls.submitDocMove,o,function(e,o){t.resolve(o)}),t},createDir:function(e){var o=e.promise,t=e.data,i=t.parent_fold_id,r={ct:20142,parent_fold_id:t.parent_fold_id,fold_name:t.fold_name};return this._request(s.Urls.submitFoldCreate,r,function(e,t){o.resolve({response:t,current:1,parent_fold_id:i})}),o},_request:function(e,o,t){var r=this;i.ajax.request(e,{method:"post",data:["fold_request",encodeURIComponent(i.json.stringify(o))].join("="),async:!1,onsuccess:function(e,o){o=i.json.parse(o),o.error_no&&o.error_no-0>0?r.mediator.fire("p:modelError",o):t(e,o)},onfailure:function(){r.mediator.fire("p:modelError",{request_error:!0})}})}});t.exports.MoveModel=a});
;define("wkview:widget/doc_reader/movetree.js",function(e,t,o){var i=e("wkcommon:widget/lib/tangram/base/base.js"),n=e("wkcommon:widget/lib/fis/data/data.js"),d=e("wkview:widget/ui/view/mediator/mediator.js").mediator,a=e("wkcommon:widget/ui/js_core/mvp/view/view.js").View,r=e("wkcommon:widget/ui/js_core/util/util.js"),s=e("wkcommon:widget/ui/js_core/tree/tree.js").Tree,l=r.delegate,c=i.lang.createClass(function(e){this._init(e)},{superClass:a}).extend({mediator:d,template:{type:"template",view:i.g("move-tree-template").value},_init:function(){this.moveTree=null,this.targetTreeNode=null,this.mediator.on("v:expand-move-node",i.fn.bind(this.expandNode,this)),this.mediator.on("v:show-move-tree",i.fn.bind(this.showMovetree,this)),this.mediator.on("v:create-folder",i.fn.bind(this.createFolder,this)),this.mediator.on("v:show-move-tip",i.fn.bind(this.showMoveTip,this))},showMoveTip:function(e){var t=e.data,o=i.g("move-tree-tip");o&&(o.innerHTML=t.tip,o.style.display="",setTimeout(function(){o.style.display="none"},2e3))},showMovetree:function(e){var t,o,d,a=this,r=n.get("WkInfo"),c=e.data,u="";r.DocInfo.payPrice||(u='<p class="wk-app-tip" style="margin-top:12px;">\u7528\u6587\u5e93\u624b\u673a\u5ba2\u6237\u7aef\u968f\u65f6\u67e5\u770b\u8be5\u6587\u6863\u3002<a href="http://wenku.baidu.com/apps?fr=1002" target="_blank">\u6ca1\u6709\u5ba2\u6237\u7aef\uff1f</a></p>'),i.g("store-move-box").innerHTML=['<div id="store-move-tree"></div>','<div class="operate-line">','<a href="###" class="move-new">','<b class="fm-icons ic-new ic"></b>',"\u65b0\u5efa\u6587\u4ef6\u5939","</a>",'<span id="move-tree-tip" style="display:none"></span>',"</div>",'<div class="move-btns-line">','<a href="###" class="bt ui-btn ui-btn-26-green movetree-btns confirm-move"><b class="btc"><b class="btText">\u786e\u8ba4</b></b></a>','<a href="###" class="bt ui-btn ui-btn-26-light movetree-btns cancel-move"><b class="btc"><b class="btText">\u53d6\u6d88</b></b></a>',"</div>"+u].join(""),(this.moveTree=s.create({fieldIndentifier:"id",fieldChilds:"nodes",parent:i.g("store-move-tree"),oninit:function(e){i.event;t=e,l(t.parent,"#new-dir-title","keydown",function(e){13==e.keyCode&&a.doCreate(e)}),l(t.parent,".tree-node","click",t.toggle),l(t.parent,".cancel-create","click",function(){var e=a._getNodeById("new");a.targetTreeNode=null,e&&e.remove()}),l(t.parent,".confirm-create","click",function(e){a.doCreate(e)})},onreader:function(e){return a.renderView(a.template,{node:e})},toggle:function(e){var o,n,d=i.g,r=i.dom,s=r.hasClass,l={},c=i.event.getTarget(e),u=!i.dom.hasClass(c,"has-dir");if(i.event.preventDefault(e),(o=t._getNode(e))&&!s(d(o.did),"isLocked")){if(o.getStatus("new"))return!1;u||1!=o.getStatus("expand")?(o.setStatus("loading",!0),l={dom:o,id:o.data.id},u&&((n=t.getFocused())&&n.setStatus("selected",!1),o.setStatus("selected",!0),t.setFocused(o,0),a.targetTreeNode=o),a.mediator.fire("p:get-move-tree",{data:l}),o.setStatus("loading",!1),"has-dir"==o.data.triangle&&o.setStatus("expand",!0)):(o.setStatus("expand",!1),o.removeAll())}return!1},statusClasses:{selected:a.hasSelected},_getNode:function(e){return t.node4target(i.event.getTarget(e))}})).loadChilds([{render:"root",title:"\u6211\u7684\u6587\u5e93",id:"0"}]),o=this._getNodeById(0),o.setStatus("selected",!0),t.setFocused(o),a.targetTreeNode=o,c=this._formatData(c),c=this._rearrangeData(c),o.loadChilds(c),(d=this._getNodeById(r.DocInfo.fold_id))&&(o.setStatus("selected",!1),t.setFocused(d),d.setStatus("selected",!0)),this.bindEvent()},bindEvent:function(){var e=this.moveTree,t=this;l(i.g("store-move-box"),".move-new","click",function(){if(!t._getNodeById("new")){var o=t._getNodeById(0),n=e.getFocused();n&&(n.setStatus("selected",!1),n.setStatus("expand",!1));for(var d=0,a=o.childNodes.length;a>d;d++)n=o.childNodes[d],n.setStatus("expand",!1),n.removeAll();n=null,o.setStatus("selected",!0),e.setFocused(o,0),t.targetTreeNode=o,o.setStatus("selected",!1),o=o.insertChild({id:"new",op:"new"}),o.setStatus("selected",!0),o.setStatus("new",!0),e.setFocused(o),i.g("new-dir-title").focus(),i.g("new-dir-title").select()}}),l(i.g("store-move-box"),".confirm-move","click",function(){var e,o=t.targetTreeNode,d=n.get("WkInfo");return t._getNodeById("new")||!o?!1:(o&&(e={to:o.data.id,doc_id:d.DocInfo.docId,fold_id:d.DocInfo.fold_id},i.cookie.set("last-store-folder",o.data.id,{path:"/",expires:31536e6}),t.mediator.fire("p:do-move",{data:e})),void t.hidePop())}),l(i.g("store-move-box"),".cancel-move","click",function(){t.hidePop()})},hidePop:function(){var e=null;(e=i.dom.query(".reader_tools_tips",i.g("doc_reader"))[0])&&e.parentNode.removeChild(e),(e=i.g("fav-bottom-tip"))&&e.parentNode.removeChild(e)},doCreate:function(e){var t,o,n=i.g("new-dir-title"),d=i.string.trim(n.value),a=this.moveTree;return 0==d?!1:new RegExp('[\\\\/:*?"<>\\|]').test(d)||d.length>50?(n.style.background="rgb(252, 167, 167)",!1):(t=a._getNode(e),t.setStatus("loading",!0),o={parent_fold_id:0,fold_name:d},void this.mediator.fire("p:create-dir",{data:o}))},createFolder:function(e){var t=this,o=e.data;if(!i.g("store-move-tree"))return!1;var n=this._getNodeById(o.parent_fold_id),d=this.moveTree;return d?(this.removeNewDirNode(),void(n&&(n=n.insertChild(this._formatData(o.data)[0]),d.setFocused(n),n.setStatus("selected",!0),t.targetTreeNode=d.getFocused()||null))):!1},removeNewDirNode:function(){var e=this._getNodeById("new");e&&e.remove()},expandNode:function(e){var t=e.data;this._getNodeById(t.id).loadChilds(this._formatData(t.fold_son||[]))},_getNodeById:function(e){var t=this.moveTree;return t.node4target(["node",t.handler,e].join("-"))},_formatData:function(e){var t,o=(i.array.indexOf,i.string.encodeHTML),n=[],d={};i.lang.isArray(e)||(e=[e]);for(var a=0,r=e.length;r>a;a+=1)t=e[a],"root"==t.render?n.push(t):(d.id=t.fold_id,d.fold_name=o(this._cutTitle(t.fold_name,t.level)),d.full_name=o(t.fold_name),d.hasdir=t.hasdir,d.son=t.son_level,d.level=t.level,d.parent=t.parent,d.triangle=+t.hasdir?"has-dir":"no-dir"),n.push(d),d={};return n},_rearrangeData:function(e){var t,o,n=0,d={},a=[];for(i.lang.isArray(e)||(e=[e]),t=e.length;t>n;n+=1)o=e[n],"undefined"!=typeof d[o.parent]?d[o.parent].push(o):d[o.parent]=[o],"undefined"!=typeof d[o.id]&&("undefined"!=typeof o.nodes?o.nodes.push(d[o.id]):o.nodes=d[o.id]),"0"===o.parent&&a.push(o);return a},_cutTitle:function(e,t){return this._cutString(e,[14,13,12,11,10,9,8,7,6][+t],"...")},_cutString:function(e,t,o){e=e.toString();var i=e.length;return"undefined"==typeof o&&(o=""),i?0>t||t>=i?e:[e.slice(0,t),o].join(""):o}});o.exports.Movetree=c});
;define("wkview:widget/doc_reader/presenter.js",function(e,t,i){var o=e("wkcommon:widget/lib/tangram/base/base.js"),r=e("wkview:widget/ui/view/mediator/mediator.js").mediator,a=e("wkcommon:widget/ui/js_core/mvp/presenter/presenter.js").Presenter,d=o.lang.createClass(function(e){this._init(e)},{superClass:a}).extend({errorMsg:{1:"\u7cfb\u7edf\u9519\u8bef",2:"\u7528\u6237\u672a\u767b\u9646",3:"\u7528\u6237\u5df2\u88ab\u5c01\u7981",4:"\u65e0\u6587\u6863\u64cd\u4f5c\u6743\u9650",5:"\u64cd\u4f5c\u9891\u7387\u592a\u5feb",6:"\u91cd\u590d\u8bc4\u4ef7",7:"\u6587\u6863\u5927\u5c0f\u8d85\u8fc7\u4e0a\u9650",8:"\u975e\u6cd5\u7684\u6587\u4ef6\u5939\u540d\u79f0",9:"\u975e\u6cd5\u7684\u6587\u4ef6\u683c\u5f0f",10:"\u91cd\u590d\u6587\u6863",11:"\u63d0\u4ea4\u53c2\u6570\u975e\u6cd5",12:"\u4e0b\u8f7d\u6587\u6863\u5931\u8d25",13:"\u8bc4\u4ef7\u5931\u8d25",14:"\u7528\u6237\u79ef\u5206\u4e0d\u591f",57:"\u5bfc\u5165\u7684\u6587\u6863\u5df2\u7ecf\u5b58\u5728\u6587\u4ef6\u5939\u4e2d",58:"\u5bfc\u5165\u7684\u6587\u6863\u8fbe\u5230\u6587\u4ef6\u5939\u7684\u4e0a\u9650",59:"\u521b\u5efa\u7684\u6587\u4ef6\u5939\u8fbe\u5230\u4e0a\u9650",60:"\u6587\u4ef6\u5939\u5c42\u7ea7\u5df2\u8fbe\u5230\u4e0a\u9650",61:"\u540c\u4e00\u76ee\u5f55\u4e0b\u7684\u6587\u6863\u6709\u91cd\u590d",62:"\u5bfc\u5165\u7684\u6587\u4ef6\u5939\u540d\u5b57\u4e0d\u5408\u6cd5"},mediator:r,_init:function(){this.mediator.on("p:create-dir",o.fn.bind(this.createDir,this)),this.mediator.on("p:do-move",o.fn.bind(this.doMove,this)),this.mediator.on("p:get-fold-sons",o.fn.bind(this.getFoldSons,this)),this.mediator.on("p:get-move-tree",o.fn.bind(this.getMoveTree,this)),this.mediator.on("p:get-view-fold-info",o.fn.bind(this.getViewFoldInfo,this)),this.mediator.on("p:modelError",o.fn.bind(this.errorCenter,this))},getViewFoldInfo:function(e){var t=this,i=e.data;this.mediator.when(["m:get-view-fold-info",{data:i}]).then(function(e){t.mediator.fire("v:show-move-tree",{data:e[0]})})},getMoveTree:function(e){var t=this,i=e.data,o=i.selected||{},o=o.folds||[];this.mediator.when(["m:get-fold-sons",{data:i}]).then(function(e){var r=e[0],a={id:i.id,fold_son:r,selected:o};t.mediator.fire("v:expand-move-node",{data:a})})},createDir:function(e){var t=e.data,i=this;this.mediator.when(["m:create-dir",{data:t}]).then(function(e){{var t,o=e[0].response;+o.error_no}t={parent_fold_id:e[0].parent_fold_id,data:{fold_id:o.fold_id,fold_name:o.fold_name,create_time:o.create_time,level:o.level}},i.mediator.fire("v:create-folder",{data:t}),i.mediator.fire("v:show-move-tip",{data:{tip:"\u521b\u5efa\u6587\u4ef6\u5939\u6210\u529f ^_^"}})})},doMove:function(e){var t=e.data;this.mediator.when(["m:move-docs",{data:t}])},errorCenter:function(e){var t=e.error_no;switch(+t){case 63:this.mediator.fire("v:show-move-tip",{data:{tip:"\u79fb\u52a8\u6210\u529f"}});break;case 2:alert("\u60a8\u6ca1\u6709\u767b\u5f55\uff0c\u8bf7\u767b\u5f55\u540e\u8bbf\u95ee"),location.href="http://wenku.baidu.com";break;default:this.errorMsg[t]&&this.mediator.fire("v:show-move-tip",{data:{tip:this.errorMsg[t]}})}}});i.exports.presenter=d});
;define("wkview:widget/share_box/share_box.js",function(e,o,t){var r=e("wkcommon:widget/lib/tangram/base/base.js"),c=e("wkcommon:widget/ui/js_core/qrcode/qrcode.js");t.exports=function(e){e=r.g(e);var o="?qrcode=1",t="http://"+location.host+location.pathname+o;e&&new c(e,{text:t,width:128,height:128,colorDark:"#000000",colorLight:"#ffffff",correctLevel:c.CorrectLevel.L})}});
;define("wkview:widget/relate_periodical/relate_periodical.js",function(e,a,t){var i=e("wkcommon:widget/lib/tangram/base/base.js"),l=e("wkview:widget/ui/pagenation/pagenation.js").pagenation,o=e("wkcommon:widget/ui/js_core/util/util.js"),p=e("wkcommon:widget/lib/fis/data/data.js").get("WkInfo")||{},n=e("wkcommon:widget/ui/js_core/log/log.js"),d=e("wkcommon:widget/ui/js_core/mvp/template/template.js").template,c={_url:"/rec/getweipurec?",_el:"",_docId:"",_data:"",_inited:!1,_conEle:null,_tpl:["<ul>","<%for(var i=0; i<page_list.length; i++){%>","<li>",'<b class="ic ic-dot"></b>','<span class="periodical-title" title="<%=page_list[i].title%>">','<b class="ic ic-<%=page_list[i].type%>"></b>','<a href="/view/<%=page_list[i].doc_id%>.html" target="_blank" class="logSend" data-logsend=\'{"send":["view","periodical",{"bottom":"docClick","recommend_type":"weipu"}]}\'><%=page_list[i].title%></a>',"</span>",'<span class="periodical-author">',"\u4f5c\u8005\uff1a<%=page_list[i].author%>","</span>",'<span class="periodical-page">',"<%=page_list[i].page%>\u9875","</span>","<span><%=page_list[i].price%></span>","</li>","<%}%>","</ul>"].join(""),init:function(e,a,t){var l=t||0,o=this;o._el=i.g("periodical-list-container"),o._conEle=i.g(a),o._docId=e,o.render(l)},render:function(e){var a=this,t=["doc_id="+a._docId,"page_size=10","page_no="+(e+1)].join("&");i.ajax.get(a._url+t,function(t,c){try{var s=i.json.parse(c);if(a._data=s.data,0!==s.status.code)return i.lang.eventCenter.dispatchEvent("noWeipuRec"),void i.dom.remove(a._conEle)}catch(_){return i.lang.eventCenter.dispatchEvent("noWeipuRec"),i.dom.remove(a._conEle),!1}i.dom.empty(a._el);for(var r=0;r<a._data.page_list.length;r++)a._data.page_list[r].type=p.PageInfo.docTypeList[a._data.page_list[r].type][0],a._data.page_list[r].price=1==a._data.page_list[r].goods_type?a._data.page_list[r].price>0?"<b>"+a._data.page_list[r].price+"</b>\u8d22\u5bcc\u503c":"\u514d\u8d39":a._data.page_list[r].pay_price>0?"<b>"+(1*a._data.page_list[r].pay_price/100).toFixed(2)+"</b> \u5143":"\u514d\u8d39";a._el.appendChild(o.createDom(d(a._tpl,a._data))),i.g("periodical-list-title").innerHTML=a._data.title,n.send("view","periodical",{page:e,recommend_type:"weipu"}),l({el:a._el,total:a._data.total_count,pn:e,rn:10,callback:function(e){a.render(e)}}).gotoPage(e)})}};t.exports.periodical=c});
;define("wkview:widget/ui/view/mediator/mediator.js",function(e,i,t){var n=e("wkcommon:widget/ui/js_core/mvp/event/event.js");t.exports.mediator=new n.custEvent});
;define("wkview:widget/ui/view/down_doc/down_org_vip.js",function(o){var e=o("wkcommon:widget/ui/lib/jquery/jquery.js"),n=o("wkcommon:widget/lib/tangram/base/base.js"),d=(o("wkview:widget/ui/file_downloader_ui/file_downloader_ui.js"),o("wkcommon:widget/ui/js_core/dialog/dialog.js")),a=o("wkview:widget/ui/doc_business/doc_business.js"),i=o("wkcommon:widget/ui/js_core/log/log.js"),t=o("wkcommon:widget/lib/fis/data/data.js"),s=(t.get("WkInfo"),o("wkcommon:widget/ui/js_core/login/login.js").login),c=function(){var o=null;return function(){return o||(o=d.dialogCreate()),o}}(),r={wealth:0,pay:0,code:0,orgName:"",down_doc_dialog:null,actionUrl:{userUrl:"/user/submit/download",vipUrl:"/orgvip/submit/download"},mes:[["","\u7acb\u5373\u4e0b\u8f7d"],["","\u5207\u6362\u81f3\u4e2a\u4eba\u8d26\u53f7\u4e0b\u8f7d"],[],["\u672c\u8d26\u53f7\u4eca\u65e5\u4e0b\u8f7d\u603b\u91cf\u5df2\u8d85\u51fa\u6700\u5927\u6b21\u6570\u9650\u5236\uff0c\u8bf7\u660e\u5929\u518d\u8bd5","\u5207\u6362\u81f3\u4e2a\u4eba\u8d26\u53f7\u4e0b\u8f7d"],["\u7cfb\u7edf\u9519\u8bef\uff0c\u8bf7\u5728\u9875\u9762\u5237\u65b0\u540e\u91cd\u65b0\u4e0b\u8f7d","\u786e\u5b9a"],["\u5f53\u524d\u4e0b\u8f7d\u7528\u6237\u592a\u591a\uff0c\u8bf710\u5206\u949f\u4e4b\u540e\u518d\u6765","\u5207\u6362\u81f3\u4e2a\u4eba\u8d26\u53f7\u4e0b\u8f7d"],["\u5f53\u524d\u4e0b\u8f7d\u7528\u6237\u8fc7\u591a\uff0c\u8bf7\u4f11\u606f\u4e00\u4e0b\uff0c\u660e\u5929\u518d\u6765","\u5173\u95ed"]],initIndex:[],isOrg:!0,isControlKey:!0,init:function(o){var n=this;e.extend(r,o),n.caniuse&&void 0!==n.caniuse.status.code?(n.wealth=0,n.pay=0,n.code=4,n.resSuccess(n.caniuse)):e.ajax({url:"/orgvip/interface/caniuse",cache:!1,async:!1,type:"get",data:{doc_id:n.WkInfo.DocInfo.docId,dowmloadTime:(new Date).getTime()},success:function(o){console.log(o),n.wealth=0,n.pay=0,n.code=4,o&&void 0!==o.status.code&&n.resSuccess(o)}})},resSuccess:function(o){var e=this,n=parseInt(o.status.code);void 0!==o.data.org_privilege_left&&(e.wealth=o.data.org_privilege_left||0),void 0!==o.data.doc_privilege_use_num&&(e.pay=o.data.doc_privilege_use_num||0),console.log("\u60a8\u7684\u7528\u6237\u4ee3\u53f7\u662f\uff1a"+n+"!"),e.code=o.status.code,e.vipType=+o.data.vip_type,1===+o.data.is_repeat_user&&(e.code=4),console.log(o.data.org_name),e.orgName=decodeURIComponent(o.data.org_name)||"",e.eventInit()},changePersonDownLoad:function(){var o=this;s.verlogin(function(){var n=new o.downDoc;o.isControlKey=!1,e(document.downloadForm).attr("action",o.actionUrl.userUrl),n.start(!0)},null,null,{actionName:"download",fromMod:"download"},!1)},postGetFile:function(){var o=this,d=(o.WkInfo.DocInfo.docType,(o.WkInfo.DocInfo.size/1024+"").replace(/^(\d+\.\d)\d+$/,"$1"),window.postVcode||0),a=window.postVinput||0;e(document.downloadForm).find("input[name=v_code]").val(d),e(document.downloadForm).find("input[name=v_input]").val(a),n.lang.eventCenter.dispatchEvent("download.realStart"),document.downloadForm.submit()},eventInit:function(){var o=this;o.down_doc_dialog=new a,e(document.downloadForm).attr("action",o.actionUrl.vipUrl);var n=[0,-1,99,99,99,99,3,99,1];n[13]=5,n[14]=6,-1!=n[o.code]&&(99==n[o.code]?o.changePersonDownLoad():o.dialogInit(n[o.code]))},dialogInit:function(o){var n=this;switch(n.down_doc_dialog.reset(),o){case 0:i.xsend(1,100261),n.mes[o][0]=11===n.vipType?"":"\u8d26\u53f7\u6301\u6709\u4e0b\u8f7d\u7279\u6743: <em> "+n.wealth+"</em><span>\u672c\u6b21\u4e0b\u8f7d\u6d88\u8017:<em> "+n.pay+"</em></span>";break;case 1:i.xsend(1,100266),n.mes[o][0]="\u8d26\u53f7\u6301\u6709\u4e0b\u8f7d\u7279\u6743:<em> "+n.wealth+"</em><span>\u65e0\u6cd5\u5b8c\u6210\u672c\u6b21\u4e0b\u8f7d</span>";break;case 3:i.xsend(1,100264)}switch(o){case 2:i.xsend(1,100262),n.down_doc_dialog.vcodePass=!1,n.down_doc_dialog.creat_2(),e(".org_name").html(n.orgName),n.down_doc_dialog.bindEvent();break;case 4:n.down_doc_dialog.set0Msg(n.mes[o][0]);break;case 5:case 6:n.down_doc_dialog.set1Msg("\u60a8\u6b63\u5728\u4f7f\u7528\u7684\u4f01\u4e1a\u4f1a\u5458\u8d26\u53f7 : "+n.orgName),n.down_doc_dialog.set2Msg(n.mes[o][0],"warning"),n.down_doc_dialog.setBtnMsg(n.mes[o][1]);break;default:n.down_doc_dialog.set1Msg("\u60a8\u6b63\u5728\u4f7f\u7528\u7684\u4f01\u4e1a\u4f1a\u5458\u8d26\u53f7 : "+n.orgName),n.down_doc_dialog.set2Msg(n.mes[o][0]),n.down_doc_dialog.setBtnMsg(n.mes[o][1])}n.down_doc_dialog.bindDownLoadBtton(function(){n.downloaddoc()}),n.down_doc_dialog.bindChangePerson(function(){1==o&&i.xsend(1,100267),2==o&&i.xsend(1,100263),3==o&&i.xsend(1,100265),n.changePersonDownLoad()}),n.down_doc_dialog.show()},downloaddoc:function(){var o=this;c().confirm({title:"\u4e0b\u8f7d\u6587\u6863",content:'<iframe width="460" height="220" name="runDown" frameborder="0"></iframe>',width:500,height:220,onRendered:function(){o.postGetFile()}}),c().hide()}};return r});
;define("wkview:widget/ui/view/operate/operate.js",function(e,t,o){var a=e("wkcommon:widget/lib/tangram/base/base.js"),i=e("wkcommon:widget/lib/fis/data/data.js"),s=i.get("WkInfo");o.exports.addTofav=function(e,t,o,i){a.ajax.request(s.Urls.submitCollect,{data:["ct="+e,"doc_id="+t,"fold_id="+o].join("&"),method:"post",async:!1,onsuccess:i||function(){}})}});
;define("wkview:widget/ui/view/favorite/favorite.js",function(e,t,o){var i=e("wkcommon:widget/lib/tangram/base/base.js"),a=e("wkcommon:widget/lib/fis/data/data.js"),s=e("wkcommon:widget/ui/js_core/util/util.js"),r=e("wkcommon:widget/ui/js_core/login/login.js").login,n=e("wkview:widget/ui/view/operate/operate.js").addTofav,d=e("wkcommon:widget/ui/js_core/log/log.js"),l=e("wkcommon:widget/ui/lib/jquery/jquery.js"),_=e("wkview:widget/ui/view/mediator/mediator.js").mediator,c=function(){var e=i.g("fav-bottom-tip"),t=i.dom.query(".reader_tools_tips",i.g("doc_reader"))[0];e&&e.parentNode.removeChild(e),t&&t.parentNode.removeChild(t)},v=function(){var e=a.get("WkInfo"),t=!1;return e.DocInfo.payPrice&&(t=!0),t}(),p=function(e){var t=e||{},o="100px";v||(o="128px");var a=['<div class="mod ui-panel trg-tr reader_tools_tips" id="fav-bottom-tip" style="width:220px; height:'+o+'; display:block; position:absolute; top:76px; right:275px;">','<div class="tips-wrap" style="position:absolute;z-index:2;width:100%;height:100%">','<span class="trangle" style="left:95px;margin-top:-10px;top:0;"></span>','<div class="inner">','<div class="hd">','<span class="act">','<a href="###" class="ir close reader_tips_close">X</a>',"</span>","</div>",'<div class="bd">','<div class="reader_tools_tips_content_wrap"></div>','<div class="reader_tools_tips_btn_wrap">',"__CONTENT__","</div>","</div>","</div>","</div>",'<iframe style="width:100%;height:100%;" frameborder="0"></iframe>',"</div>"].join(""),r=i.g("ft-down-area");if(r){r.appendChild(s.createDom(a.replace(/__CONTENT__/g,t.content||""))),l(".down-pack-btn")[0]?l("#fav-bottom-tip").css("right",275):l("#fav-bottom-tip").css("right",170);var n=l("#tip-notice-new"),d=l("#tip-new");n.is(":visible")&&(l("#fav-bottom-tip").css("right",350),"VIP\u9650\u65f6\u514d\u8d39\u4e0b\u8f7d"===n.html()&&l("#fav-bottom-tip").css("right",460)),d.is(":visible")&&l("#fav-bottom-tip").css("right",170),(l(".btn-new").is(":visible")||l(".xufei-vip").is(":visible"))&&l("#fav-bottom-tip").css("right",350),s.delegate(r,".reader_tips_close","click",function(){i.g("fav-bottom-tip").parentNode.removeChild(i.g("fav-bottom-tip"))})}},f=function(e,t){var t=t||"";d.xsend(1,100034),r.verlogin(function(){var t=i.cookie.get("last-store-folder")||"0",o=a.get("WkInfo"),s=o.DocInfo.docId,r=!!e;n(20010,s,t,function(t,s){var n=i.dom,d="",l=n.query(".down .btn-fav")[0],f=n.query(".reader_tools_bar .fav_btn")[0];v||(d='<p class="wk-app-tip" style="margin-top:10px;">\u7528\u6587\u5e93\u624b\u673a\u5ba2\u6237\u7aef\u968f\u65f6\u67e5\u770b\u8be5\u6587\u6863\u3002<a href="http://wenku.baidu.com/apps?fr=1002" target="_blank">\u6ca1\u6709\u5ba2\u6237\u7aef\uff1f</a></p>');var g=i.json.parse(s),m=['<div class="reader_tips_fav">','<b class="fav_sucess ic"></b>',"<strong>__TIP_TEXT__</strong>",'<a href="/room?fr=view" class="store-folder" id="store-move-link" target="blank" title="__FOLD_NAME__" data-id="__FOLD_ID__">',"__SHORT_NAME__","</a>","<br/>",'<div id="store-move-box" style="display:inline">','<a href="###" id="store-move-btn" target="_blank" alog-action="flashtoolbar.changefavofold">\u4fee\u6539\u4fdd\u5b58\u4f4d\u7f6e</a>',d,"</div>","</div>"].join(""),w=g.fold_id||"0",b=g.fold_name||"\u6211\u7684\u6587\u5e93",h=b.length>5?b.slice(0,5)+"...":b,u="\u5df2\u6536\u85cf\u81f3 ";if(o.DocInfo.fold_id=w,o.DocInfo.fold_name=b,a.set("WkInfo",o),15==+g.error_no&&(u="\u5df2\u6536\u85cf\u5728 "),l&&(n.removeClass(l,"btn-fav"),n.addClass(l,"btn-faved"),l.innerHTML="\u5df2\u6536\u85cf"),f&&(f.innerHTML='<b class="ic"></b>\u5df2\u6536\u85cf'),m=m.replace(/__TIP_TEXT__/g,u).replace(/__FOLD_ID__/g,w).replace(/__FOLD_NAME__/g,i.string.encodeHTML(b)).replace(/__SHORT_NAME__/g,i.string.encodeHTML(h)),c(),e){var k={content:m,width:220,height:102};v||(k.height=125),e.show(k)}else p({content:m});i.g("store-move-btn")&&i.on(i.g("store-move-btn"),"click",function(e){i.g("store-move-box").style.display="block";var t=i.dom,a=t.query;a(".reader_tools_tips")[0].style.width="360px",a(".reader_tools_tips")[0].style.height="315px",a(".reader_tools_tips")[0].style.right="40px",_.fire("p:get-view-fold-info",{data:{id:o.DocInfo.fold_id}}),i.g("ft-down-area").style.overflow="hidden",i.g("ft-down-area").style.overflow="auto",r||window.scrollTo(0,9999),i.event.stop(e)})})},null,null,{actionName:"addTofav",fromMod:t})};o.exports.Favorite=f});
;define("wkview:widget/ui/view/down_doc/downRec.js",function(e){var o=e("wkcommon:widget/lib/tangram/base/base.js"),t=(e("wkcommon:widget/ui/lib/jquery/jquery.js"),e("wkcommon:widget/lib/fis/data/data.js").get("WkInfo").otherLikeDocRec),n=(e("wkcommon:widget/lib/fis/data/data.js").get("WkInfo").docType,e("wkcommon:widget/lib/fis/data/data.js").get("WkInfo").DocInfo),i=(e("wkcommon:widget/ui/js_core/mvp/template/template.js").template,e("wkcommon:widget/ui/lib/cookie/cookie.js"),e("wkcommon:widget/ui/js_core/log/log.js")),a=!1,d=!1,c=!1,r=0,w=4;!function(){function e(e){var o=e&&e.struData;if(o&&o.length)for(var t=0,n=o.length;n>t&&!(r>w);t++)o[t].related_doc_infos&&o[t].related_doc_infos.length&&r++;r>w&&(a=!0,d&&l(),d=!1)}function l(e){if(!c){var o=e.disableBlank,t=e.query||"",d=e.hasActivityAferDownload;d?(c=!1,a=!0):c=!0;var r="/browse/downloadrec?doc_id="+(n&&n.docId)+"&"+t;i.mark("markDownRec","1"),o?location.href=r:(0!==~~n.docTicket||n.payprice||d)&&window.open(r,"_blank")}}t&&(r+=t.length,r>w&&(a=!0)),o.lang.eventCenter.addEventListener("recDataForDownLoad",o.fn.bind(e,this)),o.lang.eventCenter.addEventListener("download.realStart",o.fn.bind(l,this))}()});
;define("wkview:widget/ui/view/down_doc/exchange_ticket/exchange_ticket.js",function(e,t,i){var n=e("wkcommon:widget/ui/lib/jquery/jquery.js"),c=e("wkcommon:widget/ui/js_core/widget/widget.js").widget,a=e("wkcommon:widget/ui/js_core/mvp/template/template.js").template,s=c({Options:{el:"",tpl:'<div class="view-exchange-wrap">\n    <div class="exchange-box clearfix">\n        <span class="tips">\u53ef\u4ee5\u5151\u6362\uff1a</span>\n        <div class="exchange-input">\n            <div class="drop-bar">\n                <i class="iconfont">&#xe629;</i>\n            </div>\n            <p class="selected-content"></p>\n            <ul class="select-bar">\n                <% for(var i=0;i<exchangeList.length;i++){ %>\n                    <li class="<%if(i==0){%>first<%}%>" data-ticket="<%=exchangeList[i].ticket%>"><%=exchangeList[i].ticket%>\u4e0b\u8f7d\u5238</li>\n                <% } %>\n                <li data-ticket="0">\u81ea\u5b9a\u4e49</li>\n            </ul>\n        </div>\n        <p class="gift">\u518d\u8d603\u4e0b\u8f7d\u5238</p>\n    </div>\n    <p class="consume">\u9700\u8981\u6d88\u8017\uff1a<em class="n">0</em>\u8d22\u5bcc\u503c<span>\uff08\u60a8\u62e5\u6709\u8d22\u5bcc\u503c<%=allWealth%>\uff09</span></p>\n    <p class="error-msg"></p>\n</div>\n',allWealth:0,exchangeRate:4,defaultTicket:30,exchangeList:[{ticket:5,giftTicket:0,validity:7},{ticket:10,giftTicket:0,validity:30},{ticket:30,giftTicket:3,validity:30},{ticket:50,giftTicket:5,validity:30}]},_init:function(){var e=this,t=this.render({exchangeList:e.exchangeList,allWealth:e.allWealth});this.bindEvent(t),e.fire("ex:afterSelectTicket",{ticket:e.defaultTicket}),e.maxTicket=Math.floor(e.allWealth/e.exchangeRate)},render:function(e){return n(this.el).html(a(this.tpl,e))},bindEvent:function(e){var t=this;e.find(".drop-bar").on("mouseover",function(){e.find(".drop-bar .iconfont").html("&#xe628;"),e.find(".select-bar").show()}),e.find(".exchange-input").on("mouseleave",function(){e.find(".drop-bar .iconfont").html("&#xe629;"),e.find(".select-bar").hide()}),e.find(".select-bar li").on("click",function(){var i=n(this),c=i.data("ticket");0===+c?t.fire("ex:showUserDefined"):t.fire("ex:afterSelectTicket",{ticket:c}),e.find(".select-bar").hide()}),e.find(".selected-content").on("keyup","input",function(){var e=+t.validateTicketNum(n(this).val());n(this).val(0===+e?"":e),t.fire("ex:afterSelectTicket",{ticket:e,isUserDefined:!0})}),e.find(".selected-content").on("focus","input",function(){t.fire("ex:userInputTicket")}),e.find(".selected-content").on("blur","input",function(){t.fire("ex:userFinishInputTicket")}),t.on("ex:afterSelectTicket",function(i){var n=t.getGiftTicketNum(i.ticket),c=t.getValidity(i.ticket);e.find(".gift").html(+n>0?"\u518d\u8d60"+n+"\u4e0b\u8f7d\u5238":""),e.find(".consume .n").html(~~i.ticket*t.exchangeRate),i.isUserDefined?e.find(".selected-content span").html(i.ticket?"\uff08\u6709\u6548\u671f"+c+"\u5929\uff09":""):e.find(".selected-content").html(i.ticket+"\u4e0b\u8f7d\u5238<span>\uff08\u6709\u6548\u671f"+c+"\u5929\uff09</span>"),i.ticket>t.maxTicket?t.fire("ex:notHaveEnoughWealth",{msg:"\u8d22\u5bcc\u503c\u4e0d\u8db3\uff0c\u60a8\u6700\u591a\u53ef\u5151\u6362"+t.maxTicket+"\u5f20\u4e0b\u8f7d\u5238"}):i.ticket>500?t.fire("ex:ExceedMax",{msg:"\u5df2\u8d85\u51fa\u5151\u6362\u4e0a\u9650\uff0c\u60a8\u4e00\u6b21\u6700\u591a\u53ef\u5151\u6362500\u5f20\u4e0b\u8f7d\u5238"}):t.fire("ex:clearError")}),t.on("ex:showUserDefined",function(){e.find(".selected-content").html('<input type="text">\u4e0b\u8f7d\u5238<span></span>'),e.find(".selected-content input").focus(),t.fire("ex:afterSelectTicket",{ticket:0,isUserDefined:!0})}),t.on("ex:notHaveEnoughWealth",function(t){e.find(".error-msg").html('<i class="iconfont">&#xe614;</i>'+t.msg)}),t.on("ex:haveEnoughWealth",function(){e.find(".error-msg").html("")}),t.on("ex:ExceedMax",function(t){e.find(".error-msg").html('<i class="iconfont">&#xe614;</i>'+t.msg)}),t.on("ex:clearError",function(){e.find(".error-msg").html("")})},getGiftTicketNum:function(e){for(var t=this.exchangeList,i=t.length-1;i>=0;i--)if(e>=t[i].ticket)return t[i].giftTicket;return 0},getValidity:function(e){for(var t=this.exchangeList,i=t.length-1;i>=0;i--)if(e>t[i].ticket)return i==t.length-1?t[i].validity:t[i+1].validity;return t[0].validity},validateTicketNum:function(e){if((""+e).match(/^\d+/))var t=+(""+e).match(/^\d{0,4}/)[0];else t=0;return t}});i.exports=s});
;define("wkview:widget/ui/view/down_doc/dialog_down_doc/dialog_down_doc.js",function(t,i,o){var e=t("wkcommon:widget/ui/lib/jquery/jquery.js"),n=(t("wkcommon:widget/ui/js_core/dialog/dialog.js"),t("wkcommon:widget/lib/tangram/base/base.js")),s=t("wkcommon:widget/lib/fis/data/data.js"),c=s.get("WkInfo"),a=t("wkcommon:widget/ui/js_core/log/log.js"),d=t("wkcommon:widget/ui/js_core/xform/xform.js"),l=(t("wkcommon:widget/ui/js_core/dialogCashier/dialogCashier.js"),t("wkview:widget/ui/view/down_doc/exchange_ticket/exchange_ticket.js")),p={isZhuangyuan:!1,getIsZhuangyuan:function(){var t=this;e.get("/pgc/interface/zhuangyuanbiji?uname="+t.uname,function(i){0===i.status.code&&i.data.is_zhuangyuan&&(t.isZhuangyuan=!0,e("#tip-notice-new").remove(),t.isZhuangyuan&&d.getJSON("2015gaokao_zhuangyuanbiji_view",{success:function(i){t.zhuangyuanQcode=i.image}}))})},init:function(){this.isPgc=c.verify_user_info,this.isPgc&&(this.uname=c.DocInfo.creater,this.getIsZhuangyuan())}};setTimeout(function(){c=s.get("WkInfo"),p.init()},200);var r=function(){var t=function(t){this.init.apply(this,[t])};return t.prototype={initPublicTpl:function(){var t=this;t.publicTpl={wealth_doc_ad:p.isZhuangyuan?['       <div class="qcode-miti">','           <img src="'+p.zhuangyuanQcode+'" />','           <p class="subtitle">\u626b\u63cf\u4e0b\u8f7d\u89c5\u9898</p>','           <p class="text">\u672c\u6587\u514d\u8d39\u8fd8\u9001\u5168\u5957\u72b6\u5143\u7b14\u8bb0</p>',"       </div>"].join(""):"",publicHdTpl:['<div class="close-btn"></div>','<div class="dialog-left-greenbar"></div>','<div class="dialog-top">','    <p class="doc-title" rel="new-dialog" alt="dialog_tit">'+t.docTitle+"</p>",'    <p class="doc-size">\uff08'+t.docSize+"K\uff09</p>","</div>"].join(""),dialogAdWrap:['<div class="dialog-ad">','   <div class="dialog-ad-hd"></div>'].join(""),vcodeTpl:['<div class="vcode-box">','    <input type="text" class="vcode-ipt" />','    <img src="" />','    <span class="vcode-change">\u6362\u4e00\u6362</span>','    <b class="vcode-right"></b>','    <p class="error-tip"><b class="vcode-error"></b><span>\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801\uff01</span></p>',"</div>"].join(""),vipFreeDocLimitedBottomTpl:['<p class="vipdoc-limited hide">','<span class="iconfont ico-vip">&#xe64e;</span>','<a href="/cashier/browse/dispatch?dqStatCode=31_8_171_175&from_doc='+c.DocInfo.docId+'" class="log-xsend" ','data-logxsend="[1, 100462]" target="_blank">','VIP\u9650\u514d\u6587\u6863 <span class="vipdoc-limited-con"></span></a>',"</p>"].join("")}},_dialog:{},dialogObj:null,$iframe:{content:null},setDialog:function(t){this.dialogObj=t},init:function(t){this.options=t,this.docTitle=n.string.getByteLength(c.DocInfo.title)<26?c.DocInfo.title:n.string.subByte(c.DocInfo.title,26,"..."),this.docSize=(c.DocInfo.size/1024+"").replace(/^(\d+\.\d)\d+$/,"$1"),this.isChrome=n.browser.chrome,this.creat(),this.addEventListener(),this.initVcode(),this.initPublicTpl(),this.getAdvTpl(),document.downloadForm.storage.value=1},getAdvTpl:function(){var t=["http://wenku","baidu.com/shifen/get"],i=57,o=this;e.ajax({type:"get",url:t[0]+"."+t[1],dataType:"jsonp",data:{pid:i,tid:1},success:function(t){if(t[0].ad_id){o.$el.find(".dialog-ad").css({width:590,background:"url("+t[0].tpl_data[0].infoImg+") center top"}),o.$el.find(".dialog-ad-hd").html(['<a target="_blank" href="'+t[0].tpl_data[0].link+'" ','class="dialog-ad-more">',"</a>"].join(""));for(var e=0;e<t.length;e++)a.xsend(1,100421,{action_type:"display",group_id:i,advertiser:t[e].from,ad_id:t[e].ad_id})}},error:function(){}})},creat:function(){var t=e(".WkDialogDownDoc").length+1,i=e('<div id="WkDialogDownDoc_'+t+'" class="WkDialogDownDoc '+(p.isZhuangyuan&&"zhuangyuan")+'"></div>'),o=e('<div class="dialog-container-iframe"><iframe allowTransparency="true" src="" frameborder="0" scrolling="no"></iframe></div>');this.$el=i,i.appendTo(e("body")),null==this.$iframe.content&&(this.$iframe.content=o,i.after(o))},show:function(t){e("#doc_reader")&&!this.isChrome&&(e("#doc_reader").css("visibility","hidden"),window.docReaderHideIEtxt="fuckIE");var i=this,o=e(window).height(),n=e(document).scrollTop();this.$iframe.content.css({height:e("body").height()}).show(),this.$el.css("top",n+o/2-150).show(),"function"==typeof t&&t(i)},close:function(t){var i=this;this.$el.css("display","none"),this.$iframe.content.css("display","none"),e("#doc_reader")&&e("#doc_reader").css("visibility","visible"),"function"==typeof t&&t(i)},addEventListener:function(){var t=this;this.$el.on("click",".close-btn",function(){t.close()}),this.$el.on("click",".vcode-change",function(){t.vcodeImg()}),setTimeout(function(){e(".vcode-ipt").on("input propertychange",function(){if(e(this).val().length>5)t.vcodeError();else if(4==e(this).val().length){var i=e(this).val();e.get("/user/interface/vcodefordownload?m=check&&v_code="+t.vcodeValue+"&v_input="+i+"&t="+(new Date).getTime(),function(o){o.errno?t.vcodeError():(t.vcodeOk(),t.vcodePass=!1,window.postVcode=t.vcodeValue,window.postVinput=i)})}else t.$el.find(".vcode-box .vcode-right").css("visibility","hidden"),t.$el.find(".vcode-box .error-tip").css("height","0px")})},10)},getDate:function(){var t=new Date;return{day:t.getDate(),month:t.getMonth()+1,year:t.getFullYear(),hour:t.getHours(),minutes:t.getMinutes(),today:t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}},changeDateBySecond:function(t){var i=+t,o=parseInt(i/86400,10)>0?parseInt(i/86400,10):0,e=parseInt((i-86400*o)/3600,10);e=e>0?e:0;var n=parseInt((i-(86400*o+3600*e))/60,10);n=n>0?n:0;var s=i-(86400*o+3600*e+60*n);return s=s>0?s:0,{day:o,hour:e,min:n,sec:s}},initVcode:function(){var t=this;t.options.isShowVcode&&(t.vcodePass=!0,t.vcodeImg())},vcodeOk:function(){e(".vcode-box .vcode-right").css("visibility","visible"),e(".vcode-box .error-tip").css("height","0px")},vcodeError:function(){e(".vcode-box .error-tip").css("height","16px"),e(".vcode-box .vcode-right").css("visibility","hidden")},vcodeImg:function(){var t=this;e.get("/vcode?t="+(new Date).getTime(),function(i){e(".vcode-box img").attr("src",i.imgurl),t.vcodeValue=i.vcode_str,window.postVcode=t.vcodeValue})},vipFreeDocLimitedCountDown:function(){var t=this,i={},o=null,e=function(){i=t.changeDateBySecond(t.options.vipDocLimitedTime);var o="\u5269\u4f59"+i.day+"\u5929"+i.hour+"\u65f6"+i.min+"\u5206"+i.sec+"\u79d2";t.$el.find(".vipdoc-limited-con").html(o)};this.$el.find(".bottom-btn").addClass("hide"),this.$el.find(".vipdoc-limited").removeClass("hide"),this.options.vipDocLimitedTime>0&&e(),o=setInterval(function(){t.options.vipDocLimitedTime>0?(t.options.vipDocLimitedTime--,e()):clearInterval(o)},1e3)},_changeDownloadTicket:function(){var t=this;if(t.dialogObj)return t.options.needUticket<=t.options.UticketCount?(console.log("\u4e0b\u8f7d\u5238\u591f\u7528"),t._dialog["vipDocDialog-enough"]||(t._dialog["vipDocDialog-enough"]=t.dialogObj.get("vipDocDialog-enough",t.options)),void t._dialog["vipDocDialog-enough"].show()):t.options.UticketCount<t.options.needUticket&&t.options.canUticket+t.options.UticketCount>=t.options.needUticket?(console.log("\u4e0b\u8f7d\u5238\u4e0d\u591f\u7528,\u5151\u6362\u540e\u53ef\u4ee5\u7528"),t._dialog["vipDocDialog-enough-afterexchage"]=t.dialogObj.get("vipDocDialog-enough-afterexchage",t.options),void t._dialog["vipDocDialog-enough-afterexchage"].show()):t.options.UticketCount<t.options.needUticket&&t.options.canUticket+t.options.UticketCount<t.options.needUticket?(console.log("\u4e0b\u8f7d\u5238\u4e0d\u591f\u7528,\u5151\u6362\u540e\u4e0d\u591f"),t._dialog["vipDocDialog-noenough-afterexchage"]||(t._dialog["vipDocDialog-noenough-afterexchage"]=t.dialogObj.get("vipDocDialog-noenough-afterexchage",t.options)),void t._dialog["vipDocDialog-noenough-afterexchage"].show()):void 0},_changePrivilegeTicket:function(){n.lang.eventCenter.dispatchEvent("download.checkVipDownload")}},t}(),u={get:function(t,i){var o=function(){this.dialog=t,this.init.apply(this)};return o.prototype=e.extend(new r(i),this[t]?this[t]:{}),new o},freeDocDialog:{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">','       <p class="ticket-num-msg msg1 coupon-need">\u6240\u9700\u4e0b\u8f7d\u5238\uff1a0</p>','       <div class="blank20"></div>','       <a href="javascript:;" class="ui-bz-btn-senior btn-diaolog-downdoc" data-logxsend=""><b class="ui-bz-btn-p-16 ui-bz-btc">\u7acb\u5373\u4e0b\u8f7d</b></a>','       <p class="share-box"><span class="checkbox checked"></span>\u540c\u65f6\u5206\u4eab\u5230__WHERE__</p>',"   </div>",function(){return t.options.isShowVcode?t.publicTpl.vcodeTpl:void 0}(),'   <div class="dialog-bottom">','       <p class="bottom-btn">','           <i class="iconfont" style="color:#2FAD85">&#xe601;</i>','           <a href="http://wenku.baidu.com/task/browse/reward" target="_blank">',"              \u505a\u4efb\u52a1\u8d5a\u53d6\u8d22\u5bcc\u503c\u548c\u4e0b\u8f7d\u5238","           </a>","       </p>",'       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){var t=this.tpl(),i=!(this.options&&this.options.hasActivityAferDownload);if(i){var o={url:"http://wenku.baidu.com"+location.pathname,showcount:"0",desc:"",summary:c.DocInfo.docDesc?"\u7b80\u4ecb\uff1a"+c.DocInfo.docDesc:"",title:"\u6211\u521a\u521a\u4e0b\u8f7d\u4e86\u300a"+this.docTitle+"\u300b\uff0c\u5185\u5bb9\u7279\u522b\u8d5e\uff0c\u5c0f\u4f19\u4f34\u4eec\u5feb\u6765\u770b\uff0chttp://wenku.baidu.com"+location.pathname+"\uff08\u5206\u4eab\u81ea@\u767e\u5ea6\u6587\u5e93\uff09",site:"\u767e\u5ea6\u6587\u5e93"},n=[];for(var s in o)n.push(s+"="+encodeURIComponent(o[s]||""));"freeDocDialog"===this.dialog&&(t=t.replace("__WHERE__","QQ\u7a7a\u95f4"),n="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?"+n.join("&"))}this.$el.html(t),n?(e(".btn-diaolog-downdoc").attr("href",n),e(".btn-diaolog-downdoc").attr("target","_blank"),e(".btn-diaolog-downdoc").addClass("log-xsend"),e(".btn-diaolog-downdoc").attr("data-logxsend","[1, 100657]")):e(".dialog-inner .share-box").hide(),this.addEventListener()},addEventListener:function(){var t=this;this.$el.on("click",".btn-diaolog-downdoc",function(){return t.vcodePass?(t.vcodeError(),!1):(t.close(),a.xsend(1,100036),document.downloadForm.useTicket.value=0,void n.lang.eventCenter.dispatchEvent("download.toGetFile"))}),this.$el.on("click",".checkbox",function(){e(this).hasClass("checked")?(e(this).removeClass("checked"),e(".btn-diaolog-downdoc").attr("href","javascript:void(0);"),e(".btn-diaolog-downdoc").attr("target","_self"),e(".btn-diaolog-downdoc").removeClass("log-xsend")):e(this).addClass("checked")})}},vipFreeDocDialog:{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">','       <p class="ticket-num-msg msg1">\u672c\u6587\u4e3a\u6587\u5e93VIP\u514d\u8d39\u6587\u6863\uff0c\u60a8\u53ef\u76f4\u63a5\u4e0b\u8f7d</p>','       <p class="ticket-detail-msg msg2"></p>','       <div class="blank20"></div>','       <a href="javascript:;" class="ui-bz-btn-senior btn-diaolog-downdoc"><b class="ui-bz-btn-p-16 ui-bz-btc">\u7acb\u5373\u4e0b\u8f7d</b></a>',"   </div>",function(){return t.options.isShowVcode?t.publicTpl.vcodeTpl:void 0}(),'   <div class="dialog-bottom">','       <div class="blank20"></div>','       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){this.$el.html(this.tpl()),this.addEventListener(),a.xsend(1,100273)},addEventListener:function(){var t=this;this.$el.on("click",".btn-diaolog-downdoc",function(){return t.vcodePass?(t.vcodeError(),!1):(t.close(),a.xsend(1,100036),document.downloadForm.req_vip_free_doc.value=1,void n.lang.eventCenter.dispatchEvent("download.toGetFile"))})}},normalVipTicketDocDialog:{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container need-wealth">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">',t.publicTpl.wealth_doc_ad,'       <p class="ticket-num-msg msg1">\u60a8\u7684<strong>\u901a\u7528\u4e0b\u8f7d\u7279\u6743</strong>\u5269\u4f59\uff1a<b class="ml-5">'+t.options.ticketCount+"\u6b21</b></p>",'       <p class="ticket-detail-msg msg2"></p>','       <div class="blank20"></div>','       <a href="javascript:;" class="ui-bz-btn-senior btn-diaolog-downdoc"><b class="ui-bz-btn-p-16 ui-bz-btc">\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d</b></a>',"   </div>",function(){return t.options.isShowVcode?t.publicTpl.vcodeTpl:void 0}(),'   <div class="dialog-bottom">','       <p class="bottom-btn"><a href="javascript:;" class="btn-uDownTicket">\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d</a></p>','       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){this.$el.html(this.tpl()),this.addEventListener(),a.xsend(1,100113)},addEventListener:function(){var t=this;this.$el.on("click",".btn-diaolog-downdoc",function(){return t.vcodePass?(t.vcodeError(),!1):(t.close(),a.xsend(1,100036),document.downloadForm.useTicket.value=1,void n.lang.eventCenter.dispatchEvent("download.toGetFile"))}),this.$el.on("click",".btn-uDownTicket",function(){t.close(),t._changeDownloadTicket()})}},normalVipNoTicketDocDialog:{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container need-wealth">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">',t.publicTpl.wealth_doc_ad,'       <p class="ticket-num-msg msg1">\u60a8\u7684<strong>\u901a\u7528\u4e0b\u8f7d\u7279\u6743</strong>\u5269\u4f59\uff1a<b class="ml-5">0</b>\u6b21</p>','       <p class="ticket-detail-msg msg2"></p>','       <div class="blank20"></div>','       <a href="http://yuedu.baidu.com/coupon/browse/buydownloadticket?dqStatCode=31_23_38_39&from_doc='+c.DocInfo.docId+'" class="ui-bz-btn-senior"><b class="ui-bz-btn-p-16 ui-bz-btc">\u8865\u5145VIP\u7279\u6743</b></a>',"   </div>",'   <div class="dialog-bottom">','       <p class="bottom-btn"><a href="javascript:;" class="btn-uDownTicket">\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d</a></p>','       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){this.$el.html(this.tpl()),this.addEventListener(),a.xsend(1,100114)},addEventListener:function(){var t=this;this.$el.on("click",".btn-uDownTicket",function(){t.close(),t._changeDownloadTicket()})}},miniVipTicketDocDialog:{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container need-wealth">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">',t.publicTpl.wealth_doc_ad,'       <p class="ticket-num-msg msg1">\u60a8\u7684<strong>\u901a\u7528\u4e0b\u8f7d\u7279\u6743</strong>\u5269\u4f59\uff1a<b class="ml-5">'+t.options.ticketCount+"\u6b21</b></p>",t.leftTime,'       <div class="blank20"></div>','       <a href="javascript:;" class="ui-bz-btn-senior btn-diaolog-downdoc"><b class="ui-bz-btn-p-16 ui-bz-btc">\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d</b></a>',"   </div>",function(){return t.options.isShowVcode?t.publicTpl.vcodeTpl:void 0}(),'   <div class="dialog-bottom">','       <p class="bottom-btn">','           <i class="iconfont" style="color:#2FAD85">&#xe601;</i>','           <a href="http://wenku.baidu.com/task/browse/reward" target="_blank">',"              \u505a\u4efb\u52a1\u8d5a\u53d6\u8d22\u5bcc\u503c\u548c\u4e0b\u8f7d\u5238","           </a>","       </p>",'       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){this.initEvent(),this.$el.html(this.tpl()),this.addEventListener(),a.xsend(1,100113)},initEvent:function(){var t=this,i=t.changeDateBySecond(t.options.is_mini_time);t.leftTime=0===i.day&&0===i.hour&&0===i.min&&i.sec>0?'<p class="ticket-detail-msg msg2 ps">\uff0824\u5c0f\u65f6VIP\u8fd8\u5269\u4e0d\u52301\u5206\u949f\u5230\u671f\uff09</p>':0===i.day?'<p class="ticket-detail-msg msg2 ps">\uff0824\u5c0f\u65f6VIP\u8fd8\u5269'+i.hour+"\u5c0f\u65f6"+i.min+"\u5206\u949f\u5230\u671f\uff09</p>":""},addEventListener:function(){var t=this;this.$el.on("click",".btn-diaolog-downdoc",function(){return t.vcodePass?(t.vcodeError(),!1):(t.close(),a.xsend(1,100036),document.downloadForm.useTicket.value=1,void n.lang.eventCenter.dispatchEvent("download.toGetFile"))})}},miniVipNoTicketDocDialog:{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container need-wealth">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">',t.publicTpl.wealth_doc_ad,'       <p class="ticket-num-msg msg1">\u60a8\u7684<strong>\u901a\u7528\u4e0b\u8f7d\u7279\u6743</strong>\u5269\u4f59\uff1a<b class="ml-5">0</b>\u6b21</p>','       <p class="ticket-detail-msg msg2"></p>','       <div class="blank20"></div>','       <a href="/cashier/browse/dispatch?dqStatCode=31_8_158_159&from_doc='+c.DocInfo.docId+'" class="ui-bz-btn-senior">','<b class="ui-bz-btn-p-16 ui-bz-btc">\u7acb\u5373\u7eed\u8d39</b></a>',"   </div>",'   <div class="dialog-bottom">','       <p class="bottom-btn"><a href="javascript:;" class="btn-uDownTicket">\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d</a></p>','       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){this.$el.html(this.tpl()),this.addEventListener(),a.xsend(1,100114)},addEventListener:function(){var t=this;this.$el.on("click",".btn-uDownTicket",function(){t.close(),t._changeDownloadTicket()})}},eduVipTicketDocDialog:{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container need-wealth">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">',t.publicTpl.wealth_doc_ad,'       <p class="ticket-num-msg msg1">\u60a8\u7684<strong>\u6559\u80b2\u4e0b\u8f7d\u7279\u6743</strong>\u5269\u4f59\uff1a<b class="ml-5">'+t.options.ticketCount+"\u6b21</b></p>",'       <p class="ticket-detail-msg msg2"></p>','       <div class="blank20"></div>','       <a href="javascript:;" class="ui-bz-btn-senior btn-diaolog-downdoc"><b class="ui-bz-btn-p-16 ui-bz-btc">\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d</b></a>',"   </div>",function(){return t.options.isShowVcode?t.publicTpl.vcodeTpl:void 0}(),'   <div class="dialog-bottom">','       <p class="bottom-btn"><a href="javascript:;" class="btn-uDownTicket">\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d</a></p>','       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){this.$el.html(this.tpl()),this.addEventListener()},addEventListener:function(){var t=this;this.$el.on("click",".btn-diaolog-downdoc",function(){return t.vcodePass?(t.vcodeError(),!1):(t.close(),a.xsend(1,100036),document.downloadForm.useTicket.value=2,void n.lang.eventCenter.dispatchEvent("download.toGetFile"))}),this.$el.on("click",".btn-uDownTicket",function(){t.close(),t._changeDownloadTicket()})}},eduNormalVipDocDialog:{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container eduNormalVipDocDialog need-wealth">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">',t.publicTpl.wealth_doc_ad,'       <div class="vip-select-layout">\u60a8\u7684','           <div class="vip-select-box">','               <span class="vip-select-box-value">\u6559\u80b2\u4e0b\u8f7d\u7279\u6743</span>','               <i class="vip-select-box-btn"></i>','               <ul class="option-list">','                   <li class="option checked"><a href="javascript:;" data-type="1">\u6559\u80b2\u4e0b\u8f7d\u7279\u6743</a></li>','                   <li class="option"><a href="javascript:;" data-type="2">\u901a\u7528\u4e0b\u8f7d\u7279\u6743</a></li>',"               </ul>","           </div>",'           \u5269\u4f59\uff1a<em class="vip-ticket-count">0</em>\u6b21',"       </div>",'       <a href="javascript:;" class="ui-bz-btn-senior btn-diaolog-downdoc" style="display:none"><b class="ui-bz-btn-p-16 ui-bz-btc">\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d</b></a>','       <a href="http://yuedu.baidu.com/coupon/browse/buydownloadticket?dqStatCode=31_23_38_39&from_doc='+c.DocInfo.docId+'" class="ui-bz-btn-senior btn_goto_buyvip" style="display:none"><b class="ui-bz-btn-p-16 ui-bz-btc">\u8865\u5145VIP\u7279\u6743</b></a>',"   </div>",function(){return t.options.isShowVcode?t.publicTpl.vcodeTpl:void 0}(),'   <div class="dialog-bottom">','       <p class="bottom-btn"></p>','       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){this.$el.html(this.tpl()),this.initDom(),this.addEventListener(),this._UI_init(+this.options.edu_download_ticket>0&&+this.options.ticketCount>0||+this.options.edu_download_ticket>0?1:2)},initDom:function(){this.E=this.E||{},this.E.$vipSelectBoxBtn=this.$el.find(".vip-select-box-btn"),this.E.$optionList=this.$el.find(".option-list"),this.E.$vipTicketCount=this.$el.find(".vip-ticket-count"),this.E.$vipSelectBoxValue=this.$el.find(".vip-select-box-value"),this.E.$btnDiaologDowndoc=this.$el.find(".btn-diaolog-downdoc"),this.E.$btnGotoBuyvip=this.$el.find(".btn_goto_buyvip"),this.E.$bottomBtn=this.$el.find(".bottom-btn"),this.E.$btnUDownTicket=this.$el.find(".btn-uDownTicket")},addEventListener:function(){var t=this;this.$el.on("click",".btn-uDownTicket",function(){t.close(),t._changeDownloadTicket()}),this.$el.on("click",function(){t.E.$vipSelectBoxBtn.removeClass("vip-select-box-btn-cur"),t.E.$optionList.hide()}),this.E.$vipSelectBoxBtn.on("click",function(i){i.stopPropagation(),e(this).hasClass("vip-select-box-btn-cur")?(e(this).removeClass("vip-select-box-btn-cur"),t.E.$optionList.hide()):(e(this).addClass("vip-select-box-btn-cur"),t.E.$optionList.show())}),this.E.$optionList.find(".option a").on("click",function(){var i=e(this),o=i.data("type");t._UI_init(o)}),this.E.$btnDiaologDowndoc.on("click",function(){return t.vcodePass?(t.vcodeError(),!1):(t.close(),a.xsend(1,100036),void n.lang.eventCenter.dispatchEvent("download.toGetFile"))})},_UI_init:function(t){var i=this;this.E.$optionList.find("a[data-type='"+t+"']").eq(0).parent().siblings().removeClass("checked").end().addClass("checked"),1===+t&&(i.E.$vipSelectBoxValue.html("\u6559\u80b2\u4e0b\u8f7d\u7279\u6743"),i.E.$vipTicketCount.html(i.options.edu_download_ticket),+i.options.edu_download_ticket>0?(i.E.$btnDiaologDowndoc.show(),i.E.$btnGotoBuyvip.hide(),i.E.$bottomBtn.html('<a href="javascript:;" class="btn-uDownTicket">\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d</a>')):(i.E.$btnDiaologDowndoc.hide(),i.E.$btnGotoBuyvip.show(),i.E.$bottomBtn.html('<a href="javascript:;" class="btn-uDownTicket">\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d</a>')),document.downloadForm.useTicket.value=2),2===+t&&(i.E.$vipSelectBoxValue.html("\u901a\u7528\u4e0b\u8f7d\u7279\u6743"),i.E.$vipTicketCount.html(i.options.ticketCount),+i.options.ticketCount>0?(i.E.$btnDiaologDowndoc.show(),i.E.$btnGotoBuyvip.hide(),i.E.$bottomBtn.html('<a href="javascript:;" class="btn-uDownTicket">\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d</a>')):(i.E.$btnDiaologDowndoc.hide(),i.E.$btnGotoBuyvip.show(),i.E.$bottomBtn.html('<a href="javascript:;" class="btn-uDownTicket">\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d</a>')),document.downloadForm.useTicket.value=1)}},"vipDocDialog-enough":{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container need-wealth">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">',t.publicTpl.wealth_doc_ad,'       <p class="ticket-num-msg msg1 coupon-need">\u6240\u9700\u4e0b\u8f7d\u5238\uff1a','       <b class="ml-5">'+t.options.needUticket+"</b></p>",'       <p class="ticket-detail-msg msg2">\u60a8\u6301\u6709\u7684\u4e0b\u8f7d\u5238\uff1a'+t.options.UticketCount+"</p>",'       <div class="blank20"></div>','       <a href="javascript:;" class="ui-bz-btn-senior btn-diaolog-downdoc"><b class="ui-bz-btn-p-16 ui-bz-btc">\u7acb\u5373\u4e0b\u8f7d</b></a>',"   </div>",function(){return t.options.isShowVcode?t.publicTpl.vcodeTpl:void 0}(),'   <div class="dialog-bottom">','       <p class="bottom-btn"><a href="javascript:;" class="btn-uTicket">\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d</a></p>','       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){this.$el.html(this.tpl()),this.addEventListener()},addEventListener:function(){var t=this;this.$el.on("click",".btn-diaolog-downdoc",function(){return t.vcodePass?(t.vcodeError(),!1):(t.close(),a.xsend(1,100036),document.downloadForm.useTicket.value=0,void n.lang.eventCenter.dispatchEvent("download.toGetFile"))}),this.$el.on("click",".btn-uTicket",function(){t.close(),t._changePrivilegeTicket(t.options)})}},"vipDocDialog-enough-afterexchage":{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container need-wealth">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">',t.publicTpl.wealth_doc_ad,'       <p class="ticket-num-msg msg1 coupon-need">\u6240\u9700\u4e0b\u8f7d\u5238\uff1a','       <b class="ml-5">'+t.options.needUticket+"</b></p>",'       <p class="ticket-detail-msg msg2">\u60a8\u6301\u6709\uff1a'+t.options.UticketCount+"\u4e0b\u8f7d\u5238,",'       <span class="ps">\u53ef\u7528'+t.options.NTicket*t.options.exchangeRate+"\u8d22\u5bcc\u503c\u5151\u6362",t.options.NTicket+"\u4e0b\u8f7d\u5238</span></p>",'       <div class="blank20"></div>','       <div class="ticket-btn-container ticket-btn-container-vip">','           <a href="javascript:;" class="ui-bz-btn-senior">','               <b class="ui-bz-btn-p-16 ui-bz-btc btn-ticket-exchange">\u5151\u6362\u540e\u4e0b\u8f7d</b>',"           </a>","       </div>","   </div>",'   <div class="ticket-no-wealth-container hide">','       <div class="clear"></div>','       <div class="ticket-raido-container hidden">','           <div class="ticket-raido-bg">',"           </div>",'           <a class="btn-green btn-l ticket-exchange-download-btn ticket-exchange-download-btn-disable" href="javascript:;">\u5151\u6362\u5e76\u4e0b\u8f7d\u6587\u6863</a>',"       </div>","   </div>",function(){return t.options.isShowVcode?t.publicTpl.vcodeTpl:void 0}(),'   <div class="dialog-bottom">','       <p class="bottom-btn"><a href="javascript:;" class="btn-uTicket">\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d</a></p>','       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){this.options.NTicket=this.options.needUticket-this.options.UticketCount,console.log(this.options),this.$el.html(this.tpl()),this.addEventListener(),this.$btn=this.$el.find(".ticket-exchange-download-btn"),this.$el.find(".ticket-no-wealth-container").removeClass("hide")},isDisableDownloadBtn:function(t){var i=this,o=this.options;return t=+t,t&&!(t>o.canUticket||0===t||t>500||t+o.UticketCount<o.needUticket)?(i.$btn.removeClass("ticket-exchange-download-btn-disable"),!0):(i.$btn.addClass("ticket-exchange-download-btn-disable"),!1)},getDefaultTicket:function(){var t=this.options;return t.canUticket>=50&&t.NTicket<=50?50:t.canUticket>=30&&t.NTicket<=30?30:t.canUticket>=10&&t.NTicket<=10?10:t.canUticket>=5&&t.NTicket<=5?5:(t.NTicket>t.canUticket&&$btn.addClass("ticket-exchange-download-btn-disable"),t.canUticket)},addEventListener:function(){var t=this;this.$el.on("click",".btn-ticket-exchange",function(){t.$el.find(".ticket-btn-container").addClass("hidden"),t.$el.find(".ticket-raido-container").removeClass("hidden");var i=t.getDefaultTicket(),o=new l({el:".ticket-raido-bg",allWealth:t.options.wealth,defaultTicket:i});t.isDisableDownloadBtn(i),e('input[name="target_uticket_num"]').val(i),o.on("ex:afterSelectTicket",function(i){t.isDisableDownloadBtn(i.ticket),e('input[name="target_uticket_num"]').val(i.ticket)}),a.xsend(1,100194,{isVip:t.options.isvip})}),this.$el.find(".ticket-exchange-download-btn").on("click",function(){return t.vcodePass?(t.vcodeError(),!1):void(e(this).hasClass("ticket-exchange-download-btn-disable")||(document.downloadForm.useTicket.value=0,t.close(),n.lang.eventCenter.dispatchEvent("download.toGetFile"),a.xsend(1,100036)))}),this.$el.on("click",".btn-uTicket",function(){t.close(),t._changePrivilegeTicket(t.options)})}},"vipDocDialog-noenough-afterexchage":{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container need-wealth">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">',t.publicTpl.wealth_doc_ad,'       <p class="ticket-num-msg msg1 coupon-need">\u6240\u9700\u4e0b\u8f7d\u5238\uff1a','           <b class="ml-5">'+t.options.needUticket+"</b></p>",'       <p class="ticket-detail-msg msg2">\u60a8\u6301\u6709\uff1a'+t.options.UticketCount+"\u4e0b\u8f7d\u5238\uff0c",'           <span class="ps">\u8d22\u5bcc\u503c\u4e0d\u8db3\uff0c\u65e0\u6cd5\u5151\u6362\u4e0b\u8f7d\u5238</span></p>','       <div class="blank20"></div>','       <a href="http://yuedu.baidu.com/coupon/browse/buydownloadticket?dqStatCode=31_23_38_39&from_doc='+c.DocInfo.docId+'" class="ui-bz-btn-senior">','           <b class="ui-bz-btn-p-16 ui-bz-btc">\u8865\u5145VIP\u7279\u6743</b></a>',"   </div>",'   <div class="dialog-bottom">','       <p class="bottom-btn"><a href="javascript:;" class="btn-uTicket">\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d</a></p>','       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){var t=this;this.$el.html(this.tpl()),this.$el.on("click",".btn-uTicket",function(){t.close(),t._changePrivilegeTicket(t.options)})}},nonVipTicketsEnough:{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container need-wealth">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">',t.publicTpl.wealth_doc_ad,'       <p class="ticket-num-msg msg1 coupon-need">\u6240\u9700\u4e0b\u8f7d\u5238\uff1a','           <b class="ml-5">'+t.options.needUticket+"</b></p>",'       <p class="ticket-detail-msg msg2">','           \u60a8\u6301\u6709\u7684\u4e0b\u8f7d\u5238\uff1a<span class="col-red">'+t.options.UticketCount+"</span>","       </p>",'       <div class="blank20"></div>','       <div class="wealth-5-container">','           <a href="javascript:;" class="wealth-5-btn-use-down-load-ticket btn-gray btn-m">',"           \u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d","           </a>",'           <a href="javascript:;" class="wealth-5-btn-use-free btn-green btn-m" >','               <i class="btn-ico"></i><span>\u514d\u4e0b\u8f7d\u5238\u4e0b\u8f7d</span>',"           </a>","       </div>","   </div>",function(){return t.options.isShowVcode?t.publicTpl.vcodeTpl:void 0
}(),'   <div class="dialog-bottom">','       <p class="bottom-btn">','           <i class="iconfont" style="color:#2FAD85">&#xe601;</i>','           <a href="http://wenku.baidu.com/task/browse/reward" target="_blank">',"              \u505a\u4efb\u52a1\u8d5a\u53d6\u8d22\u5bcc\u503c\u548c\u4e0b\u8f7d\u5238","           </a>","       </p>",t.publicTpl.vipFreeDocLimitedBottomTpl,'       <p class="price10-bottom-btn hide">\u7531\u4e8e\u6587\u6863\u4ef7\u683c\u8f83\u9ad8\uff0c\u5efa\u8bae\u60a8\u4f7f\u7528<span>\u4e0b\u8f7d\u7279\u6743</span>\u4e0b\u8f7d</p>','       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){this.$el.html(this.tpl()),this.options.isVipDocLimited&&this.vipFreeDocLimitedCountDown(),this.addEventListener()},addEventListener:function(){var t=this;this.$el.on("click",".btn-diaolog-downdoc",function(){return t.vcodePass?(t.vcodeError(),!1):(t.close(),a.xsend(1,100036),document.downloadForm.useTicket.value=0,void n.lang.eventCenter.dispatchEvent("download.toGetFile"))}),this.$el.on("click",".wealth-5-btn-use-down-load-ticket",function(){return t.vcodePass?(t.vcodeError(),!1):(t.close(),a.xsend(1,100036),document.downloadForm.useTicket.value=0,void n.lang.eventCenter.dispatchEvent("download.toGetFile"))}),this.$el.on("click",".wealth-5-btn-use-free",function(){if(t.options.needUticket<3&&t.options.wealth>=10){a.xsend(1,100565);var i="/cashier/browse/dispatch?dqStatCode=";i+="wkview_downdoc_needTicketLess3WealthMore10_20150915",i+="&from_doc="+c.DocInfo.docId,window.open(i)}if(t.options.needUticket>=3){a.xsend(1,100566);var i="/cashier/browse/dispatch?dqStatCode=";i+="wkview_downdoc_needTicketMore3_20150915",i+="&from_doc="+c.DocInfo.docId,window.open(i)}if(t.options.needUticket<3&&t.options.wealth<10){a.xsend(1,100567);var i="/cashier/browse/dispatch?dqStatCode=";i+="wkview_downdoc_needTicketLess3WealthLess10_20150915",i+="&from_doc="+c.DocInfo.docId,window.open(i)}}),this.$el.on("click",".price10-bottom-btn",function(){window.open("/cashier/browse/dispatch?dqStatCode=31_8_13_18&from_doc="+c.DocInfo.docId)})}},nonVipTicketsNonEnoughWeathEnough:{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container need-wealth">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac" style="padding-bottom: 0;">',t.publicTpl.wealth_doc_ad,'       <p class="ticket-num-msg msg1 coupon-need">\u9700\u8981\uff1a','<b class="ticket-need-num">'+t.options.needUticket+"</b>\u4e0b\u8f7d\u5238</p>",'       <p class="ticket-detail-msg msg2">',"\u60a8\u6301\u6709\uff1a"+t.options.UticketCount+"\u4e0b\u8f7d\u5238\uff08\u53ef\u7528\u8d22\u5bcc\u503c\u5151\u6362\u4e0b\u8f7d\u5238\uff09","       </p>","   </div>",'   <div class="ticket-no-wealth-container hide">','       <div class="ticket-btn-container ticket-btn-container-vip">','           <a href="javascript:;" class="ui-bz-btn-senior btn-exchange-down">','           <b class="ui-bz-btn-p-16 ui-bz-btc btn-ticket-exchange">\u5151\u6362\u540e\u4e0b\u8f7d</b>',"           </a>",function(){var i="";return t.options.isVipDoc?(i='<a href="javascript:;" class="btn-orange btn-m ticket-user-free-download ticket-user-free-download-btn">',i+='<p><span class="iconfont">&#xe64e;</span>VIP\u4e13\u4eab</p>0\u4e0b\u8f7d\u5238 \u4e0b\u8f7d',i+="</a>"):i='<a href="javascript:;" class="btn-gray btn-m ticket-user-free-download ticket-user-free-download-btn-normal">\u514d\u4e0b\u8f7d\u5238\u4e0b\u8f7d</a>',i}(),"       </div>",'       <div class="clear"></div>','       <div class="ticket-raido-container hidden">','           <div class="ticket-raido-bg">',"           </div>",'           <a class="btn-green btn-l ticket-exchange-download-btn',' ticket-exchange-download-btn-disable" href="javascript:;">\u5151\u6362\u5e76\u4e0b\u8f7d\u6587\u6863</a>',"       </div>","   </div>",function(){return t.options.isShowVcode?t.publicTpl.vcodeTpl:void 0}(),'   <div class="dialog-bottom">','       <p class="bottom-btn">','          <i class="iconfont" style="color:#2FAD85">&#xe601;</i>','           <a href="http://wenku.baidu.com/task/browse/reward" target="_blank">',"              \u505a\u4efb\u52a1\u8d5a\u53d6\u8d22\u5bcc\u503c\u548c\u4e0b\u8f7d\u5238","          </a>","       </p>",t.publicTpl.vipFreeDocLimitedBottomTpl,'       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){s.set("isDownloadTongJi",1);var t=this.options.needUticket-this.options.UticketCount;this.NTicket=t,this.options.NTicket=t,this.$el.html(this.tpl()),this.addEventListener(),this.$btn=this.$el.find(".ticket-exchange-download-btn"),this.$el.find(".ticket-no-wealth-container").removeClass("hide")},isDisableDownloadBtn:function(t){var i=this,o=this.options;return t=+t,t&&!(t>o.canUticket||0===t||t>500||t+o.UticketCount<o.needUticket)?(i.$btn.removeClass("ticket-exchange-download-btn-disable"),!0):(i.$btn.addClass("ticket-exchange-download-btn-disable"),!1)},getDefaultTicket:function(){var t=this.options;return t.canUticket>=50&&t.NTicket<=50?50:t.canUticket>=30&&t.NTicket<=30?30:t.canUticket>=10&&t.NTicket<=10?10:t.canUticket>=5&&t.NTicket<=5?5:(t.NTicket>t.canUticket&&$btn.addClass("ticket-exchange-download-btn-disable"),t.canUticket)},addEventListener:function(){var t=this;this.$el.on("click",".btn-ticket-exchange",function(){t.$el.find(".ticket-btn-container").addClass("hidden"),t.$el.find(".ticket-raido-container").removeClass("hidden");var i=t.getDefaultTicket(),o=new l({el:".ticket-raido-bg",allWealth:t.options.wealth,defaultTicket:i});t.isDisableDownloadBtn(i),e('input[name="target_uticket_num"]').val(i),o.on("ex:afterSelectTicket",function(i){t.isDisableDownloadBtn(i.ticket),e('input[name="target_uticket_num"]').val(i.ticket)}),a.xsend(1,100194,{isVip:t.options.isvip})}),this.$el.find(".ticket-exchange-download-btn").on("click",function(){return t.vcodePass?(t.vcodeError(),!1):void(e(this).hasClass("ticket-exchange-download-btn-disable")||(document.downloadForm.useTicket.value=0,t.close(),n.lang.eventCenter.dispatchEvent("download.toGetFile"),a.xsend(1,100036)))}),this.$el.find(".ticket-user-free-download").click(function(){var i="31_8_13_16";t.options.isVipDoc&&(i="new_vip_freedoc_style"),window.open("/cashier/browse/dispatch?dqStatCode="+i+"&from_doc="+c.DocInfo.docId)})}},nonVipTicketsNonEnoughWeathNonEnough:{tpl:function(){var t=this;return[t.publicTpl.dialogAdWrap,'<div class="dialog-container need-wealth nonVipTNEWNE">',t.publicTpl.publicHdTpl,'   <div class="dialog-inner tac">',t.publicTpl.wealth_doc_ad,'       <p class="ticket-num-msg msg1 coupon-need">\u6240\u9700\u4e0b\u8f7d\u5238\uff1a<b class="ml-5">',t.options.needUticket,"</b></p>",'       <p class="ticket-detail-msg msg2">','           \u60a8\u6301\u6709\uff1a<span class="col-red">'+t.options.UticketCount+"</span>\u4e0b\u8f7d\u5238\uff0c",'           <span class="ps">\u8d22\u5bcc\u503c\u4e0d\u8db3\uff0c\u65e0\u6cd5\u5151\u6362\u4e0b\u8f7d\u5238</span></p>',"       </p>",'       <div class="blank20"></div>','       <div class="diaolog-downdoc">',function(){var i="";return t.options.isVipDoc?(i='<a href="javascript:;" class="ui-bz-btn-senior btn-diaolog-downdoc btn-diaolog-downdoc-vipdoc">',i+='<p><span class="iconfont">&#xe64e;</span>VIP\u4e13\u4eab</p>0\u4e0b\u8f7d\u5238 \u4e0b\u8f7d',i+="</a>"):i='<a href="javascript:;" class="ui-bz-btn-senior btn-diaolog-downdoc"><b class="ui-bz-btn-p-16 ui-bz-btc">VIP\u514d\u4e0b\u8f7d\u5238\u4e0b\u8f7d</b></a>',i}(),"       </div>",'       <div class="user-dialog-download-btn-center hide">','           <a class="btn-diaolog-downdoc btn-green btn-l" href="javascript:void(0);">',"VIP\u514d\u4e0b\u8f7d\u5238\u4e0b\u8f7d</a>",'           <a class="btn-orange btn-l ml24" href="/user/mydocs?check_new_user_gift=1" style="display: none;" >','               <b class="gift-icon"></b>\u9886\u53d6\u65b0\u624b\u793c\u5305',"           </a>","       </div>","   </div>",function(){return t.options.isShowVcode?t.publicTpl.vcodeTpl:void 0}(),'   <div class="dialog-bottom">','       <p class="bottom-btn">','           <i class="iconfont" style="color:#2FAD85">&#xe601;</i>','           <a href="http://wenku.baidu.com/task/browse/reward" target="_blank">',"              \u505a\u4efb\u52a1\u8d5a\u53d6\u8d22\u5bcc\u503c\u548c\u4e0b\u8f7d\u5238","           </a>","       </p>",t.publicTpl.vipFreeDocLimitedBottomTpl,'       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("")},init:function(){this.$el.html(this.tpl()),s.set("isDownloadTongJi",0),this.options.check_new_user_gift&&(s.set("isDownloadTongJi",2),this.setNewUserGift()),this.addEventListener()},addEventListener:function(){var t=this,i=s.get("WkInfo").DocInfo.docId,o=[];this.$el.on("click",".btn-diaolog-downdoc",function(){t.close();var e=s.get("isDownloadTongJi");switch(t.options.isVipDoc&&(e=3),e){case 0:e="31_8_13_15";break;case 1:e="31_8_13_16";break;case 2:e="31_8_13_17";break;case 3:e="new_vip_freedoc_style"}o.push("/cashier/browse/dispatch?doc_id="),o.push(i),o.push("&dqStatCode="),o.push(e),window.open(o.join(""))})},setNewUserGift:function(){this.$el.find(".diaolog-downdoc").addClass("hide"),this.$el.find(".user-dialog-download-btn-center").removeClass("hide")}},downloadMuchTip:{tpl:function(){return['<div class="download-more">','   <span class="close-icon close-btn"></span>','   <span class="close-icon-hover"></span>','    <div class="msg">',"       <h2>\u60a8\u4eca\u5929\u7684\u4e0b\u8f7d\u64cd\u4f5c\u8fc7\u4e8e\u9891\u7e41\uff01</h2>",'       <p class="mb15">\u7a0d\u4f5c\u4f11\u606f\uff0c\u660e\u5929\u518d\u6765\u5427~</p>','       <a href="javascript:void(0);" class="ui-bz-btn-senior close-btn">','           <b class="ui-bz-btn-p-40 ui-bz-btc btn">\u77e5\u9053\u4e86</b>',"        </a>","    </div>",'   <div class="edu-icon"></div>',"</div>"].join("")},init:function(){this.$el.html(this.tpl())}},guidetips:{tpl:function(){return['<div class="guideOfWealthDoc">','   <a href="javascript:;" class="btn-close"></a>','   <a href="/cashier/browse/dispatch?dqStatCode=wkview_guidedocdown_joinin_20150917&from_doc='+c.DocInfo.docId,'" class="ui-bz-btn-normal btn-vip log-xsend" data-logxsend="[1, 100571]">','       <b class="ui-bz-btn-p-16 ui-bz-btc">\u7acb\u5373\u4f53\u9a8cVIP\u901a\u9053</b>',"   </a>",'   <a href="javascirpt:;" class="ui-bz-btn-senior btn-continue">','       <b class="ui-bz-btn-p-16 ui-bz-btc">\u7ee7\u7eed\u4e0b\u8f7d ></b>',"   </a>","</div>"].join("")},init:function(){var t=this,i=this.getDate().today;n.cookie.get("wk_guidetips")!==i?(n.cookie.set("wk_guidetips",i,{expires:31536e6,path:"/"}),this.$el.html(this.tpl()),this.addEventListener(),a.xsend(1,100569)):this.close(function(){t.options.callback()})},addEventListener:function(){var t=this;this.$el.on("click",".btn-continue",function(){t.close(function(){a.xsend(1,100569),t.options.callback()})}),this.$el.on("click",".btn-close",function(){t.close(function(){a.xsend(1,100568),t.options.callback()})})}}};o.exports=u});
;define("wkview:widget/ui/view/down_doc/down_doc.js",function(e,i,t){var a=e("wkcommon:widget/lib/tangram/base/base.js"),o=e("wkcommon:widget/ui/js_core/dialog/dialog.js"),n=(e("wkview:widget/ui/view/operate/operate.js"),e("wkview:widget/ui/view/favorite/favorite.js"),e("wkcommon:widget/lib/fis/data/data.js")),d=e("wkcommon:widget/ui/js_core/log/log.js"),c=e("wkcommon:widget/ui/js_core/util/util.js"),s=(e("wkcommon:widget/ui/js_core/login/login.js").login,e("wkcommon:widget/ui/lib/cookie/cookie.js")),l=n.get("WkInfo"),r=(e("wkview:widget/ui/view/down_doc/downRec.js"),e("wkcommon:widget/ui/lib/jquery/jquery.js")),p=(e("wkview:widget/ui/file_downloader_ui/file_downloader_ui.js"),e("wkcommon:widget/ui/lib/cookie/cookie.js"),e("wkview:widget/ui/view/down_doc/down_org_vip.js")),u=e("wkview:widget/ui/dialog_down_doc/dialog_down_doc.js"),w=(e("wkcommon:widget/ui/js_core/xform/xform.js"),e("wkview:widget/ui/view/down_doc/dialog_down_doc/dialog_down_doc.js")),g=function(){var e=null;return function(){return e||(e=o.dialogCreate()),e}}(),v=(new u,function(){var e=function(){this.init.apply(this)};return r.extend(e.prototype,{userData:{},publicData:{isInit:!1,dialogWindow:!1},init:function(){var e=this;e.WkInfo=l,e.UserInfo=e.WkInfo.UserInfo,e.UserInfo&&(e.isCreater=e.UserInfo.isCreater),e.docSize=(e.WkInfo.DocInfo.size/1024+"").replace(/^(\d+\.\d)\d+$/,"$1"),e.urlInterfaceGetRepeatDown=e.WkInfo.Urls.interfaceGetRepeatDown,e.docId=e.WkInfo.DocInfo.docId,e.isPaymentDoc=e.WkInfo.DocInfo.isPaymentDoc,e.isPaied=e.WkInfo.DocInfo.ispaied,e.is_edu_doc=parseInt(e.WkInfo.DocInfo.is_edu_doc),e.isTicket=parseInt(e.WkInfo.DocInfo.docTicket,10),e.endTime=parseInt((new Date(2015,8,30,23,59,59).getTime()-(new Date).getTime())/1e3,10),e.endTime=e.endTime>0?1:0,e.isEduLimitedDoc=e.is_edu_doc&&!e.isPaymentDoc&&e.isTicket,this.publicData.isInit===!1&&(a.lang.eventCenter.addEventListener("download.toGetFile",function(){e.getFile()}),a.lang.eventCenter.addEventListener("download.hao123.toGetFile",function(){e.hao123GetFile()}),a.lang.eventCenter.addEventListener("download.checkVipDownload",function(){e.checkVipDownload()}),this.publicData.isInit=!0)},start:function(e){var i=this;if(!i.UserInfo)return void window.location.reload();if(i.isCreater)return void a.lang.eventCenter.dispatchEvent("download.toGetFile");var t=r.ajax({url:i.urlInterfaceGetRepeatDown,cache:!1,type:"post",dataType:"json",data:{atype:"getRepeatDown",doc_id:i.docId}}),o=r.ajax({url:"/activity/interface/getactivityinfo?doc_id="+i.docId,dataType:"json",cache:!1});r.when(t,o).always(function(t,a){if(t=200009===parseInt(t.errno,10)?0:parseInt(t,10)||0,a&&a[0]&&(a=a[0],i.userData.hasActivityAferDownload=0===a.status.code),i.isShowVcode=200008===parseInt(t,10)?!0:!1,e&&r.ajax({type:"get",async:!1,cache:!1,url:"/user/interface/getvipfreedoc?doc_id="+i.docId,success:function(e){var t=!1,a=!1,o=0,d=n.get("WkInfo"),c=+d.DocInfo.is_edu_doc||0,s=+d.DocInfo.isPaymentDoc||0,l=+d.DocInfo.docTicket||0,r=c&&!s&&l,p=new Date(2015,8,30,23,59,59).getTime(),u=parseInt((p-(new Date).getTime())/1e3,10);e&&0===+e.status.code&&(e.data.is_vip_free_doc&&(t=!0),(e.data.is_vip_doc_limited&&e.data.vip_doc_limited_time||r&&u>0&&!e.data.is_vip_free_doc)&&(a=!0,o=r&&u>0?u:e.data.vip_doc_limited_time)),n.set("VipFreeDoc",t),i.isVipDoc=t}}),200009===parseInt(t.errno,10)&&"ok"!==s.get("wk_bindemaillater"))return void i.bindEmailLater(t.token);if(i.isPaymentDoc&&i.isPaied)return void i.pay("PaymentDoc");if(1===t)return void i.pay("payed");if(2===t)return void i.pay("saved");if(void 0==e){var o=p;return void o.init({WkInfo:i.WkInfo,docSize:i.docSize,downDoc:v})}i.getUserDownloadTicket()})},getUserDownloadTicket:function(){var e=this;r.ajax({url:"/customer/interface/getuserdownloadticket",type:"post"}).done(function(i){var t={};i&&0===i.status.code&&(t=i.data),e.userData.UticketCount=parseInt(t.uticket)>0?t.uticket:0,e.userData.exchangeRate=parseInt(t.exchangeRate)||4,e.userData.canDownload=parseInt(t.canDownload)||1,e.userData.needUticket=Number(e.WkInfo.DocInfo.docTicket),e.userData.wealth=~~t.wealth||~~e.UserInfo.wealth,console.log(e.userData.wealth),e.userData.canUticket=parseInt(e.userData.wealth/e.userData.exchangeRate,10),e.userData.isPaymentDoc=e.isPaymentDoc,e.userData.price=Number(e.WkInfo.DocInfo.price),e.userData.isShowVcode=e.isShowVcode,e.userData.isvip=+t.isvip,e.userData.ticketCount=parseInt(t.ticket,10)>0?t.ticket:0,e.userData.is_edu_vip=parseInt(t.edu_vip_data.is_edu_vip,10),e.userData.edu_download_ticket=parseInt(t.edu_vip_data.edu_download_ticket,10)>0?parseInt(t.edu_vip_data.edu_download_ticket,10):0,e.userData.is_mini_vip=+t.mini_vip,e.userData.is_mini_time=+t.remain_time>0?+t.remain_time:0,e.userData.check_new_user_gift=t.check_new_user_gift||0,e.userData.isVipDoc=e.isVipDoc,e.userData.isVipDocLimited=e.isVipDocLimited,e.userData.vipDocLimitedTime=e.vipDocLimitedTime;var a=location.href;a.indexOf("fr=jp")>=0&&d.xsend(1,100700);var o=e.userData.isvip||e.userData.is_edu_vip,n=o&&e.userData.isVipDocLimited;e.isEduLimitedDoc&&e.endTime&&n?r.ajax({url:"/activity/interface/2015sepeduvipdowncheck",cache:!1,type:"get",success:function(i){0===i.data.can_download?(e.publicData.dialogWindow||(e.publicData.dialogWindow=w.get("downloadMuchTip",e.userData)),e.publicData.dialogWindow.show(function(){})):e.dialogDownDoc(t,e.userData)}}):e.dialogDownDoc(t,e.userData)})},dialogDownDoc:function(e,i){var t=this,a=i;return 0===parseInt(a.needUticket)?t.publicData.dialogWindow?void t.publicData.dialogWindow.show(function(){1===parseInt(a.isvip)?d.xsend(1,100112):d.xsend(1,100111)}):(t.publicData.dialogWindow=w.get("freeDocDialog",a),void t.publicData.dialogWindow.show(function(){1===parseInt(a.isvip)?d.xsend(1,100112):d.xsend(1,100111),d.xsend(1,100782,{index:2})})):void(t.checkVipDownload()||t.checkNoVipDownLoad())},checkVipDownload:function(){var e=this,i=e.userData;if((1===i.isvip||1===i.is_edu_vip)&&(e.isVipDoc||e.isVipDocLimited))return e.publicData.dialogWindow||(e.publicData.dialogWindow=w.get("vipFreeDocDialog",i)),e.publicData.dialogWindow.show(function(){d.xsend(1,100273)}),!0;if(1===e.is_edu_doc){if(1===i.isvip&&1===i.is_edu_vip&&1!==i.is_mini_vip)return e.publicData.dialogWindow||(e.publicData.dialogWindow=w.get("eduNormalVipDocDialog",i),e.publicData.dialogWindow.setDialog(w)),e.publicData.dialogWindow.show(function(){d.xsend(1,100346)}),!0;if(1===i.is_edu_vip)return e.publicData.dialogWindow||(e.publicData.dialogWindow=w.get("eduNormalVipDocDialog",i),e.publicData.dialogWindow.setDialog(w)),e.publicData.dialogWindow.show(function(){d.xsend(1,100343)}),!0;if(1===i.isvip){var t="";return 1===i.is_mini_vip?(i.ticketCount>0?(e.publicData.dialogWindow=w.get("miniVipTicketDocDialog",i),t="100344"):(e.publicData.dialogWindow||(e.publicData.dialogWindow=w.get("miniVipNoTicketDocDialog",i),e.publicData.dialogWindow.setDialog(w)),t="100345"),e.publicData.dialogWindow.show(function(){d.xsend(1,t)}),!0):(i.ticketCount>0?(e.publicData.dialogWindow||(e.publicData.dialogWindow=w.get("normalVipTicketDocDialog",i),e.publicData.dialogWindow.setDialog(w)),t="100344"):(e.publicData.dialogWindow||(e.publicData.dialogWindow=w.get("normalVipNoTicketDocDialog",i),e.publicData.dialogWindow.setDialog(w)),t="100345"),e.publicData.dialogWindow.show(function(){d.xsend(1,t)}),!0)}}if(1!==e.is_edu_doc&&(1===i.isvip||1===i.is_edu_vip)){var t="";return 1===i.is_mini_vip?(i.ticketCount>0?(e.publicData.dialogWindow=w.get("miniVipTicketDocDialog",i),t="100344"):(e.publicData.dialogWindow||(e.publicData.dialogWindow=w.get("miniVipNoTicketDocDialog",i),e.publicData.dialogWindow.setDialog(w)),t="100345"),e.publicData.dialogWindow.show(function(){d.xsend(1,t)}),!0):(i.ticketCount>0?(e.publicData.dialogWindow||(e.publicData.dialogWindow=w.get("normalVipTicketDocDialog",i),e.publicData.dialogWindow.setDialog(w)),t="100113"):(e.publicData.dialogWindow||(e.publicData.dialogWindow=w.get("normalVipNoTicketDocDialog",i),e.publicData.dialogWindow.setDialog(w)),t="100114"),e.publicData.dialogWindow.show(function(){d.xsend(1,t)}),!0)}return!1},checkNoVipDownLoad:function(){var e=this,i=e.userData;if(1!==i.isvip&&1!==i.is_edu_vip&&i.UticketCount>=i.needUticket)return console.log("nonVipTicketsEnough"),e.publicData.dialogWindow=w.get("nonVipTicketsEnough",i),e.publicData.dialogWindow.show(function(e){e.$el.find(".close-btn").show(),d.xsend(1,100115)}),!0;if(1!==i.isvip&&1!==i.is_edu_vip&&i.UticketCount<i.needUticket&&i.canUticket+i.UticketCount>=i.needUticket){console.log("nonVipTicketsNonEnoughWeathEnough");var t="nonVipTicketsNonEnoughWeathEnough";return e.publicData.dialogWindow=w.get(t,i),e.publicData.dialogWindow.show(function(e){e.$el.find(".close-btn").show(),d.xsend(1,100115)}),!0}if(1!==i.isvip&&1!==i.is_edu_vip&&i.UticketCount<i.needUticket&&i.canUticket+i.UticketCount<i.needUticket){console.log("nonVipTicketsNonEnoughWeathNonEnough");var t="nonVipTicketsNonEnoughWeathNonEnough";return e.publicData.dialogWindow=w.get(t,i),e.publicData.dialogWindow.show(function(e){e.$el.find(".close-btn").show(),d.xsend(1,100117)}),!0}return e.publicData.dialogWindow.show(),!0},pay:function(e,i){var t=this,o=t.WkInfo.DocInfo,c=n.get("taskData")||{},s={docId:o.docId,docType:o.docType,cid1:o.cid1,cid2:o.cid2,cid3:o.cid3,cid4:o.cid4},l={first:["",'<p class="c-gray9"><a style="color: #999;text-decoration: underline;" href="http://wenku.baidu.com/topic/money_2014/" target="_blank">\u9650\u65f6\u62a2\u5151\u4e0b\u8f7d\u5238\uff0c\u6587\u6863\u514d\u8d39\u4e0b>></a></p>'].join(""),saved:['<p class="c-gray9">\u53bb>><a href="/room?from=down_saved_pop_tip" target="_blank">\u6211\u7684\u6587\u5e93</a>\u67e5\u770b\u81ea\u5df1\u6240\u6709\u7684\u6587\u6863\uff0c\u8fd8\u53ef\u4ee5\u5c06\u6587\u6863\u516c\u5f00\u5230\u6587\u5e93\uff0c\u8d5a\u53d6\u8d22\u5bcc\u503c\uff01</p>'].join(""),free:"<p>\u8fd9\u662f\u514d\u8d39\u6587\u6863\uff0c\u60a8\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d\u6216\u514d\u8d39\u6536\u85cf\uff1b</p>",download:"<p>\u53ef\u514d\u8d39\u6536\u85cf\u8be5\u6587\u6863\uff1b\u4e00\u4e2a\u6708\u5185\u91cd\u590d\u4e0b\u8f7d\u514d\u8d39\uff1b</p>",xunlei:'<p>\u6682\u4e0d\u652f\u6301\u8fc5\u96f7\u7b49\u5de5\u5177\u4e0b\u8f7d\uff0c<a class="c-gray9" href="http://www.baidu.com/search/wenku/help/help.html?nav=31" target="_bland">\u67e5\u770b\u5e2e\u52a9</a>\u3002</p>'},r={payed:function(i){i.height=290;var o=t.WkInfo.DocInfo.title;o=a.string.getByteLength(o)<26?o:a.string.subByte(o,26,"..."),i.content=u.payed.replace("{title}",o).replace("{price}",t.WkInfo.DocInfo.price).replace("{size}",t.docSize).replace("{txt}",l.xunlei),g().confirm({title:i.title,content:i.content,width:i.width,height:i.height,className:"wk-downdoc-dialog",btnText:["\u4e0b\u8f7d","\u53d6\u6d88"],onOk:function(){t.getFile(e),d.xsend(1,100036),d.send("down","docdownload",a.object.merge(s,{repeat:1}))}})},saved:function(i){i.height=290;var o=t.WkInfo.DocInfo.title;o=a.string.getByteLength(o)<26?o:a.string.subByte(o,26,"..."),i.content=u.saved.replace("{title}",o).replace("{size}",t.docSize).replace("{txt}",l.saved),g().confirm({title:i.title,content:i.content,width:i.width,height:i.height,className:"wk-downdoc-dialog",btnText:["\u4e0b\u8f7d","\u53d6\u6d88"],onOk:function(){t.getFile(e),d.xsend(1,100036),d.send("down","docdownload",a.object.merge(s,{repeat:1}))}})},PaymentDoc:function(i){i.height=260;var o=t.WkInfo.DocInfo.title;o=a.string.getByteLength(o)<26?o:a.string.subByte(o,26,"..."),i.content=u.PaymentDoc.replace("{title}",o).replace("{size}",t.docSize),t.bindSaveEvent(),g().confirm({title:i.title,content:i.content,width:i.width,height:i.height,btnText:["\u4e0b\u8f7d","\u53d6\u6d88"],className:"wk-downdoc-dialog",onOk:function(){t.getFile(e),d.xsend(1,100036),d.send("down","docdownload",a.object.merge(s,{repeat:0}))}})}},p={docTitle:['<div class="title">{title}<span class="c-gray9">({size}KB)</span></div>'].join(""),tabControl:['<div class="tabControl">','<div class="use-wealth ib">\u4f7f\u7528\u8d22\u5bcc\u503c\u4e0b\u8f7d</div>','<div class="use-ticket ib">\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d</div>',"</div>"].join(""),wealthInfo:['<div class="info">',"<p>\u4e0b\u8f7d\u6240\u9700\u8d22\u5bcc\u503c\uff1a{price}</p>",'<p>\u60a8\u5269\u4f59\u8d22\u5bcc\u503c\uff1a<span class="c-orange">{wealth}</span></p>',"</div>"].join(""),ticketInfo:['<div class="info">',"<p>\u4e0b\u8f7d\u6240\u9700\u4e0b\u8f7d\u7279\u6743\uff1a{needTicket}</p>",'<p>\u60a8\u5269\u4f59\u4e0b\u8f7d\u7279\u6743\uff1a<span class="c-orange">{ticket}</span></p>',"</div>"].join(""),saveControl:['<div class="box ml20 mt10 c-gray9" style="line-height: 20px;">','<div class="media" style="margin:0"><input type="checkbox" checked id="choice-for-saved" class="choice-for-saved" value="0"/></div>','<div class="content">{txt}</div>',"</div>"].join(""),noWealth:['<div class="info">',"<p>\u4e0b\u8f7d\u6240\u9700\u8d22\u5bcc\u503c\uff1a{price}</p>",'<p class="c-red">\u60a8\u5f53\u524d\u7684\u8d22\u5bcc\u503c\u4e3a{wealth}\uff0c\u4e0d\u8db3\u4ee5\u652f\u4ed8\u4e0b\u8f7d\u3002</p>','<p class="c-red">\u4f46\u60a8\u4e5f\u53ef\u4ee5\u514d\u8d22\u5bcc\u503c\u4e0b\u8f7d\u5230\u624b\u673a\u5ba2\u6237\u7aef\u4e2d\u3002<a href="javascript:void(0);" class="fsm-btn">\u7acb\u5373\u4e0b\u8f7d\u5230\u624b\u673a</a></p>',"</div>",'<div class="you-can">',"<dl>",'<dt class="c-gray9">\u60a8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u9014\u5f84\u83b7\u53d6\u8d22\u5bcc\u503c:</dt>','<dd>1.\u4f7f\u7528<a href="http://liulanqi.baidu.com/landingPage/index.html#page=5" target="_blank">\u767e\u5ea6\u6d4f\u89c8\u5668</a>\uff0c\u6bcf\u592912\u70b9\u8d22\u5bcc\u503c\u8f7b\u677e\u5f97\uff01',"<dd>2.\u4e0a\u4f20\u6587\u6863</dd>","</dl>","</div>",'<div class="read-more">','<a href="http://www.baidu.com/search/wenku/help.html#\u5982\u4f55\u83b7\u53d6\u79ef\u5206" target="_blank">',"\u4e86\u89e3\u66f4\u591a\u7684\u8d22\u5bcc\u503c\u8be6\u60c5&gt;&gt;","</a>","</div>"].join(""),noWealthNew:['<div class="title">','<p><span class="c-gray9">\u300a{title}\u300b</span>\u4e0b\u8f7d\u9700\u8981{price}\u8d22\u5bcc\u503c<p>','<p>\u60a8\u7684\u8d22\u5bcc\u503c\u4e3a<span class="c-red">{wealth}</span>\uff0c\u4e0d\u8db3\u4ee5\u652f\u4ed8\u3002\u60a8\u53ef\u4ee5\uff1a</p>',"</div>",'<div class="you-can clearfix">','<dl class="item-block item-join-vip">',"<dt>",function(){var e=n.get("WkInfo").DocInfo.docId;return'<a href="/cashier/browse/dispatch?doc_id='+e+'" target="_blank" class="hl">'}(),'<span class="bg-img"></span>','<span class="item-title">\u52a0\u5165\u6587\u5e93VIP</span>',"</a>","</dt>",'<dd class="item-des">\u4e13\u4eabVIP\u514d\u8d22\u5bcc\u503c\u4e0b\u8f7d\u7279\u6743</dd>',"</dl>","</div>",'<div class="read-more">',c.hasGrownupData===!0?'<a href="/user/task?tab=0&fr=downPop" target="_blank">\u53c2\u52a0\u4efb\u52a1</a>':'<a href="/user/task?tab=1&fr=downPop" target="_blank">\u53c2\u52a0\u4efb\u52a1</a>','\u3001<a href="/new?fr=downPop" target="_blank">\u4e0a\u4f20\u6587\u6863</a> \u4e5f\u53ef\u83b7\u5f97\u8d22\u5bcc\u503c <br/>','<a href="###" class="fsm-btn">\u6587\u5e93\u5ba2\u6237\u7aef\u514d\u8d22\u5bcc\u503c\u4e0b\u8f7d</a>',"</div>"].join(""),noTicket:['<div class="info">',"<p>\u4e0b\u8f7d\u6240\u9700\u4e0b\u8f7d\u7279\u6743\uff1a{needTicket}</p>",'<p class="c-red">\u60a8\u5f53\u524d\u7684\u4e0b\u8f7d\u7279\u6743\u4e3a{ticket}\uff0c\u4e0d\u8db3\u4ee5\u652f\u4ed8\u4e0b\u8f7d\u3002</p>','<p class="c-red">\u60a8\u53ef\u4ee5\u7eed\u8d39\u6587\u5e93VIP\uff0c\u7eed\u8d393\u6708\u900110\u5f20\u3002</p>',"</div>","noticket"===i?"":['<div class="you-can">',"<dl>",'<dt class="c-gray9">\u6210\u4e3a\u6587\u5e93VIP\uff0c\u60a8\u5c06\u62e5\u6709\u4ee5\u4e0b\u6743\u5229:</dt>',"<dd>1.\u4e07\u518c\u7cbe\u54c1\u5185\u5bb9\u514d\u8d39\u770b</dd>","<dd>2.\u6bcf\u6708\u798f\u5229\u76f8\u9001\uff0c\u4e0b\u8f7d\u7279\u6743\u8ba9\u60a8\u8d22\u5bcc\u503c\u6587\u6863\u968f\u4fbf\u4e0b</dd>","<dd>3.\u4ed8\u8d39\u5185\u5bb9\u4eab\u6298\u6263\uff0c\u6700\u4f4e\u81f38\u6298</dd>","</dl>","</div>",'<div class="read-more">',function(){var e=n.get("WkInfo").DocInfo.docId;return'<a href="/cashier/browse/dispatch?doc_id='+e+'" target="_blank">'}(),"\u4e86\u89e3\u66f4\u591a\u7684\u6587\u5e93VIP\u8be6\u60c5&gt;&gt;","</a>","</div>"].join("")].join(""),joinvip:['<div class="box mt10 pt10 mv20 jvt-in-dl-pop">','<div class="media"><b class="ic ic-dl-pav"></b></div>','<div class="content">',function(){var e=n.get("WkInfo").DocInfo.docId;return'<p>\u52a0\u5165\u6587\u5e93VIP\uff0c\u6bcf\u6708\u83b7\u8d60\u4e0b\u8f7d\u7279\u6743\uff0c\u65e0\u9700\u8d22\u5bcc\u503c\u4e5f\u80fd\u4e0b\u6587\u6863<br/><a href="/cashier/browse/dispatch?doc_id='+e+'&dqStatCode=31_8_9_12" target="_blank">\u7acb\u5373\u52a0\u5165&gt;&gt;</a></p>'}(),"</div>","</div>"].join(""),docTitleNew:['<div class="title-new"><span class="down-title-icon"></span>{title}<span class="c-gray9">({size}KB)</span></div>'].join(""),wealthInfoNew:['<div class="wealth-info-new">','<span class="price">\u6240\u9700\u8d22\u5bcc\u503c\uff1a<span class="mv5 c-read-red">{price}</span></span>','<span class="ml20 wealth">\u60a8\u5269\u4f59\u8d22\u5bcc\u503c\uff1a<span class="mv5 c-read-red">{wealth}</span></span>',"</div>"].join(""),wealthInfoNewNotEnough:['<div class="wealth-info-new">','<span class="price">\u60a8\u5269\u4f59<span class="mv5 c-read-red">{wealth}</span>\u8d22\u5bcc\u503c\uff0c\u4e0d\u8db3\u4ee5\u652f\u4ed8\u4e0b\u8f7d\u3002</span>',"</div>"].join(""),saveDoc:['<div class="save-doc">','<a style="color: #999;text-decoration: underline;" href="http://wenku.baidu.com/topic/money_2014/" target="_blank">\u9650\u65f6\u62a2\u5151\u4e0b\u8f7d\u5238\uff0c\u6587\u6863\u514d\u8d39\u4e0b>></a>',"</div>"].join(""),getWealthFooter:['<div class="get-wealth-footer" style="height:63px;">',c.hasGrownupData===!0?'<a class="task ml5" href="/user/task?tab=0&fr=downPop" target="_blank">\u53c2\u52a0\u4efb\u52a1</a>':'<a class="task ml5" href="/user/task?tab=1&fr=downPop" target="_blank">\u53c2\u52a0\u4efb\u52a1</a>','\u3001<a href="/new?fr=downPop" target="_bland" class="upload">\u4e0a\u4f20\u6587\u6863</a>\u83b7\u53d6\u8d22\u5bcc\u503c','<a class="task ml5" style="background:none;color:#bebebe;font-size:9px;float:left;line-height:0px;text-decoration: none;">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u503c\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</a>',"</div>"].join(""),ticketNew:['<div class="ticket-content">','<div class="price-info">\u6240\u9700\u8d22\u5bcc\u503c\uff1a<span class="mv5 c-read-red">{price}</span></div>','<div class="btn-content">','<div class="ticket-btn-wp btn-wp">','<a href="###" class="bt ui-btn ui-btn-32-green j_ticket-btn"><b class="btc"><b class="btText">\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743<span class="recommend"></span></b></b></a>','<div class="btn-bg-wp"><div class="btn-bg '+(t.ticketCount<=10?"show-vip-guide":"")+'">','<div class="btn-bg-info">','<div class="need">\u6240\u9700\u4e0b\u8f7d\u7279\u6743\uff1a<span class="c-gray3">{needTicket}</span></div>','<div class="have">\u5269\u4f59\u4e0b\u8f7d\u7279\u6743\uff1a<span class="">{ticket}</span></div>',"</div>",'<div class="vip-guide">','<a href="###" class="vip-guide-btn j_vip-guide"></a>','<span class="vip-guide-txt">\u7eed\u8d393\u6708\u900110\u5f20</span>',"</div>","</div></div>","</div>",'<div class="wealth-btn-wp btn-wp">','<a href="###" class="bt ui-btn ui-btn-32-light j_wealth-btn"><b class="btc"><b class="btText">\u4f7f\u7528\u8d22\u5bcc\u503c</b></b></a>','<div class="btn-bg-wp"><div class="btn-bg">','<div class="btn-bgf-info">',Number(t.WkInfo.UserInfo.wealth)<Number(t.WkInfo.DocInfo.price)?'<div class="have nohave c-read-red">\u60a8\u7684\u8d22\u5bcc\u503c\u4e0d\u8db3\u4ee5\u652f\u4ed8\u4e0b\u8f7d</div>':'<div class="need">\u6240\u9700\u8d22\u5bcc\u503c\uff1a<span class="c-gray3">{price}</span></div><div class="have">\u5269\u4f59\u8d22\u5bcc\u503c\uff1a<span class="">{wealth}</span></div>',"</div>","</div></div>","</div>","</div>","</div>"].join("")},u={first:['<div class="dlg-down">',p.docTitle,p.wealthInfo,p.saveControl,"</div>"].join(""),payed:['<div class="dlg-down">',p.docTitle,'<div class="info">','<p>\u4f60\u5df2\u4e3a\u8be5\u6587\u6863\u8fdb\u884c\u8fc7\u652f\u4ed8\uff0c\u672c\u6b21\u4e0b\u8f7d<span class="c-red">\u514d\u8d39</span></p>',"</div>",'<div class="pl20 pt5 c-gray9">{txt}</div>',"</div>"].join(""),saved:['<div class="dlg-down">',p.docTitle,'<div class="info">','<p>\u4f60\u5df2\u8f6c\u5b58\u8fc7\u6b64\u6587\u6863\u81f3>><a href="/room?from=down_saved_pop" target="_blank">\u6211\u7684\u6587\u5e93</a>\uff0c\u6c38\u4e45<span class="c-red">\u514d\u8d39\u4e0b\u8f7d</span></p>',"</div>",'<div class="pl20 pt5 c-gray9">{txt}</div>',"</div>"].join(""),ticket:['<div class="dlg-down">',p.ticketContent,"</div>"].join(""),PaymentDoc:['<div class="dlg-down">',p.docTitle,'<div class="info">','<p>\u60a8\u5df2\u8d2d\u4e70\u6b64\u6587\u6863\uff0c\u6c38\u4e45<span class="c-red">\u514d\u8d39\u4e0b\u8f7d</span></p>',"</div>","</div>"].join(""),noWealth:['<div class="dlg-down dlg-down-noWealth">',p.docTitle,p.noWealth,p.joinvip,"</div>"].join(""),noWealthNew:['<div class="dlg-down dlg-down-noWealth">',p.noWealthNew,"</div>"].join(""),firstNew:['<div class="dlg-down has-sns '+(Number(t.WkInfo.DocInfo.price)>=10?"dlg-price-gt10":"")+'">',p.docTitleNew,p.wealthInfoNew,p.saveDoc,p.getWealthFooter,function(){var e=n.get("WkInfo").DocInfo.docId;return Number(t.WkInfo.DocInfo.price)>=10?'<span class="price-gt10">\u7531\u4e8e\u6587\u6863\u4ef7\u683c\u8f83\u9ad8\uff0c\u5efa\u8bae\u60a8\u4f7f\u7528<a target="_blank" href="/cashier/browse/dispatch?doc_id='+e+'" class="gt10-link">\u4e0b\u8f7d\u7279\u6743</a>\u4e0b\u8f7d</span>':""}(),"</div>"].join(""),noWealthNewX:['<div class="dlg-down dlg-down-noWealth">','<div class="title-new"><span class="down-title-icon"></span>{title}<span class="c-gray9">({price}\u8d22\u5bcc\u503c)</span></div>',p.wealthInfoNewNotEnough,p.getWealthFooter,"</div>"].join(""),ticketNew:['<div class="dlg-down dlg-down-ticketNew">',p.docTitleNew,p.ticketNew,p.getWealthFooter,"</div>"].join("")},w={title:"\u6587\u6863\u4e0b\u8f7d",width:360},v=t.WkInfo.DocInfo.title;v=a.string.getByteLength(v)<26?v:a.string.subByte(v,26,"..."),document.downloadForm.storage.value=0,document.downloadForm.useTicket.value=0,r[e](w)},getFile:function(e){console.log("getFile:"+e);var i=this,t=!1;"payed"==e?(g().confirm({title:"\u4e0b\u8f7d\u6587\u6863",content:'<iframe width="460" height="220" name="runDown" frameborder="0"></iframe>',width:500,height:220,onRendered:function(){i.postGetFile()}}),g().hide()):(g().confirm({title:"\u4e0b\u8f7d\u6587\u6863",content:'<iframe name="runDown" frameborder="0"></iframe>',width:500,btnText:["\u4e0b\u8f7d","\u53d6\u6d88"],onRendered:function(){i.postGetFile(),t||(t=!0,"1"===document.downloadForm.storage.value&&a.ajax.get("/user/submit/foldutimeupdate?atype=updateFoldUTime&fold_id=0&_t="+(new Date).getTime()))},onOk:function(){i.postGetFile(),"first"!==e&&"ticket"!==e||t||(t=!0,"1"===document.downloadForm.storage.value&&a.ajax.get("/user/submit/foldutimeupdate?atype=updateFoldUTime&fold_id=0&_t="+(new Date).getTime()))}}),g().hide()),d.xsend(1,100337)},hao123GetFile:function(){var e=this,i=g;i().confirm({title:"\u4e0b\u8f7d\u6587\u6863",content:'<iframe width="460" height="220" name="runDown" frameborder="0"></iframe>',width:500,height:220,onRendered:function(){var i=((e.WkInfo.DocInfo.size/1024+"").replace(/^(\d+\.\d)\d+$/,"$1"),e.WkInfo.DocInfo.docType,r(document.downloadForm));i.attr("action","/user/submit/downloadnew");var t=window.postVcode||0,o=window.postVinput||0;i.find("input[name=v_code]").val(t),i.find("input[name=v_input]").val(o),i.append('<input type="hidden" name="down_process" value="9">'),a.lang.eventCenter.dispatchEvent("download.realStart",{hasActivityAferDownload:e.userData.hasActivityAferDownload}),document.downloadForm.submit()}}),i().hide()},bindSaveEvent:function(){var e=g().el,i=a.dom.getAttr(e,"data-is-bind-save");"binded"!==i&&(c.delegate(e,".choice-for-saved","click",function(){this.checked?document.downloadForm.storage.value=1:(document.downloadForm.storage.value=0,d.send("down","cancel_copy"))}),a.dom.setAttr(e,"data-is-bind-save","binded")),document.downloadForm.storage.value=1},postGetFile:function(){{var e=this,i=0,t=e.WkInfo.DocInfo.size;e.WkInfo.DocInfo.docType}d.send("down","down_doc_tongji",{size:t,useMutli:i});var o=window.postVcode||0,n=window.postVinput||0;r(document.downloadForm).find("input[name=v_code]").val(o),r(document.downloadForm).find("input[name=v_input]").val(n),a.lang.eventCenter.dispatchEvent("download.realStart",{hasActivityAferDownload:e.userData.hasActivityAferDownload});var c=e.userData.isvip||e.userData.is_edu_vip,s=c&&e.userData.isVipDocLimited;if(e.isEduLimitedDoc&&e.endTime&&s){var l=r(document.downloadForm);l.attr("action","/user/submit/downloadnew"),l.append('<input type="hidden" name="down_process" value="10">'),document.downloadForm.submit()}else document.downloadForm.submit();d.xsend(1,100580)},bindEmailLater:function(e){var i=passport.pop.ArmorWidget("bindemail",{token:e,title:"\u8bf7\u60a8\u7ed1\u5b9a\u90ae\u7bb1",msg:"",auth_title:"\u8bf7\u60a8\u7ed1\u5b9a\u90ae\u7bb1",auth_msg:"\u767e\u5ea6\u6587\u5e93\u68c0\u6d4b\u5230\u60a8\u672a\u7ed1\u5b9a\u90ae\u7bb1\uff0c\u8d26\u53f7\u53ef\u80fd\u5b58\u5728\u4e0d\u5b89\u5168\u56e0\u7d20\u3002\u4e3a\u4e86\u4fdd\u8bc1\u60a8\u4e0b\u8f7d\u6587\u6863\u540e\u7684\u4e2a\u4eba\u9690\u79c1\uff0c\u8bf7\u60a8\u7ed1\u5b9a\u90ae\u7bb1\u3002<a href='javascript:void(0)' id='bindEmailLater' style='color:#666;'>\u4e0b\u6b21\u7ed1\u5b9a</a>",auth:{onRender:function(){var e=a.g("bindEmailLater");a.event.on(e,"click",function(){s.set("wk_bindemaillater","ok",{expires:864e5}),s.set("BAIDU_DOC_NACT","download",{expires:6048e5}),window.location.reload()})}},onSubmitSuccess:function(){s.set("BAIDU_DOC_NACT","download",{expires:6048e5}),window.location.reload()},onSubmitFail:function(){}});i.show()}}),e}()),f=function(){var e=new v;return e};t.exports.downDocCreate=f,t.exports.downDoc=v});
;define("wkview:widget/ui/view/movetree/mediator/mediator.js",function(e,t,i){var o=e("wkcommon:widget/ui/js_core/mvp/event/event.js");i.exports.mediator=new o.custEvent});
;define("wkview:widget/ui/view/movetree/view/view.js",function(e,t,a){var i=e("wkcommon:widget/lib/tangram/base/base.js"),d=e("wkcommon:widget/lib/fis/data/data.js"),o=e("wkview:widget/ui/view/movetree/mediator/mediator.js").mediator,n=e("wkcommon:widget/ui/js_core/mvp/view/view.js").View,s=e("wkcommon:widget/ui/js_core/util/util.js"),r=e("wkcommon:widget/ui/js_core/tree/tree.js").Tree,l=s.delegate,c=i.lang.createClass(function(e){this._init(e)},{superClass:n}).extend({mediator:o,template:{type:"template",view:["<% var data = node.data; %>",'<% if(data.render === "root") { %>','<div class="files folder tree-node putable root-node nl-0 <% if(node.getStatus("selected")) { %> hasSelected <% } %>" data-files-id="0" data-files-title="<%=data.title %>" data-dir-level="0" data-dir-son="0">','<b class="ic ic-bookroom fm-icons"></b>',"<span><%=data.title %></span>","</div>",'<div data-type="childs"></div>',"<% } else { %>",'<div class="tree-item files folder tree-node <%=data.isLocked %> putable nl-<%=data.level %> <% if(node.getStatus("selected")) { %> hasSelected <% } %>" data-files-id="<%=data.id %>" data-files-title="<%=data.fold_name %>" data-full-title="<%=data.full_name %>" data-dir-level="<%=data.level %>" data-dir-son="<%=data.son %>">','<b class="ic tree-triangle <%=data.triangle %> <% if(node.getStatus("expand")) { %> item-tree-expand <% } if(node.getStatus("loading")) { %> item-tree-loading <% } %>"></b>','<% if(data.op == "new"){ %>','<div class="new-op-box">','<input id="new-dir-title" class="new-dir in-tree" type="text" value="\u6587\u4ef6\u5939" />','<a href="###" class="fm-icons btn-radic confirm-create">&radic;</a>','<a href="###" class="fm-icons btn-chi cancel-create">&Chi;</a>',"</div>","<% } else {%>","<% if(node.getStatus('rename')) {%>",'<div class="rename-op-box in-tree">','<input class="rename" id="rename-box" type="text" value="<%=data.full_name %>" />','<a href="###" class="fm-icons btn-radic confirm-rename">&radic;</a>','<a href="###" class="fm-icons btn-chi cancel-rename">&Chi;</a>',"</div>","<% } else { %>",'<span class="fold-name"><%=data.fold_name %></span>',"<% } %>","<% } %>","</div>",'<div data-type="childs"></div>',"<% } %>"].join("")},_init:function(){this.moveTree=null,this.targetTreeNode=null,this.mediator.on("v:expand-move-node",i.fn.bind(this.expandNode,this)),this.mediator.on("v:show-move-tree",i.fn.bind(this.showMovetree,this)),this.mediator.on("v:create-folder",i.fn.bind(this.createFolder,this)),this.mediator.on("v:show-move-tip",i.fn.bind(this.showMoveTip,this))},showMoveTip:function(e){var t=e.data,a=i.g("move-tree-tip");a&&(a.innerHTML=t.tip,a.style.display="",setTimeout(function(){a.style.display="none"},2e3))},showMovetree:function(e){var t,a,o,n=this,s=d.get("WkInfo"),c=e.data;i.g("store-move-box").innerHTML=['<div id="store-move-tree" style="margin-top:10px;"></div>','<div class="operate-line">','<a href="###" class="move-new">','<b class="fm-icons ic-new ic"></b>',"\u65b0\u5efa\u6587\u4ef6\u5939","</a>",'<span id="move-tree-tip" style="display:none"></span>',"</div>",'<div class="move-btns-line" style="margin-bottom:10px;">','<a href="###" class="bt ui-btn ui-btn-26-green movetree-btns confirm-move reader_tips_close"><b class="btc reader_tips_close"><b class="btText reader_tips_close">\u786e\u8ba4</b></b></a>','<a href="###" class="bt ui-btn ui-btn-26-light movetree-btns cancel-move reader_tips_close"><b class="btc reader_tips_close"><b class="btText reader_tips_close">\u53d6\u6d88</b></b></a>',"</div>"].join(""),(this.moveTree=r.create({fieldIndentifier:"id",fieldChilds:"nodes",parent:i.g("store-move-tree"),oninit:function(e){i.event;t=e,l(t.parent,"#new-dir-title","keydown",function(e){13===e.keyCode&&n.doCreate(e)}),l(t.parent,".tree-node","click",t.toggle),l(t.parent,".cancel-create","click",function(){var e=n._getNodeById("new");n.targetTreeNode=null,e&&e.remove()}),l(t.parent,".confirm-create","click",function(e){n.doCreate(e)})},onreader:function(e){return n.renderView(n.template,{node:e})},toggle:function(e){var a,d,o=i.g,s=i.dom,r=s.hasClass,l={},c=i.event.getTarget(e),u=!i.dom.hasClass(c,"has-dir");if((a=t._getNode(e))&&!r(o(a.did),"isLocked")){if(a.getStatus("new"))return!1;u||1!=a.getStatus("expand")?(a.setStatus("loading",!0),l={dom:a,id:a.data.id},u&&((d=t.getFocused())&&d.setStatus("selected",!1),a.setStatus("selected",!0),t.setFocused(a,0),n.targetTreeNode=a),n.mediator.fire("p:get-move-tree",{data:l}),a.setStatus("loading",!1),"has-dir"==a.data.triangle&&a.setStatus("expand",!0)):(a.setStatus("expand",!1),a.removeAll())}},statusClasses:{selected:n.hasSelected},_getNode:function(e){return t.node4target(i.event.getTarget(e))}})).loadChilds([{render:"root",title:"\u6211\u7684\u6587\u5e93",id:"0"}]),a=this._getNodeById(0),a.setStatus("selected",!0),t.setFocused(a),n.targetTreeNode=a,c=this._formatData(c),c=this._rearrangeData(c),a.loadChilds(c),(o=this._getNodeById(s.DocInfo.fold_id))&&(a.setStatus("selected",!1),t.setFocused(o),o.setStatus("selected",!0)),this.bindEvent()},bindEvent:function(){var e=this.moveTree,t=this;l(i.g("store-move-box"),".move-new","click",function(){if(!t._getNodeById("new")){var a=t._getNodeById(0),d=e.getFocused();d&&(d.setStatus("selected",!1),d.setStatus("expand",!1));for(var o=0,n=a.childNodes.length;n>o;o++)d=a.childNodes[o],d.setStatus("expand",!1),d.removeAll();d=null,a.setStatus("selected",!0),e.setFocused(a,0),t.targetTreeNode=a,a.setStatus("selected",!1),a=a.insertChild({id:"new",op:"new"}),a.setStatus("selected",!0),a.setStatus("new",!0),e.setFocused(a),i.g("new-dir-title").focus(),i.g("new-dir-title").select()}}),l(i.g("store-move-box"),".confirm-move","click",function(){var e,a=t.targetTreeNode,o=d.get("WkInfo");return t._getNodeById("new")||!a?!1:(a&&(e={to:a.data.id,doc_id:o.DocInfo.docId,fold_id:o.DocInfo.fold_id},i.cookie.set("last-store-folder",a.data.id,{path:"/",expires:31536e6}),t.mediator.fire("p:do-move",{data:e})),void t.hidePop())}),l(i.g("store-move-box"),".cancel-move","click",function(){t.hidePop()})},hidePop:function(){var e=null,t=this;(e=i.dom.query(".reader_tools_tips",i.g("doc_reader"))[0]&&"no"!==t.disposePop)&&e.parentNode.removeChild(e),(e=i.g("fav-bottom-tip"))&&e.parentNode.removeChild(e)},doCreate:function(e){var t,a,d=i.g("new-dir-title"),o=i.string.trim(d.value),n=this.moveTree;return 0==o?!1:new RegExp('[\\\\/:*?"<>\\|]').test(o)||o.length>50?(d.style.background="rgb(252, 167, 167)",!1):(t=n._getNode(e),t.setStatus("loading",!0),a={parent_fold_id:0,fold_name:o},void this.mediator.fire("p:create-dir",{data:a}))},createFolder:function(e){var t=this,a=e.data;if(!i.g("store-move-tree"))return!1;var d=this._getNodeById(a.parent_fold_id),o=this.moveTree;return o?(this.removeNewDirNode(),void(d&&(d=d.insertChild(this._formatData(a.data)[0]),o.setFocused(d),d.setStatus("selected",!0),t.targetTreeNode=o.getFocused()||null))):!1},removeNewDirNode:function(){var e=this._getNodeById("new");e&&e.remove()},expandNode:function(e){var t=e.data;this._getNodeById(t.id).loadChilds(this._formatData(t.fold_son||[]))},_getNodeById:function(e){var t=this.moveTree;return t.node4target(["node",t.handler,e].join("-"))},_formatData:function(e){var t,a=(i.array.indexOf,i.string.encodeHTML),d=[],o={};i.lang.isArray(e)||(e=[e]);for(var n=0,s=e.length;s>n;n+=1)t=e[n],"root"==t.render?d.push(t):(o.id=t.fold_id,o.fold_name=a(this._cutTitle(t.fold_name,t.level)),o.full_name=a(t.fold_name),o.hasdir=t.hasdir,o.son=t.son_level,o.level=t.level,o.parent=t.parent,o.triangle=+t.hasdir?"has-dir":"no-dir"),d.push(o),o={};return d},_rearrangeData:function(e){var t,a,d=0,o={},n=[];for(i.lang.isArray(e)||(e=[e]),t=e.length;t>d;d+=1)a=e[d],"undefined"!=typeof o[a.parent]?o[a.parent].push(a):o[a.parent]=[a],"undefined"!=typeof o[a.id]&&("undefined"!=typeof a.nodes?a.nodes.push(o[a.id]):a.nodes=o[a.id]),"0"===a.parent&&n.push(a);return n},_cutTitle:function(e,t){return this._cutString(e,[14,13,12,11,10,9,8,7,6][+t],"...")},_cutString:function(e,t,a){e=e.toString();var i=e.length;return"undefined"==typeof a&&(a=""),i?0>t||t>=i?e:[e.slice(0,t),a].join(""):a}});a.exports.view=c});
;define("wkview:widget/ui/view/movetree/model/model.js",function(e,o,t){var i=e("wkcommon:widget/lib/tangram/base/base.js"),r=e("wkcommon:widget/ui/js_core/mvp/model/model.js").Model,n=e("wkview:widget/ui/view/movetree/mediator/mediator.js").mediator,d=e("wkcommon:widget/lib/fis/data/data.js"),s=d.get("WkInfo"),a=i.lang.createClass(function(e){this._init(e)},{superClass:r}).extend({mediator:n,_init:function(){this.mediator.on("m:create-dir",i.fn.bind(this.createDir,this)),this.mediator.on("m:move-docs",i.fn.bind(this.moveDocs,this)),this.mediator.on("m:get-fold-sons",i.fn.bind(this.getFoldSons,this)),this.mediator.on("m:get-view-fold-info",i.fn.bind(this.getViewFoldInfo,this))},getViewFoldInfo:function(e){var o,t=e.promise,i=e.data;return o={app:"get_view_fold_info",fold_id:i.id||0},this._request(s.Urls.interfaceGetViewFoldInfo,o,function(e,o){t.resolve(o)}),t},getFoldSons:function(e){var o,t=e.promise,i=e.data;return o={app:"get_fold_son",fold_id:i.id||0},this._request(s.Urls.interfaceGetFoldSon,o,function(e,o){t.resolve(o)}),t},moveDocs:function(e){var o,t=e.promise,i=e.data;return o={ct:20145,doc_id_str:i.doc_id,intodoc_fold_id:i.to,fold_id:i.fold_id},this._request(s.Urls.submitDocMove,o,function(e,o){t.resolve(o)}),t},createDir:function(e){var o=e.promise,t=e.data,i=t.parent_fold_id,r={ct:20142,parent_fold_id:t.parent_fold_id,fold_name:t.fold_name};return this._request(s.Urls.submitFoldCreate,r,function(e,t){o.resolve({response:t,current:1,parent_fold_id:i})}),o},_request:function(e,o,t){var r=this;i.ajax.request(e,{method:"post",data:["fold_request",encodeURIComponent(i.json.stringify(o))].join("="),async:!1,onsuccess:function(e,o){try{o=i.json.parse(o)}catch(n){o={error_no:1}}o.error_no&&o.error_no-0>0?r.mediator.fire("p:modelError",o):t(e,o)},onfailure:function(){r.mediator.fire("p:modelError",{request_error:!0})}})}});t.exports.model=a});
;define("wkview:widget/ui/view/movetree/presenter/presenter.js",function(e,t,i){var o=e("wkcommon:widget/lib/tangram/base/base.js"),r=e("wkview:widget/ui/view/movetree/mediator/mediator.js").mediator,a=e("wkcommon:widget/ui/js_core/mvp/presenter/presenter.js").Presenter,n=o.lang.createClass(function(e){this._init(e)},{superClass:a}).extend({errorMsg:{1:"\u7cfb\u7edf\u9519\u8bef",2:"\u7528\u6237\u672a\u767b\u9646",3:"\u7528\u6237\u5df2\u88ab\u5c01\u7981",4:"\u65e0\u6587\u6863\u64cd\u4f5c\u6743\u9650",5:"\u64cd\u4f5c\u9891\u7387\u592a\u5feb",6:"\u91cd\u590d\u8bc4\u4ef7",7:"\u6587\u6863\u5927\u5c0f\u8d85\u8fc7\u4e0a\u9650",8:"\u975e\u6cd5\u7684\u6587\u4ef6\u5939\u540d\u79f0",9:"\u975e\u6cd5\u7684\u6587\u4ef6\u683c\u5f0f",10:"\u91cd\u590d\u6587\u6863",11:"\u63d0\u4ea4\u53c2\u6570\u975e\u6cd5",12:"\u4e0b\u8f7d\u6587\u6863\u5931\u8d25",13:"\u8bc4\u4ef7\u5931\u8d25",14:"\u7528\u6237\u79ef\u5206\u4e0d\u591f",57:"\u5bfc\u5165\u7684\u6587\u6863\u5df2\u7ecf\u5b58\u5728\u6587\u4ef6\u5939\u4e2d",58:"\u5bfc\u5165\u7684\u6587\u6863\u8fbe\u5230\u6587\u4ef6\u5939\u7684\u4e0a\u9650",59:"\u521b\u5efa\u7684\u6587\u4ef6\u5939\u8fbe\u5230\u4e0a\u9650",60:"\u6587\u4ef6\u5939\u5c42\u7ea7\u5df2\u8fbe\u5230\u4e0a\u9650",61:"\u540c\u4e00\u76ee\u5f55\u4e0b\u7684\u6587\u6863\u6709\u91cd\u590d",62:"\u5bfc\u5165\u7684\u6587\u4ef6\u5939\u540d\u5b57\u4e0d\u5408\u6cd5"},mediator:r,_init:function(){this.mediator.on("p:create-dir",o.fn.bind(this.createDir,this)),this.mediator.on("p:do-move",o.fn.bind(this.doMove,this)),this.mediator.on("p:get-fold-sons",o.fn.bind(this.getFoldSons,this)),this.mediator.on("p:get-move-tree",o.fn.bind(this.getMoveTree,this)),this.mediator.on("p:get-view-fold-info",o.fn.bind(this.getViewFoldInfo,this)),this.mediator.on("p:modelError",o.fn.bind(this.errorCenter,this))},getViewFoldInfo:function(e){var t=this,i=e.data;this.mediator.when(["m:get-view-fold-info",{data:i}]).then(function(e){t.mediator.fire("v:show-move-tree",{data:e[0]})})},getMoveTree:function(e){var t=this,i=e.data,o=i.selected||{};this.mediator.when(["m:get-fold-sons",{data:i}]).then(function(e){var r=e[0],a={id:i.id,fold_son:r,selected:o};t.mediator.fire("v:expand-move-node",{data:a})})},createDir:function(e){var t=e.data,i=this;this.mediator.when(["m:create-dir",{data:t}]).then(function(e){{var t,o=e[0].response;+o.error_no}t={parent_fold_id:e[0].parent_fold_id,data:{fold_id:o.fold_id,fold_name:o.fold_name,create_time:o.create_time,level:o.level}},i.mediator.fire("v:create-folder",{data:t}),i.mediator.fire("v:show-move-tip",{data:{tip:"\u521b\u5efa\u6587\u4ef6\u5939\u6210\u529f ^_^"}})})},doMove:function(e){var t=e.data;this.mediator.when(["m:move-docs",{data:t}])},errorCenter:function(e){var t=e.error_no;switch(+t){case 63:this.mediator.fire("v:show-move-tip",{data:{tip:"\u79fb\u52a8\u6210\u529f"}});break;case 2:alert("\u60a8\u6ca1\u6709\u767b\u5f55\uff0c\u8bf7\u767b\u5f55\u540e\u8bbf\u95ee"),location.href="http://wenku.baidu.com";break;default:this.errorMsg[t]&&this.mediator.fire("v:show-move-tip",{data:{tip:this.errorMsg[t]}})}}});i.exports.presenter=n});
;define("wkview:widget/ui/view/movetree/movetree.js",function(e,i,w){var t=e("wkview:widget/ui/view/movetree/mediator/mediator.js").mediator,v=e("wkview:widget/ui/view/movetree/view/view.js").view,o=e("wkview:widget/ui/view/movetree/model/model.js").model,d=e("wkview:widget/ui/view/movetree/presenter/presenter.js").presenter,r=function(e){e=e||{},e.el=document.body,new v(e),new o(e),new d(e),t.fire("p:get-view-fold-info",{data:{id:e.fold_id}})};w.exports.movetree=r});
;define("wkview:widget/ui/view/pay_org_vip/pay_org_vip.js",function(o,e,n){var t=o("wkcommon:widget/lib/tangram/base/base.js"),d=o("wkcommon:widget/ui/js_core/dialog/dialog.js"),i=o("wkcommon:widget/lib/fis/data/data.js"),a=i.get("WkInfo"),c=(i.get("UserInfo"),o("wkview:widget/ui/file_downloader_ui/file_downloader_ui.js")),s=o("wkcommon:widget/ui/js_core/log/log.js"),l=o("wkview:widget/ui/doc_business/doc_business.js"),r=o("wkcommon:widget/ui/js_core/_dialog/_dialog.js"),g=o("wkcommon:widget/ui/js_core/login/login.js"),w=function(){var o=null;return function(){return o||(o=d.dialogCreate()),o}}(),u=function(){var o=function(o){this.goods_id=o.goods_id||"",this.goods_type=o.goods_type||""};return t.object.extend(o.prototype,{wealth:0,pay:0,code:0,data:{},WkInfo:a,down_doc_dialog:null,actionUrl:{userUrl:"/user/submit/download",vipUrl:"/orgvip/submit/orgvipbuy"},mes:[["","\u7acb\u5373\u4e0b\u8f7d"],["","\u4f7f\u7528\u4e2a\u4eba\u8d26\u53f7\u8d2d\u4e70"],[],["\u60a8\u4e0b\u8f7d\u7684\u6587\u6863\u8d85\u51fa\u4f01\u4e1a\u89c4\u5b9a\u7684\u4ef7\u683c\u4e0a\u9650\uff0c\u65e0\u6cd5\u5b8c\u6210\u4e0b\u8f7d","\u4f7f\u7528\u4e2a\u4eba\u8d26\u53f7\u8d2d\u4e70"],["\u7cfb\u7edf\u9519\u8bef\uff0c\u8bf7\u5728\u9875\u9762\u5237\u65b0\u540e\u91cd\u65b0\u4e0b\u8f7d","\u786e\u5b9a"],["","\u7acb\u5373\u9605\u8bfb"]],toPay:function(){var o=this;$.ajax({url:"/pay/api/tradecheck",cache:!1,async:!1,data:{goods_type:o.goods_type,goods_id:o.goods_id},dataType:"json"}).done(function(e){if(0===+e.status){var n=o.opt.query||{},d=t.object.merge({id:o.goods_id,stt:o.goods_type},n,{overwrite:!0}),i="";i=1==o.goods_type?"/cashier/browse/doccashier?":"/coupon/browse/buybook?";var a=i+$.param(d);window.location.href=a}else o.hasBuyAlert()})},init:function(o,e){var n=this;n.data=e||{},n.opt=o||{},g.login.verlogin(function(){console.log("init"),$.ajax({url:"/orgvip/interface/canibuy",cache:!1,async:!1,type:"get",data:{doc_id:n.WkInfo.DocInfo.docId,dowmloadTime:(new Date).getTime()},success:function(o){if(n.wealth=0,n.pay=0,n.code=1,n.doc_price_limit=0,console.log(o),o&&void 0!=o.status.code){var e=parseInt(o.status.code);void 0!=o.data.org_allmoney&&(n.wealth=o.data.org_allmoney||0),void 0!=o.data.buyprice&&(n.pay=o.data.buyprice||0),console.log("\u60a8\u7684\u7528\u6237\u4ee3\u53f7\u662f\uff1a"+e+"!"),n.code=o.status.code,10==n.code&&(n.code=0),0==n.code&&0==o.data.downlowndable&&(n.code=10),o.data.doc_price_limit&&(n.doc_price_limit=o.data.doc_price_limit),console.log(o.data.org_name),n.orgName=decodeURIComponent(o.data.org_name)||"",console.log(n.orgName),n.eventInit()}}})},null,null,{},!1)},hasBuyAlert:function(){r.alert({title:"\u63d0\u793a",content:'<p style="margin:20px;text-align:center;line-height:24px;font-size:14px;">\u4f60\u5df2\u8d2d\u4e70\u8fc7\u6b64\u5546\u54c1\uff0c\u8bf7\u52ff\u91cd\u590d\u8d2d\u4e70\u3002<br/>\u70b9\u51fb\u786e\u8ba4\uff0c\u5237\u65b0\u9875\u9762\uff0c\u9605\u8bfb\u5168\u6587\u3002</p>',width:300,height:180,onConfirmBefore:function(){location.reload(!0)},onCloseBefore:function(){location.reload(!0)}})},postGetFile:function(){var o=this,e=o.WkInfo.DocInfo.size,n=o.WkInfo.DocInfo.docType;if(c.isSupport(e)){var d={},i=$(document.downloadForm);$.each(i.serializeArray(),function(o,e){d[e.name]=e.value}),d.v_code=window.postVcode||0,d.v_input=window.postVinput||0,d.method="async",$.post(i.attr("action"),d,function(t){c.download({url:t.url,title:o.WkInfo.DocInfo.title,fileSize:e,fileType:n})},"json")}else{var a=window.postVcode||0,s=window.postVinput||0;$(document.downloadForm).find("input[name=v_code]").val(a),$(document.downloadForm).find("input[name=v_input]").val(s),t.lang.eventCenter.dispatchEvent("download.realStart"),document.downloadForm.submit()}},eventInit:function(){var o=this;console.log(o.code);var e=[0,-1,2,99,-1,4,3,4,1,-1,5];-1!=e[o.code]&&(99==e[o.code]?o.toPay():(o.down_doc_dialog=new l,o.dialogInit(e[o.code])))},dialogInit:function(o){var e=this;switch(e.down_doc_dialog.reset(),o){case 0:s.xsend(1,100261),e.mes[o][0]="\u8d26\u53f7\u4f59\u989d: <em> "+e.wealth+"</em>\u5143<span>\u672c\u6b21\u4e0b\u8f7d\u6d88\u8017:<em> "+e.pay+"</em>\u5143</span>";break;case 1:s.xsend(1,100266),e.mes[o][0]="\u8d26\u53f7\u4f59\u989d:<em> "+e.wealth+"</em>\u5143<span>\u65e0\u6cd5\u5b8c\u6210\u672c\u6b21\u4e0b\u8f7d;</span>";break;case 3:s.xsend(1,100268),e.down_doc_dialog.set3Msg("(\u4f01\u4e1a\u8d26\u53f7\u4ec5\u652f\u6301\u4e0b\u8f7d\u4ef7\u683c\u5728"+e.doc_price_limit+"\u5143\u4ee5\u5185\u7684\u6587\u6863)");break;case 5:s.xsend(1,100261),e.mes[o][0]="\u8d26\u53f7\u4f59\u989d: <em> "+e.wealth+"</em>\u5143<span>\u672c\u6b21\u4e0b\u8f7d\u6d88\u8017:<em> "+e.pay+"</em>\u5143</span>",e.down_doc_dialog.setWarning()}2==o?(s.xsend(1,100262),e.down_doc_dialog.vcodePass=!1,e.down_doc_dialog.creat_2(),e.down_doc_dialog.setBtnWay("\u4f7f\u7528\u4e2a\u4eba\u8d26\u53f7\u8d2d\u4e70"),$(".org_name").html(e.orgName),e.down_doc_dialog.bindEvent()):4==o?e.down_doc_dialog.set0Msg(e.mes[o][0]):(e.down_doc_dialog.set1Msg("\u60a8\u6b63\u5728\u4f7f\u7528\u7684\u4f01\u4e1a\u4f1a\u5458\u8d26\u53f7 : "+e.orgName),e.down_doc_dialog.set2Msg(e.mes[o][0]),e.down_doc_dialog.setBtnMsg(e.mes[o][1])),e.down_doc_dialog.bindDownLoadBtton(function(){e.downloaddoc()}),e.down_doc_dialog.bindChangePerson(function(){1==o&&s.xsend(1,100267),2==o&&s.xsend(1,100263),3==o&&s.xsend(1,100269),$(document.downloadForm).attr("action",e.actionUrl.userUrl),e.toPay()}),e.down_doc_dialog.show(),console.log("\u60a8\u7684\u5f39\u5c42\u5df2\u5c55\u793a!")},downloaddoc:function(){var o=this;$(document.downloadForm).attr("action",o.actionUrl.vipUrl),w().confirm({title:"\u4e0b\u8f7d\u6587\u6863",content:'<iframe width="460" height="220" name="runDown" frameborder="0"></iframe>',width:500,height:220,onRendered:function(){o.postGetFile()}}),w().hide()}}),o}(),_=function(o){var e=new u(o);return e};n.exports=_});
;define("wkview:widget/ui/view/doc_share/doc_share.js",function(e,t,o){var n=e("wkcommon:widget/lib/tangram/base/base.js"),a=e("wkcommon:widget/ui/js_core/dialog/dialog.js"),i=e("wkcommon:widget/lib/fis/data/data.js"),c=i.get("WkInfo"),r=(i.get("UserInfo"),e("wkcommon:widget/ui/js_core/log/log.js")),l=function(){var e=null;return function(){return e||(e=a.dialogCreate()),e}}(),s=function(){var e=function(e){this.vo=e};return n.object.extend(e.prototype,{init:function(){this.toggleSize()},getEl:function(){return n.g(this.vo.el)},show:function(){console.log("oooooofffffffff"),console.log(this.vo);var e=n.g(this.vo.el),t=n.g(this.vo.panel);e.style.display="block"==e.style.display?"none":"block",t&&(t.style.display="block"==t.style.display?"none":"block"),this.bind(),this.setCode("normal")},bind:function(){var e=this,t=function(){var e=c.DocInfo.docType;return"txt"==e?"txt":"ppt"==e||"pptx"==e?"ppt":"doc"}(),o=function(){setTimeout(function(){n.lang.eventCenter.dispatchEvent("show-share-panel")},0)};n.event.on(this.vo.view,"click",function(){var n="normal"==e.statusType?!0:!1,a={viewImg:n?"450-500":"630-500",viewSize:n?"450*500":"630*500",width:n?520:700,height:n?660:660,content:'<div class="viewReader"><p><img src="http://img.baidu.com/img/iknow/docshare/'+t+'-{viewImg}.png" alt="" /></p>\u5c3a\u5bf8 {viewSize}pix</div>'};l().alert({title:"\u5206\u4eab\u6587\u6863",content:a.content.replace(/{(viewImg|viewSize)}/g,function(e,t){return a[t]}),width:a.width,height:a.height,btnText:["\u8fd4\u56de"],onOk:function(){l().hide(),o()},onClosed:function(){return o(),!0}})});var a=n.dom.g(this.vo.closePanel);a&&n.event.on(a,"click",function(){var t=n.g(e.vo.el),o=n.g(e.vo.panel);t.style.display="none",o&&(o.style.display="none")}),n.event.on(this.vo.copy,"click",function(){e.copyToClipboard()})},setCode:function(e){var t=this,o=this.vo.toggleSize,a=this.vo.codeText,i=['<object width="{width}" height="{height}" align="middle" id="reader" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">','<param value="window" name="wmode">','<param value="true" name="allowfullscreen">','<param name="allowscriptaccess" value="always">','<param value="{value}" name="movie">','<embed width="{width}" align="middle" height="{height}" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" name="reader" src="{value}" wmode="window" allowscriptaccess="always" bgcolor="#FFFFFF" ver="9.0.0" allowfullscreen="true"></embed>',"</object>"].join(""),r=function(e){var t="http://wenku.baidu.com/static/flash/{reader}?docurl=http://wenku.baidu.com/play&amp;docid={docId}&amp;title={docTitle}&amp;doctype={docType}&amp;fpn={pg}&amp;npn={pg}&amp;readertype=external&catal={catal}&amp;cdnurl={cdn}",o={reader:"txt"===c.DocInfo.docType?"txtreader.swf":"apireader.swf",docId:c.DocInfo.docId,docTitle:encodeURIComponent(c.DocInfo.title),docType:c.DocInfo.docType,pg:"txt"==c.DocInfo.docType?50:5,catal:c.DocInfo.catal,cdn:"http://txt.wenku.baidu.com/play"},t=(c.DocInfo.readerVersion,t.replace(/{(reader|docId|docTitle|docType|pg|catal|cdn)}/g,function(e,t){return o[t]}));return e.replace(/{value}/g,t)},l={normal:function(){n.g(a).value=r(i.replace(/{width}/g,450).replace(/{height}/g,500)),t.statusType="normal",n.g(o[0]).checked="true",n.g(o[1]).checked=""},big:function(){n.g(a).value=r(i.replace(/{width}/g,630).replace(/{height}/g,500)),t.statusType="big",n.g(o[0]).checked="",n.g(o[1]).checked="true"}};l[e]()},toggleSize:function(){var e=this,t=this.vo.toggleSize;n.array.each(t,function(o,a){n.event.on(n.g(o),"click",function(){n.g(t[0==a?1:0]).checked="",this.checked="true",e.setCode(/normalSize-\d+/.test(o)?"normal":"big")})})},copySuccess:function(){n.g(this.vo.copyResult).innerHTML="\u590d\u5236\u6210\u529f\uff01"},copyToClipboard:function(e){var t=this.vo,e=n.g(t.codeText).value,o="\u4f60\u7684\u6d4f\u89c8\u5668\u7981\u7528\u4e86\u81ea\u52a8\u590d\u5236\u529f\u80fd\uff0c\u8bf7\u4f60\u624b\u52a8\u590d\u5236\u3002";if(r.send("api","share",{subtype:"copy"}),window.clipboardData)window.clipboardData.clearData(),window.clipboardData.setData("Text",e)?this.copySuccess():alert(o);else if(n.browser.opera)window.location=e;else if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(a){alert("\u88ab\u6d4f\u89c8\u5668\u62d2\u7edd\uff01\n\u8bf7\u5728\u6d4f\u89c8\u5668\u5730\u5740\u680f\u8f93\u5165'about:config'\u5e76\u56de\u8f66\n\u7136\u540e\u5c06'signed.applets.codebase_principal_support'\u8bbe\u7f6e\u4e3a'true'")}var i=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!i)return;var c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c)return;c.addDataFlavor("text/unicode");var l=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString),s=(new Object,e);l.data=s,c.setTransferData("text/unicode",l,2*s.length);var d=Components.interfaces.nsIClipboard;if(!i)return!1;i.setData(c,null,d.kGlobalClipboard),n.g(t.copyResult).innerHTML="\u590d\u5236\u6210\u529f\uff01"}else alert(o);n.g(t.codeText).select(),setTimeout(function(){n.g(t.copyResult).innerHTML=""},1500)}}),e}(),d=function(e){var t=new s(e);return t.init(),t};o.exports.shareToCreate=d});
;define("wkview:widget/ui/view/config/config.js",function(e,i,t){var n={hostUrl:"http://wenku.baidu.com/",viewUrl:"http://wenku.baidu.com/view/",defaultDirData:{create_time:"0",doc_num:"0",fold_id:"0",fold_name:"\u767e\u5ea6\u6587\u5e93",fold_num:"0",hasdir:"0",level:"1",progress:"0",son_level:"0",source:"0"},defaultRenderType:1,dirnameRegExp:new RegExp('[\\\\/:*?"<>\\|]'),tips:["\u7cfb\u7edf\u51fa\u73b0\u5f02\u5e38\uff0c\u8bf7\u5c1d\u8bd5\u5237\u65b0\u540e\u91cd\u8bd5\uff01","\u5305\u542b|/?&lt;&gt;*&quot;:\u7b49\u7279\u6b8a\u5b57\u7b26\uff0c\u8bf7\u4fee\u6539","\u6587\u4ef6\u5939\u521b\u5efa\u6210\u529f ^_^","\u6587\u4ef6\u5939\u521b\u5efa\u5931\u8d25 T_T","\u5bfc\u5165\u6587\u6863\u5df2\u5b58\u5728\u6587\u4ef6\u5939\u4e2d","\u5bfc\u5165\u6587\u6863\u6253\u5230\u6587\u4ef6\u5939\u4e0a\u9650","\u521b\u5efa\u6587\u4ef6\u5939\u5c42\u7ea7\u8fbe\u5230\u4e0a\u9650","\u540c\u4e00\u76ee\u5f55\u4e0b\u6709\u91cd\u590d\u6587\u6863","\u6587\u4ef6\u5939\u540d\u79f0\u4e0d\u53ef\u4ee5\u8d85\u8fc750\u4e2a\u5b57\u7b26","\u6570\u636e\u52a0\u8f7d\u4e2d...","\u79fb\u52a8\u6210\u529f","\u5220\u9664\u6210\u529f","\u91cd\u547d\u540d\u5931\u8d25","\u91cd\u547d\u540d\u6210\u529f","\u6587\u4ef6\u5939\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"],dirDeepthLimit:10,dirtreeStringLengthLimit:[8,8,7,6,5,4,3,2,1,1,1,1],movetreeStringLengthLimit:[14,13,12,11,10,9,8,7,6],dragDelay:100,filesBoxTitleLength:[5,14],folderTitleLengthLimit:50,dirOrigin:["\u6587\u4ef6\u5939","\u6536\u85cf\u7684\u6587\u8f91"],docOrigin:["\u6536\u85cf","\u4e66\u7b7e","\u4e0a\u4f20","\u4e0b\u8f7d"]};t.exports.Configuration=n});
;define("wkview:widget/ui/view/doc_report/doc_report.js",function(e,t,r){var o,i,n=e("wkcommon:widget/ui/lib/jquery/jquery.js"),p=e("wkcommon:widget/lib/tangram/base/base.js"),a=e("wkcommon:widget/lib/fis/data/data.js").get("WkInfo"),s=a.DocInfo,l=e("wkcommon:widget/ui/js_core/login/login.js").login,d=e("wkcommon:widget/ui/js_core/dialog/dialog.js"),c=p,u=c.dom,_=c.event,h=c.lang,f=function(){var e=null;return function(){return e||(e=d.dialogCreate()),e}}(),v=h.guid(),m=!1,g=0,b=['<div class="reportTipInner">\u4e3e\u62a5\u8fdd\u89c4\u6587\u6863</div>','<div class="reportTipInner">\u5df2\u7ecf\u4e3e\u62a5\u8fc7\u4e86\uff0c\u6b63\u5728\u5904\u7406</div>'],w=!1,y={},k={0:'<h2 class="report_success_icon"></h2><p class="mb10" style="text-align:left;">\u60a8\u7684\u4e3e\u62a5\u5df2\u6536\u5230\uff0c\u6211\u4eec\u4f1a\u5c3d\u5feb\u8fdb\u884c\u6838\u5b9e\u5904\u7406\u3002</p><p style="text-align:left;line-height:18px;">\u611f\u8c22\u60a8\u4e3a\u7eff\u5316\u6587\u5e93\u505a\u7684\u52aa\u529b\uff0c\u6b22\u8fce\u60a8\u52a0\u5165<a href="/event/bqbh" target="_blank">\u7eff\u8272\u6587\u5e93\u884c\u52a8\u56e2</a>\uff0c\u5171\u540c\u7ef4\u62a4\u5065\u5eb7\u826f\u597d\u7684\u5206\u4eab\u3001\u9605\u8bfb\u73af\u5883\u3002</p>',2:"<h2>\u672a\u767b\u5f55</h2><p>\u53ef\u80fd\u767b\u5f55\u65f6\u95f4\u8d85\u65f6\uff0c\u8bf7\u60a8\u91cd\u65b0\u767b\u5f55\u540e\u518d\u4e3e\u62a5\u3002</p>",3:"<h2>\u4e3e\u62a5\u5931\u8d25</h2><p>\u7528\u6237\u5df2\u88ab\u5c01\u7981</p>",5:"<h2>\u6e29\u99a8\u63d0\u793a</h2><p>\u53ef\u80fd\u662f\u60a8\u7684\u4e3e\u62a5\u8fc7\u4e8e\u9891\u7e41\uff0c\u5efa\u8bae\u60a8\u7a0d\u5fae\u4f11\u606f\u4e00\u4e0b\u518d\u8bd5\u5427</p>",6:'<p class="mb10" style="text-align:left;line-height:18px;">\u5df2\u7ecf\u6709\u7528\u6237\u5bf9\u6b64\u6587\u6863\u8fdb\u884c\u4e3e\u62a5\u64cd\u4f5c\uff0c\u6587\u5e93\u6b63\u5728\u6838\u5b9e\u5904\u7406\uff0c\u8bf7\u60a8\u7a0d\u540e\u91cd\u8bd5\u3002\u611f\u8c22\u60a8\u7684\u5173\u6ce8\u4e0e\u53cd\u9988\uff01</p><p style="text-align:left;line-height:18px;">\u611f\u8c22\u60a8\u4e3a\u7eff\u8272\u6587\u5e93\u505a\u51fa\u7684\u52aa\u529b\uff0c\u6b22\u8fce\u60a8\u52a0\u5165<a href="/event/bqbh" target="_blank">\u7eff\u8272\u6587\u5e93\u884c\u52a8\u56e2</a>\uff0c\u5171\u540c\u7ef4\u62a4\u5065\u5eb7\u826f\u597d\u7684\u5206\u4eab\u3001\u9605\u8bfb\u73af\u5883\u3002</p>',7:"<h2>\u4e3e\u62a5\u5931\u8d25</h2><p>\u6587\u4ef6\u8fc7\u5927</p>",8:"<h2>\u4e3e\u62a5\u5931\u8d25</h2><p>\u975e\u6cd5\u6587\u4ef6\u540d</p>",9:"<h2>\u4e3e\u62a5\u5931\u8d25</h2><p>\u975e\u6cd5\u6587\u4ef6\u683c\u5f0f</p>",11:"<h2>\u4e3e\u62a5\u5931\u8d25</h2><p>\u53c2\u6570\u9519\u8bef</p>",49:'<p style="text-align:left;line-height:18px;">\u8fd9\u662f\u60a8\u4e0a\u4f20\u7684\u516c\u5f00\u6587\u6863\uff0c\u8bf7\u52ff\u8fdb\u884c\u4e3e\u62a5\u64cd\u4f5c\u3002\u82e5\u56e0\u4fb5\u6743\u7b49\u95ee\u9898\u4e0d\u9002\u5b9c\u516c\u5f00\uff0c\u8bf7\u5728<a href="/user/doc" target="_blank">\u6211\u7684\u6587\u6863</a>\u8fdb\u884c\u5220\u9664\u6216\u8f6c\u4e3a\u79c1\u6709\u6587\u6863\u64cd\u4f5c\u3002</p>'},x=['<form id ="reportForm_'+v+'" class="reportForm" target="_blank" style="display:none;">','<h3 style="margin-top:0;">\u662f\u7684\uff0c\u8fd9\u4e2a\u6587\u6863\u4fb5\u72af\u4e86\u6211\u6216\u8005\u4ed6\u4eba\u7684\u6743\u5229\uff1a</h3>','<p><input type="radio" value ="9" name="report_reason" id="report_reason_9" hidefocus="true"/><label for="report_reason_9"><span style="color:#c00">\u76d7\u7248\u6216\u4fb5\u6743 </span>\u672a\u83b7\u5f97\u6743\u5229\u4eba\u7684\u5408\u6cd5\u6388\u6743\u3001\u4fb5\u72af\u4e2a\u4eba\u9690\u79c1\u6216\u6cc4\u9732\u5355\u4f4d\u5546\u4e1a\u673a\u5bc6</label></p>','<div id="report_item_val9_'+v+'" class="report_item_child" style="display:none;">','<p>\u5904\u7406\u6b64\u7c7b\u4e3e\u62a5\u9700\u8981\u60a8\u63d0\u4f9b\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u6309\u5f15\u5bfc<a href="/report?doc_id='+s.docId+'" target="_blank">\u4e0a\u4f20\u76f8\u5173\u6750\u6599</a>\uff0c\u8fd9\u6837\u4f1a\u6709\u52a9\u60a8\u6210\u529f\u4e3e\u62a5\u3002</p>',"</div>",'<div id="report-reason-all">',"<h3>\u5426\uff0c\u8fd9\u4e2a\u6587\u6863\u662f\u8fdd\u89c4\u6587\u6863\uff1a</h3>",'<p><input type="radio" value ="1" name="report_reason" id="report_reason_1" hidefocus="true"/><label for="report_reason_1">\u5e7f\u544a\u6216\u5783\u573e\u4fe1\u606f</label></p>','<p><input type="radio" value ="2" name="report_reason" id="report_reason_2" hidefocus="true"/><label for="report_reason_2">\u8272\u60c5\u3001\u6deb\u79fd\u3001\u4f4e\u4fd7\u4fe1\u606f</label></p>','<p><input type="radio" value ="3" name="report_reason" id="report_reason_3" hidefocus="true"/><label for="report_reason_3">\u53cd\u653f\u5e9c\u3001\u53cd\u4eba\u7c7b\u3001\u53cd\u793e\u4f1a\u7b49\u53cd\u52a8\u4fe1\u606f</label></p>','<p><input type="radio" value ="4" name="report_reason" id="report_reason_4" hidefocus="true"/><label for="report_reason_4">\u6563\u5e03\u8d4c\u535a\u3001\u66b4\u529b\u3001\u51f6\u6740\u3001\u6050\u6016\u6216\u8005\u6559\u5506\u72af\u7f6a\u7b49\u4fe1\u606f</label></p>','<p><input type="radio" value ="5" name="report_reason" id="report_reason_5" hidefocus="true"/><label for="report_reason_5">\u4fae\u8fb1\u3001\u8bfd\u8c24\u7b49\u4eba\u8eab\u653b\u51fb\u4fe1\u606f</label></p>','<p><input type="radio" value ="6" name="report_reason" id="report_reason_6" hidefocus="true"/><label for="report_reason_6">\u6563\u5e03\u8c23\u8a00\u3001\u6270\u4e71\u793e\u4f1a\u79e9\u5e8f\uff0c\u7834\u574f\u793e\u4f1a\u7a33\u5b9a\u7b49\u4fe1\u606f</label></p>',"</div>",'<div id="report-reason-copr">','<p style="font-size:14px;color:#000;line-height:14px;padding-top:5px;">\u611f\u8c22\u60a8\u7684\u53cd\u9988\uff0c\u6211\u4eec\u5df2\u7ecf\u6536\u5230\u60a8\u7684\u5efa\u8bae\u3002\u4e0e\u7248\u6743\u65b9\u6838\u5b9e\u540e\u4f1a\u5c3d\u5feb\u4e0e\u60a8\u8054\u7cfb\uff0c\u8bf7\u6ce8\u610f\u67e5\u770b\u60a8\u7684\u6d88\u606f\u4e2d\u5fc3\u3002\u8c22\u8c22\uff01</p>',"</div>",'<p style="margin-top:20px;text-align:center;">','<a href="/report?doc_id='+s.docId+'" target="_blank" id="report_form_submit_'+v+'" hidefocus="true" class="report-green-button report-green-button-disabled">\u63d0\u4ea4</a>','<a href="###" class="report-gray-button" id="report_form_hide_'+v+'">\u53d6\u6d88</a></p>',"</form>"].join(""),j=function(e,t){g=6==e?1:0,t&&(g?c.object.each(u.q("docReport-arr"),function(e){u.addClass(e,"icon-jb-disable"),u.setAttr(e,"data-has-report","6")}):c.object.each(u.q("docReport-arr"),function(e){u.removeClass(e,"icon-jb-disable"),u.setAttr(e,"data-has-report","6")}))},T=function(e){if(0==e.errno)1==e.isGreenPassport?f().alert({title:"\u63d0\u793a",content:"<p>\u5feb\u901f\u4e3e\u62a5\u6210\u529f\uff01<p>",width:365}):f().pop({title:"\u63d0\u793a",content:'<div class="reportErrorPop"><div style="height:100px;">'+k[e.errno]+'</div><p><a href="###" class="report-gray-s-button" onclick="pop.hide();return false;">\u5173\u95ed</a></p></div>',width:365}),f().drawSize(),i&&(j("6",i),i=null);else if(67==e.errno||68==e.errno){if(c.g("report_pin_tips"+v))return void(c.g("report_pin_tips"+v).innerHTML="\u9a8c\u8bc1\u7801\u9519\u8bef\uff01");f().confirm({title:"\u8bf7\u8f93\u5165\u624b\u673a\u9a8c\u8bc1\u7801",content:'<div class="pv20"><input type="text" id="report_pin_input'+v+'" style="padding:2px 5px;margin-right:10px;height:22px;line-height:22px;width:150px;"><input type="button" id="report_pin_btn'+v+'" value="\u53d1\u9001\u9a8c\u8bc1\u7801" style="width:150px;text-align:center;height:30px;"><p id="report_pin_tips'+v+'" style="color:red;height:30px;line-height:30px;"></p></div>',width:380,onOk:function(){var e=c.string.trim(c.g("report_pin_input"+v).value);/^\d{6}$/.test(e)?wk.report.postVipReport(e):c.g("report_pin_tips"+v).innerHTML="\u8bf7\u6b63\u786e\u8f93\u51656\u4f4d\u6570\u5b57\u9a8c\u8bc1\u7801\uff01"}}),c.on("report_pin_btn"+v,"click",function(){var e,t=this,r=60;c.ajax.post("/report/interface/sendReportPin","doc_id="+s.docId,function(){}),t.value="\u91cd\u65b0\u53d1\u9001\u9a8c\u8bc1\u7801\uff08"+r+"\uff09",t.disabled="disabled",e=setInterval(function(){--r?t.value="\u91cd\u65b0\u53d1\u9001\u9a8c\u8bc1\u7801\uff08"+r+"\uff09":(clearInterval(e),t.value="\u91cd\u65b0\u53d1\u9001\u9a8c\u8bc1\u7801",t.disabled=!1)},1e3)})}else P(e)},P=function(e){0==e.errno?1==e.isGreenPassport?wk.report.showVipPop():wk.report.showPop():(f().pop({title:"\u63d0\u793a",content:'<div class="reportErrorPop"><div style="height:100px;">'+k[e.errno]+'</div><p><a href="###" class="report-gray-s-button" onclick="pop.hide();return false;">\u5173\u95ed</a></p></div>',width:365}),f().drawSize())},I=function(){return u.insertHTML(document.body,"beforeEnd",x),u.g("reportForm_"+v)},S=function(){_.on("reportForm_"+v,"click",function(e){var t=_.getTarget(e),r=c.g("report_form_submit_"+v);if("radio"==u.getAttr(t,"type")&&t.checked){var o=t.value;u.removeClass(r,"report-green-button-disabled"),9==o?(u.show("report_item_val9_"+v),r.innerHTML="\u4e0a\u4f20\u6750\u6599"):(u.hide("report_item_val9_"+v),r.innerHTML="\u63d0\u4ea4"),r=t=null,y.report_reason=o}}),_.on("report_form_submit_"+v,"click",function(e){var t=u.hasClass(this,"report-green-button-disabled");if(t||m)return void _.stop(e);var r,o=y.report_reason;return 9==o?void f().hide():(_.stop(e),8!=o&&(r="doc_id="+s.docId+"&ct=20116&report_reason="+o),8==o&&(r="doc_id="+s.docId+"&ct=20116&report_reason="+o+"&extra_info=noURL"),m=!0,f().hide(),void c.ajax.post("/report/submit/reportSubmit",r,function(e,t){var r=c.json.parse(t);T(r),m=!1}))}),_.on("report_form_hide_"+v,"click",function(e){_.stop(e),f().hide()})},R=function(){_.un("reportForm_"+v,"click");p.browser.ie?"propertychange":"input";_.un("report_form_submit_"+v,"click"),_.un("report_form_hide_"+v,"click")},C={showTip:function(e,t){u.getAttr(e,"data-has-report");if(w)return void clearTimeout(o);var t=t||(g?b[1]:b[0]),r=u.g("reportTip_"+v);r||(r=u.create("div",{className:"respoTipWrap",id:"reportTip_"+v,style:"display:none;position:absolute;left:"+(e.offsetWidth+3)+"px;"})),e.appendChild(r),r.innerHTML=t,r.style.display="block",w=!0},hideTip:function(){var e=u.g("reportTip_"+v);e&&w&&(o=setTimeout(function(){e.style.display="none",w=!1},300))},checkReportStatus:function(e){m||(m=!0,c.ajax.post("/report/interface/reportPreCheck","doc_id="+s.docId,function(t,r){var o=c.json.parse(r);e?e.call(this,o):h.eventCenter.dispatchEvent("Report.CheckFinish",{data:r}),m=!1}))},showPop:function(){var e=this;if(0==g){f().pop({content:'<div id="report_form_wrap_'+v+'"></div>',title:"\u6b64\u6587\u6863\u662f\u5426\u6d89\u53ca\u4fb5\u6743\uff1f",width:560,onclosed:function(){e.closePop()}}),f().drawSize();var t=u.g("reportForm_"+v),r=u.g("report_form_wrap_"+v);t||(t=I(),S(t)),r.appendChild(t),"docReport-copr"==i.id?(u.setStyle("report-reason-all","display","none"),u.setStyle("report-reason-copr","display","block")):(u.setStyle("report-reason-copr","display","none"),u.setStyle("report-reason-all","display","block")),t.style.display="block",t=r=null,f().drawSize()}},postVipReport:function(e){e=e||0,c.ajax.post("/report/submit/reportSubmit","ct=20116&report_reason=8&extra_info=noURL&doc_id="+s.docId+"&pin="+e,function(e,t){var r=c.json.parse(t);T(r),m=!1})},showVipPop:function(){0==g&&(f().confirm({content:'<div class="pv20" style="text-align:center">\u60a8\u662f\u5426\u786e\u8ba4\u4e3e\u62a5\u8be5\u6587\u6863\u4e3a\u76d7\u7248\uff1f</div>',title:"\u4e3e\u62a5\u786e\u8ba4",width:350,onOk:function(){wk.report.postVipReport()}}),f().drawSize())},closePop:function(){R()}};h.module("wk.report",C),h.module("pop.hide",function(){f().hide()});var L=1;h.eventCenter.addEventListener("Report.Click",function(e){var e=e||event;l.verlogin(function(){if(a.UserInfo.isNoUsername)L&&(L=0,p.sio.callByBrowser("https://passport.baidu.com/passApi/js/wrapper.js?cdnversion="+(new Date).getTime(),function(){window.passport.use("fillUserName",{tangram:!0},function(e){var t=e.passport.fillUserName,r=new t({product:"wenku",staticPage:"http://"+location.host+"/static/wkcommon/html/v3Jump.html"});r.on("fillUserNameSuccess",function(e){e.returnValue=!1,location.reload()}),r.on("render",function(){L=1,n(".pass-button-submit").val("\u786e\u8ba4")}),r.on("validateError",function(e){n(".pass-item-error-userName").text("\u6b64\u7528\u6237\u540d\u5df2\u88ab\u6ce8\u518c\uff0c\u8bf7\u53e6\u6362\u4e00\u4e2a"===e.validate.msg?"\u6b64\u7528\u6237\u540d\u5df2\u88ab\u6ce8\u518c":"\u7528\u6237\u540d\u957f\u4e0d\u5f97\u8d85\u8fc77\u4e2a\u6c49\u5b57\uff0c\u4e14\u4e0d\u80fd\u662f\u7eaf\u6570\u5b57")});var o=f;o().alert({title:"\u62b1\u6b49\uff0c\u60a8\u8fd8\u6ca1\u6709\u6635\u79f0\uff0c\u6211\u4eec\u65e0\u6cd5\u4e0e\u60a8\u53d6\u5f97\u8054\u7cfb\uff0c\u8bf7\u60a8\u8d77\u540d\u540e\u518d\u8fdb\u884c\u4e3e\u62a5\u5427~",content:'<div id="insertPass"></div>',width:580,height:320}),n(".btc").hide(),n("#insertPass").html(""),r.render("insertPass")})}));else{var t=u.getAttr(e.target,"data-has-report");if(0!==+t)return void T({errno:t});window.wk.report.checkReportStatus(function(t){i=e.target,P(t)})}},null,null,{user:a.UserInfo,actionName:"report"})}),r.exports=C});
;define("wkview:widget/ui/view/page_list/page_list.js",function(e,a,n){var t=e("wkcommon:widget/lib/tangram/base/base.js"),i=function(e){var a=t.dom.query("#"+e.pageList+" li");t.event.on(e.pagePre,"click",function(){n(Number(t.g(e.pageNum).innerHTML)-1)}),t.event.on(e.pageNext,"click",function(){n(Number(t.g(e.pageNum).innerHTML)+1)});var n=function(n){0!=n&&n<=e.total&&(t.g(e.pagePre).className="view-sps "+(1==n?"pre-null":"pre"),t.g(e.pageNext).className="view-sps "+(n==e.total?"next-null":"next"),t.g(e.pageNum).innerHTML=n,t.dom.query("#"+e.pageList+" .current")[0].className="",a[n-1].className="current")}};n.exports.pageList=i});
;define("wkview:widget/ui/view/reader_pace/reader_pace.js",function(e,a,t){var n=e("wkcommon:widget/lib/tangram/base/base.js"),s=e("wkcommon:widget/lib/fis/data/data.js"),d=s.get("WkInfo"),r=function(e,a,t,s,r){var o=d.DocInfo.docId,a=a||20148,t=t||"/user/submit/readprogress",f=e.getReader(),c=parseInt(d.PaceInfo.rate)||3,r=r||function(){};return database={page:0,offset:0},_getReaderPace=function(){if(e){f=e.getReader();var t=f.NS_IK_getPagethOnClose()||0,n=f.NS_IK_getPageOffset()||0;return t==database.page&&n==database.offset?void 0:(database.page=t,database.offset=n,{doc_id:o,page:t,offset:n,ct:a})}},_sendReaderPace=function(e){n.ajax.post(t,"fold_request="+n.json.stringify(e),r)},sendPaceInRate=function(){setInterval(function(){var e=_getReaderPace();e&&_sendReaderPace(e)},1e3*c)},{sendPaceInRate:sendPaceInRate}};t.exports.readerPace=r});
;define("wkview:widget/ui/view/star/star.js",function(s,r,a){var t=function(s,r){var r=r||"b";return"#####".replace(/#/g,function(a,t){var e=t+1-s,n=0>=e?"on":.5==e?"half":"off";return'<b class="ic {starCss}"></b>'.replace("{starCss}","ic-star-"+r+"-"+n)})},e=function(s){parseInt(56*s/100);return'<span class="recomBox"><span class="recomRatio">'+s+"% </span>\u63a8\u8350</span>"};a.exports.star=t,a.exports.starNew=e});
;define("wkview:widget/ui/course_remind/course_remind.js",function(e,t,n){var i=e("wkcommon:widget/lib/tangram/base/base.js"),o=e("wkcommon:widget/ui/js_core/util/util.js"),s=e("wkcommon:widget/ui/js_core/rightCornerPop/rightCornerPop.js"),r=e("wkcommon:widget/lib/fis/data/data.js"),a=function(){var e="\u4eba\u751f\u5728\u52e4\uff0c\u4e0d\u7d22\u4f55\u83b7\u2014\u2014\u5f20\u8861aki\u806a\u660e\u51fa\u4e8e\u52e4\u594b\uff0c\u5929\u624d\u5728\u4e8e\u79ef\u7d2f\u3002\u2014\u2014\u534e\u7f57\u5e9aaki\u4e66\u5c71\u6709\u8def\u52e4\u4e3a\u5f84\u2014\u2014\u97e9\u6108aki\u9532\u800c\u4e0d\u820d\uff0c\u91d1\u77f3\u53ef\u9542\u2014\u2014\u8340\u5b50aki\u5929\u884c\u5065\uff0c\u541b\u5b50\u4ee5\u81ea\u5f3a\u4e0d\u606f\u2014\u2014\u5468\u6613aki\u4e0d\u79ef\u8dec\u6b65\uff0c\u65e0\u4ee5\u81f3\u5343\u91cc\u2014\u2014\u8340\u5b50",t=e.split("aki")[Math.floor(5*Math.random()+1)],n=function(e,t){return e.replace(/\{(\w+)\}/g,function(e,n){return t[n]})},a='<div class="remind_content"><p class="remindtitle"><a href="/course/view/{lessonId}" target="_blank" hidefocus="true">{subject}</a>\u7684\u5b66\u4e60\u65f6\u95f4\u53c8\u5230\u4e86</p><div class="progressbar"><span class="progress_start{nullBody}"></span><span class="progress_body" style="width:{percent}%"></span><span class="progress_target" style="width:{nextPercent}%"></span><span class="progress_end{nullEnd}"></span><div class="tips" style="left:{nextPercent}%;margin-left: -28px;">\u51b2\u523a{nextPercent}%</div></div><div class="continue"><a href="#" class="ignore" data-id="{lessonId}" hidefocus="true">\u5ffd\u7565\u672c\u8bfe</a><a href="/course/study/{nextSectionId}?fr=plannoitceOfView" hidefocus="true" target="_blank" class="continue-btn">\u7ee7\u7eed\u5b66\u4e60</a></div><span class="famous">'+t+"</span></div>";if(0!=r.get("WkInfo").PageInfo.isLogin&&i.cookie.get("course_remind")!=r.get("WkInfo").UserInfo.userName){var c=function(e){var t=document.createElement("div");return t.style.cssText="visibility:hidden;z-index:-1000;position:absolute;",t.innerHTML=e,document.body.appendChild(t),document.body.lastChild.clientWidth};i.ajax.get("/course/interface/getplannotice",function(e,t){var t=i.json.parse(t);t=t.data.data;var l=i.date.format(new Date,"yyyy/MM/dd")+" 23:59:59";if(l=new Date(l),document.cookie="course_remind="+r.get("WkInfo").UserInfo.userName+"; expires="+l.toGMTString(),"[object Array]"!=Object.prototype.toString.call(t)&&void 0!=t){t.nullBody=0==t.percent?"_null":"",t.nullBody=0==t.percent&&0!=t.nextPercent?"_target":"",t.nullEnd=100==t.nextPercent?"_full":"";var d=c(t.subject)>119?20:0;a=n(a,t);var u,p=s.rbcPopCreate({height:234+d,width:300,title:"\u4e0a\u8bfe\u5566\uff01",content:[{name:"r",html:a}]});i.dom.q("inner",p.el)[0].style.height=207+d+"px",p.el&&i.dom.setStyle(p.el,"overflow","hidden"),p.slideDown=function(){function e(t,n,i,o,s,r){var a=n(i,o,s,r);t.style.bottom=-a+"px",i++<r?setTimeout(function(t,n,i,o,s,r){return function(){e(t,n,i,o,s,r)}}(t,n,i,o,s,r),10):p.hide()}6==i.browser.ie&&p.hide();var t=0,n=0,o=235+d,s=80,r=this,a=function(e,t,n,i){return n*((e=e/i-1)*e*e+1)+t};e(r.el,a,t,n,o,s)},p.close=function(){clearTimeout(u),p.slideDown()},o.delegate(p.el,".ignore","click",function(){i.ajax.post("/course/interface/ignorelessonplan","lessonId="+this.getAttribute("data-id"),function(){}),clearTimeout(u),p.slideDown()}),p.un("hide"),i.ajax.get("/course/interface/updateplannotice",function(){}),6==i.browser.ie&&(i.dom.q("close-pop",p.el)[0].style.margin="-10px -5px"),u=setTimeout(function(){p.slideDown()},2e4)}})}};i.lang.eventCenter.addEventListener("getCoursePopMsg",function(){a()}),n.exports.course_remind=a});
;define("wkview:widget/ui/sync_map/sync_map.js",function(e,t,a){var s=e("wkcommon:widget/lib/tangram/base/base.js"),l=e("wkcommon:widget/ui/js_core/util/util.js"),n=e("wkcommon:widget/ui/js_core/mvp/template/template.js").template,i=(e("wkcommon:widget/ui/js_core/accordion/accordion.js"),e("wkcommon:widget/ui/js_core/tabs/tabs.js")),o=e("wkcommon:widget/ui/js_core/widget/widget.js").widget,r=e("wkcommon:widget/lib/fis/data/data.js"),c=e("wkcommon:widget/ui/js_core/log/log.js"),d=o({Options:{ralateEle:null,mapEle:null,ralateTarget:null,mapTarget:null,mapPos:"",docId:"",pager:"",onlyMap:!1,debugMap:!1,debugError:!1,errorMsg:[]},_init:function(e){var t=this;t.mapCount=[],t.data={},t.url="/portal/interface/getdocsubject?app=get_subject_info&doc_id="+t.docId+"&t="+(new Date).getTime(),l.mix(t,e.cover||{},!0),t.ralateTpl=['<div class="sync-ralate-doc mod mt20">','<a href="<%=subject_title.url%>" target="_blank" id="sync-relate-head-link" style="display:none"><%=subject_title.subject%></a>','<div class="hd">','<dl class="sync-relate-head">',"<dt>","<%=subject_title.class_title%>","</dt>","<dd>",'<h3><a href="###"><%=subject_title.subject%></a></h3>','<div class="sync-relate-head-static">',"<span><%if(subject_title.stype2_num>10000){%><%=~~(subject_title.stype2_num /10000)%>\u4e07<%}else{%><%=subject_title.stype2_num%><%}%>\u8bfe\u4ef6</span>","<span>&nbsp;<%if(subject_title.stype3_num>10000){%><%=~~(subject_title.stype3_num /10000)%>\u4e07<%}else{%><%=subject_title.stype3_num%><%}%>\u4e60\u9898</span>","</div>","</dd>","</dl>","</div>",'<div class="bd ralate-doc-accordion pl10">',"<%for(var i=0,len=lesson.length;i<len;i++){%>","<%var controlClass = ' class=\"current first ib\"';%>","<%var contentClass = ' class=\"current\"';%>","<%var tabsName = ['\u6559\u6848','\u8bfe\u4ef6','\u4e60\u9898'];%>","<%var stype,titleMaxLength,titleLength,titleAfter,docTitle;%>",'<div class="sync-accordion-item">','<div class="hd accordion-control lesson-item-hd">','<b class="ic ic-ralate-accordion<%if(i == len-1){%> last<%}%>"></b>','<span class="lesson-title ib cut-link"><a <%if(i == len-1){%>class="last" alog-action="view.sync.curlesson"<%}else{%> alog-action="view.sync.lesson"<%}%> href="<%=lesson[i].url%>" title="<%=lesson[i].name%>" target="_blank"><%=lesson[i].name%></a></span>',"</div>","<%if(i == len-1){%>",'<div class="bd accordion-content">','<div class="sync-tabs tabs mod" id="sync-tabs-only">','<div class="hd">',"<%if (lesson[i].useStype){%>",'<ul class="tabControl ib mt5">',"<%for (var j=1;j<4;j++){%>","<%if (lesson[i]['stype'+j].length > 0){%>",'<li<%=controlClass%> alog-action="view.synctab"><span class="tabs-stype tabs-stype-<%=j%>"><%=tabsName[j-1]%></span></li>',"<%controlClass=' class=\"ib\"';%>","<%}%>","<%}%>","</ul>","<%}%>","</div>",'<div class="bd">','<ul class="tabContent sync-tab-content" alog-group="view.syncdoc">',"<%for (var j=1;j<4;j++){%>","<%if (lesson[i].useAll){%>","<%stype=lesson[i]['all_stype'];%>","<%}else{%>","<%stype=lesson[i]['stype'+j];%>","<%}%>","<%if (stype.length > 0){%>","<li<%=contentClass%>>","<%contentClass=' class=\"disabled\"';%>",'<ul class="sync-doc-list">',"<%for (var k=0,l=stype.length>5?5:stype.length;k<l;k++){%>",'<li class="sync-doc-item<%if(k == l - 1){%> sync-doc-item-last<%}%> pb5">',"<%titleMaxLength = 20 - (stype[k].page + '').length - 2;%>","<%titleLength = strLen(stype[k].title);%>","<%if(titleLength > titleMaxLength){%>","<%docTitle = substr(stype[k].title,titleMaxLength) + '...';%>","<%}else{%>","<%docTitle = stype[k].title;%>","<%}%>",'<span class="sync-doc-pages c-gray9"><%=stype[k].page%>\u9875</span>','<b class="ic ic-<%=docTypes[stype[k].type]%>"></b>','<a href="http://wenku.baidu.com/view/<%=stype[k].doc_id%>.html" class="sync-doc-title ib" title="<%=stype[k].title%>" target="_blank"><%=docTitle%></a>',"</li>","<%}%>","</ul>","</li>","<%}%>","<%if (lesson[i].useAll){%>","<%break;%>","<%}%>","<%}%>","</ul>","</div>","</div>","</div>","<%}%>","</div>","<%}%>","</div>","</div>"].join(""),t.examInfoTpl=['<div class="mod exam-info pt20">','<h4><a href="<%=data.title_url%>" target="_blank"><%=data.title%></a><span class="t-tag">\u5168\u653b\u7565</span></h4>','<div class="exam-tag-list">',"<%for ( var i = 0; i < data.ul.length; i++ ) {%>","<%var item = data.ul[ i ];%>",'<ul class="clearfix tagul-<%=i%>">','<li class="tag"><%=item.name%></li>',"<%for ( var j = 0; j < item.li.length; j++ ) {%>","<%var liItem = item.li[ j ];%>",'<li><a href="<%=liItem.url%>" target="_blank"><%=liItem.name%></a></li>',"<%}%>","</ul>","<%}%>","</div>","</div>"].join(""),t._getData()},_getData:function(){var e=this;s.ajax.get(e.url,function(t,a){var l={};try{e.data=s.json.parse(a)}catch(n){}if("1"===e.data.subject_info.is_hit){l=e.data.subject_info,e.defaultStype=parseInt(l.stype)||1,(e.defaultStype<1||e.defaultStype>3)&&(e.defaultStype=1);try{l.rec=l.rec||[],e.onlyMap===!1&&e._checkRalateDocData(l.rec.concat([]))&&e.renderRalate(e.renderRelateData)}catch(n){e.errorMsg.push("render error:"+n,n)}}else e.data.qualification.title&&e.renderExamInfo(e.data.qualification)})},renderExamInfo:function(e){var t=this,a=s.dom.query(".aside .doc-info")[0],i=s.dom.query(".aside .same-series-doc")[0],o=l.createDom(n(t.examInfoTpl,{data:e}));if(a){i&&(i.style.display="none"),s.dom.insertAfter(o,a),setTimeout(function(){s.dom.addClass(o,"exam-info-animate")},0),t._log({examinfo:"load"}),l.delegate(o,"h4","click",function(){t._log({examinfo:"title"})});for(var r=0;3>r;r++)!function(e){l.delegate(o,".tagul-"+e,"click",function(){t._log({examinfo:"tag"+e})})}(r)}},_checkRalateDocData:function(e){e=e||[];for(var t,a=this,s=1,l=e.shift(),n=[];l&&l.name;)n.push(l),l=e.shift();for(;s=n.length;){for(l=n[s-1],t=0,s=1;4>s;s++)l["stype"+s]&&l["stype"+s].length>4?t++:l["stype"+s]=[];if(t>1||l.all_stype.length>4)return t>1?l.useStype=!0:l.useAll=!0,a.renderRelateData=n,!0;n=n.slice(0,s-1)}return a.renderRelateData=[],!1},_checkMapData:function(e){var t,a,s=this;s.renderMapData={sgv:e[0],unite:e[1],lesson:e[2]};for(var l=0,n=e.length;n>l;l++){if(e[l]=e[l]||[],t=e[l].length,2>t||t>3){if(2===l&&1>t)break;return s.errorMsg.push("map data error:count is wrong!"),!1}if(l>0){if(a=s._getSelected(e[l]),-1===a)return s.errorMsg.push("map data error:no selected!"),!1;s.mapCount.push(t,a)}}return!0},_getSelected:function(e){for(var t=0;t<e.length;t++)if("1"===e[t].selected)return t;return-1},_strLen:function(e){return e.replace(/[^\x00-\xff]/g,"aa").length},_fixLineHeight:function(e){e.offsetHeight<1||null===s.dom.getAttr(e,"data-fixed-size")&&(s.each(s.q("sync-doc-item",e),function(e){setTimeout(function(){var t,a,l,n,i,o=e.offsetHeight;if(43>=o)t=s.q("sync-doc-title",e)[0],a=s.q("sync-doc-pages",e)[0],t.offsetWidth+a.offsetWidth>182&&(t.innerHTML+="<span>..</span>",6===s.browser.ie&&(a.style.cssText+=";zoom:1;"));else if(o>67&&(l=s.dom.query(".sync-doc-title span",e)[0],l&&s.dom.remove(l),o=e.offsetHeight,o>67)){for(t=s.q("sync-doc-title",e)[0],n=t.innerHTML,i=n.length,"..."===n.substr(-3)&&(i-=3,n=n.substr(0,i));o>67;)n=n.substr(0,--i),t.innerHTML=n+"...",o=e.offsetHeight;t.innerHTML=n.substr(0,--i)+"..."}},20)}),s.dom.setAttr(e,"data-fixed-size","fixed"))},_initTabs:function(e){var t=this,a=!0,l=0,n=s.q("tabs-stype-"+t.defaultStype,e)[0],o=s.q("tabs-stype",e);t._tabIndex=t.defaultStype,n&&o&&(l=s.array.indexOf(o,n),l=l>-1?l:0),i.tabsCreate({el:e,bindEvent:"click",selectIndex:l,onAfterCurrent:function(e,s){t._fixLineHeight(s.bdElement),t._tabIndex=s.hdElement.firstChild.className.match(/tabs-stype-(\d)/)[1]||t.defaultStype,a?a=!1:t._log({switchover:"tabs",tabindex:t._tabIndex})}})},_log:function(e){c.send("view","subject",e)},renderRalate:function(e){var t,a,i,o=this,c=r.get("WkInfo").PageInfo.docTypeList.concat([]);if(null==o.ralateTarget)return void o.errorMsg.push("ralateTarget is null");for(a=0,i=e.length;i>a;a++)"1"===e[a].selected&&(t=a);o.ralateEle=l.createDom('<div class="sync-ralate-doc-wrap height-animate hide-by-height"></div>'),o.ralateEle.innerHTML=n(o.ralateTpl,{lesson:e,fullMapUrl:o.data.subject_info.sgv[0].url,subject_title:o.data.subject_info.subject_title,docTypes:s.array.map(c,function(e){return e[0]}),strLen:o._strLen,substr:function(e,t){t=t%2===0?t:t-1;for(var a,s,l=t/2;o._strLen(a=e.substr(0,l))<=t;)s=a,l++;return s}}),s.dom.insertBefore(o.ralateEle,o.ralateTarget),o._initTabs(s.g("sync-tabs-only")),l.delegate(o.ralateEle,".sync-relate-head","click",function(e){o._log({click:"relate_head"});var t=s.g("sync-relate-head-link");t.click?t.click():s.event.fire(t,"click"),s.event.preventDefault(e)}),l.delegate(o.ralateEle,".sync-relate-head","mouseover",function(){this.className="sync-relate-head hover"}),l.delegate(o.ralateEle,".sync-relate-head","mouseout",function(){this.className="sync-relate-head"}),o._log({show:"relate"}),l.delegate(o.ralateEle,".sync-doc-title","click",function(){o._log({click:"relate_doc",tabindex:o._tabIndex})}),l.delegate(o.ralateEle,".lesson-title a","click",function(){o._log({click:"lesson-title"})}),setTimeout(function(){var e,t=s.dom.query(".aside .same-series-doc")[0];s.dom.addClass(o.ralateEle,"get-size-class"),s.dom.removeClass(o.ralateEle,"hide-by-height"),e=o.ralateEle.offsetHeight,s.dom.removeClass(o.ralateEle,"get-size-class"),setTimeout(function(){o.ralateEle.style.height=e+"px",o.ralateTarget.style.display="none",t&&(t.style.display="none"),setTimeout(function(){s.dom.removeClass(o.ralateEle,"height-animate"),o.ralateEle.style.height="auto"},2e3)},0)},0)},renderMap:function(e){function t(e){return s.trim(e).replace(/(\s)+/g,"$1")}var a=this;return null==a.mapTarget?void a.errorMsg.push("mapTarget is null"):(e.mapCount=a.mapCount.join("-"),e.uniteCount=a.mapCount.slice(0,2).join("-"),e.lessonCount=a.mapCount.slice(2).join("-"),e.fullMapUrl=e.sgv[0].url,e.pager=a.pager,e.isOverflow=function(e,s,l,n){e=t(e),n=n||0;var i=a._strLen(e);return l===!0&&n>0&&i===e.length&&(s+=n),a._strLen(e)>s},e.addSpace=function(e){var a=" ";return(6===s.browser.ie||7===s.browser.ie)&&(a="<span> </span>"),t(e.replace(/[^\x00-\xff]/g,function(e){return a+e+a})).replace(/ +/g," ")},s.dom.insertHTML(a.mapTarget,a.mapPos,n(a.mapTpl,e)),a.mapEle=s.q("sync-map-"+a.pager+"-wrap")[0],a._log({show:"map"}),void l.delegate(a.mapEle,"a","click",function(){a._log({click:"map_link"})}))},_renderAllMap:function(e){if(this.debugMap!==!0||"3-1-3-1"!==this.mapCount.join("-"))return void this.renderMap(e);for(var t,a,s={},l=[["",[3,1,3,1]],["lesson-pop",[3,1,2,1]],["lesson-shift",[3,1,2,0]],["lesson-pop-pop-pop",[3,1]],["unite-pop",[2,1,3,1]],["lesson-pop",[2,1,2,1]],["lesson-shift",[2,1,2,0]],["lesson-pop-pop-pop",[2,1]],["unite-shift",[2,0,3,1]],["lesson-pop",[2,0,2,1]],["lesson-shift",[2,0,2,0]],["lesson-pop-pop-pop",[2,0]]],n=0;12>n;n++){if(s={sgv:e.sgv.concat([]),unite:s.unite||e.unite.concat([]),lesson:e.lesson.concat([])},(4===n||8===n)&&(s.unite=e.unite.concat([])),t=l[n][0].split("-"),t.length>1){for(a=t.shift();t.length>0;)s[a][t.shift()]();this.mapCount=l[n][1]}this.renderMap(s)}}}),u=function(e){return new d(e)};a.exports.syncMap=d,a.exports.syncMapCreate=u});
;define("wkview:widget/ui/file_downloader/file_downloader_core.js",function(e,o,t){var n="undefined"!=typeof localStorage?localStorage:null,r="fileDownloads",i=72e5,s=function(e,o){this.url=e,o=o||{},this.options={threads:o.threads||5,retries:o.retries||3,sectionMaxSize:o.sectionMaxSize||30},this.fileName=o.fileName||e.split("/").pop(),this.threadContainer=[],this.downloadedSize=0,this.worker=new Worker("/static/wkview/worker/file_downloader_worker_3028a73.js")},a={100:"NotSupported",101:"HeadRequest",102:"FileNotFound",103:"ThreadNullResponse",104:"SizeNotMatch",105:"FileContentLengthZero",106:"ConnectionError"};s.supported=function(){return"webkitRequestFileSystem"in window&&"TEMPORARY"in window}(),s.prototype={constructor:s,uriAnalyser:function(e){var o=new XMLHttpRequest,t=this;o.open("HEAD",this.url,!0),o.onreadystatechange=function(n){if(this.readyState==this.HEADERS_RECEIVED)if(200==this.status){var r=o.getResponseHeader("Content-Type")||"text/plain",i=parseInt(o.getResponseHeader("Content-Length"));0==i?t._onError(105,n):(t.contentType=r,t.fileSize=i,e&&e())}else t._onError(102,n)},o.onerror=function(e){console.log(e),t._onError(101,e)},o.send()},messageHandler:function(e){{var o=this,t=e.data;({createFile:function(){0!=t.statusCode?o._onError(t.statusCode,e):(o.folderName=t.dir,n.setItem(r,n.getItem(r)+t.dir+"&"))},onProgress:function(){t.lengthComputable&&(o.downloadedSize=t.downloadedSize,o.onProgress&&o.onProgress(t.id,t))},onThreadComplete:function(){o.onThreadComplete&&o.onThreadComplete(t.id)},onDownloadComplete:function(){o.openDownloadDialog(t.fileURL),o.onComplete&&o.onComplete()},onFileGenerate:function(){0!=t.statusCode&&o._onError(t.statusCode,e)},debug:function(){console.log(t.i)}})[t.action]()}},prepare:function(){var e=this;this.worker.onmessage=function(o){e.messageHandler(o)},this.uriAnalyser(function(){e.onConnected(e.fileSize,e.fileName),e.worker.postMessage({action:"run",sectionMaxSize:e.options.sectionMaxSize,fileName:e.fileName,fileSize:e.fileSize,threads:e.options.threads,retries:e.options.retries,contentType:e.contentType,url:e.url})})},openDownloadDialog:function(e){var o=document.createElement("a");o.href=e,o.download=this.fileName,o.click()},onConnected:function(){},download:function(){return this.constructor.supported?void this.prepare():void this._onError(100)},panDomainFilter:function(e){return e},_onError:function(e,o){o=o||{},this.onError(e,o.fileErrorCode)},getErrorName:function(e){return 100>e?"FileError: "+e:a[e]+"Error"},getFileSize:function(){return this.fileSize},abort:function(){this.worker.postMessage({action:"abort"}),l(this.folderName)},getDownloadedSize:function(){return this.downloadedSize}};var l=function(e){var o="downloadcache/";webkitRequestFileSystem(TEMPORARY,0,function(t){t.root.getDirectory(o+e,{create:!1},function(o){o.removeRecursively(function(){console.log("remove: "+e),n.setItem(r,n.getItem(r).replace(e+"&",""))})})})};!function(){if(n){var e=n.getItem(r);if(e){var o=(new Date).getTime(),t=e.split("&");t=t.splice(0,t.length-1),t.forEach(function(e){var t=parseInt(e,36);o-t>i&&l(e)})}}}(),t.exports=s});
;define("wkview:widget/ui/file_downloader/file_downloader.js",function(e,o,t){var n=e("wkview:widget/ui/file_downloader/file_downloader_core.js"),d=e("wkcommon:widget/ui/lib/jquery/jquery.js"),r=function(){this._init.apply(this,arguments)};r.isSupport=function(){return n.supported},r.printRFileSize=function(e,o){var t,n;return o="number"==typeof o&&o>=0?o:1,1024>e?(t=1,n="byte",o=0):1048576>e?(t=1024,n="kb"):1073741824>e?(t=1048576,n="MB"):(t=1073741824,n="GB"),(e/t).toFixed(o)+n},r._speedRank=[{precent:0,speed:0},{precent:70.13,speed:262144},{precent:93.49,speed:524288},{precent:99.52,speed:1310720},{precent:99.99,speed:13107200}],r.speedRank=function(e){var o=r._speedRank,t=o[o.length-1].speed;if(e=parseInt(1e3*e),0>=e)return 0;e>t&&(e=t);for(var n=0;e>o[n].speed;)n++;n>0&&(n-=1);try{var d=o[n].precent,a=o[n+1].precent,i=a-d,l=o[n].speed,s=o[n+1].speed,p=s-l;return parseFloat(((e-l)/p*i+d).toFixed(2))}catch(_){return null}},window.FileDownloader=r,r.download=function(e){return new r(e)},r.prototype={_defaultOptions:{url:"",threads:3,retries:1,speedUpdateInterval:1e3,success:function(){},error:function(){},onprogress:function(){}},_init:function(e){var o=this;o.options=e=d.extend(o._defaultOptions,e),o._startTime=null,o._endTime=null,o._lastUpdateTime=null,o._lastUpdateLoaded=0,o._downloadSpeed=0,o._downloadSpeedInterval=null,o._downloader=new n(e.url,{fileName:e.fileName||null,threads:e.threads,retries:e.retries}),o._downloader.onProgress=d.proxy(o._onProgress,o),o._downloader.onComplete=d.proxy(o._onComplete,o),o._downloader.onError=d.proxy(o._onError,o),o._startTime=o._lastUpdateTime=+new Date,o._downloadSpeedInterval=setInterval(d.proxy(o._speedInterval,o),e.speedUpdateInterval),o._downloader.download()},_onProgress:function(e,o){var t=this,n={},d=+new Date;n.total=t._downloader.getFileSize(),n.loaded=t._downloader.getDownloadedSize(),n.usedTime=d-t._startTime,n.remainTime=parseInt((n.total-n.loaded)/t._downloadSpeed),n.speed=t._downloadSpeed,t.options.onprogress(n,o)},_onComplete:function(){var e=this,o={};e._endTime=+new Date,clearInterval(e._downloadSpeedInterval),o.total=e._downloader.getFileSize(),o.loaded=o.total,o.usedTime=e._endTime-e._startTime,o.remainTime=0,o.speed=o.total/o.usedTime,o.speedRank=r.speedRank(o.speed),e.options.success(o)},_onError:function(e,o){var t=this;t.options.error(t._downloader.getErrorName(e),o)},_speedInterval:function(){var e,o=this,t=o.getFileSize(),n=o.getDownloadedSize(),d=+new Date;t&&n&&(e=(n-o._lastUpdateLoaded)/(d-o._lastUpdateTime),o._downloadSpeed=e>0?e:0,o._lastUpdateTime=d,o._lastUpdateLoaded=n)},abort:function(){this._downloader.abort()},getFileSize:function(){return this._downloader.getFileSize()},getDownloadedSize:function(){return this._downloader.getDownloadedSize()}},t.exports=r});
;define("wkview:widget/ui/file_downloader_ui/file_downloader_ui.js",function(n,e,t){var i=n("wkview:widget/ui/file_downloader/file_downloader.js"),o=n("wkcommon:widget/ui/lib/jquery/jquery.js"),s=(n("wkcommon:widget/lib/fis/data/data.js"),n("wkcommon:widget/ui/lib/cookie/cookie.js")),a=n("wkcommon:widget/lib/tangram/base/base.js"),l=n("wkcommon:widget/ui/js_core/log/log.js"),r=function(){this._init.apply(this,arguments)};r.prototype={_default:{url:"",title:"",fileType:"",complete:function(){}},_init:function(n){var e=this;e.options=n=o.extend(e._default,n),e.el=o('<div class="f-downloader"></div>').appendTo(".j_downloader-position"),e._render(e.el),e._initEvent(),e._update=+new Date,e._isLive=!0,e._isComplete=!1,o(window).on("beforeunload",e._before_unload_handler),setTimeout(function(){e.el.addClass("onshow")},0),e._downloader=new i({fileName:n.title+"."+n.fileType,url:n.url,threads:n.threads||3,success:function(n){e._renderProgress(n),e._downloadComplete(n)},error:function(){e._destroy(3)},onprogress:function(n){var t=+new Date;t-e._update>500&&(e._update=t,e._renderProgress(n))}})},_render:function(n){var e=this,t=(e.options,[]);t.push('<div class="downloader-wp"><div class="downloader-inner">'),t.push('<div class="middle-block downloader-content">','<span class="f-title">\u6587\u6863\u6570\u636e\u63d0\u53d6\u4e2d...</span>','<span class="f-ic"></span>','<span class="f-ic-downloading"><span class="f-ic-downloading-inner"></span></span>','<div class="f-progress"><div class="progress-inner"></div></div>','<a href="###" class="f-btn stop-btn j_stop-btn"></a>','<div class="dynamic c_dynamic"></div>',"</div>"),t.push("</div></div>"),n.html(t.join("")),e.dynamicEl=n.find(".c_dynamic"),e.progressEl=n.find(".progress-inner")},_initEvent:function(){var n=this;n.el.on("click",".j_setting-btn",function(){n.el.addClass("onsetting")}).on("click",".j_top-back-btn",function(){n.el.removeClass("onsetting")}).on("click",".j_stop-btn",function(){n._downloader.abort(),n._destroy(n._isComplete?0:1)}).on("click",".j_top-disable-btn",function(){n._downloader.abort(),n._destroy(2)})},_renderProgress:function(n){var e=this,t=[],o=parseInt(n.loaded/n.total*100);t.push('<span class="d-span d-speed">'+i.printRFileSize(1e3*n.speed)+"/s</span>",'<span class="d-span d-file-size">'+i.printRFileSize(n.loaded)+"/"+i.printRFileSize(n.total)+"</span>",'<span class="d-span d-remain-time">'+(n.remainTime>999?e._printRRemainTime(n.remainTime):"")+"</span>"),e.dynamicEl.html(t.join("")),o>0&&e.progressEl.css("width",o+"%")},_downloadComplete:function(n){{var e=this;i.printRFileSize(1e3*n.speed)}e._isComplete=!0,e.el.addClass("oncomplete"),o(window).off("beforeunload",e._before_unload_handler),setTimeout(function(){e._destroy(0,n)},0)},_destroy:function(n,e){var t=this;t.el.off().removeClass("onshow"),o(window).off("beforeunload",t._before_unload_handler),setTimeout(function(){t._isLive&&(t._isLive=!1,t.el.remove(),t.options.complete(n,e))},10)},_printRRemainTime:function(n){function e(n){var e=n.toString();return 1==e.length&&(e="0"+e),e}n=parseInt(n/1e3),sign=":";var t,i,o;return t=i=o=0,t=parseInt(n/3600),i=parseInt(n%3600/60),o=parseInt(n%3600%60),e(t)+sign+(e(i)+sign)+e(o)},_before_unload_handler:function(){return"\u60a8\u6709\u672a\u5b8c\u6210\u4e0b\u8f7d\uff0c\u786e\u8ba4\u9000\u51fa\uff1f"}};var d={instance:null,minFileSize:5242880,el:null,download:function(n){n=n||{},l.send("down","mutli_download_start"),d.isSupport(n.fileSize)?(d.getEl().show(),s.get("init_mutli")?d._initDownload(n):d._initTutorial({complete:function(){s.set("init_mutli",1,{path:"/",expires:864e8}),d._initDownload(n)}})):d.originalDownload(n.url)},isSupport:function(n){return n=parseInt(n)||0,supportSetting="function"==typeof window._mutli_support_setting?window._mutli_support_setting:d._mutli_support_setting,i.isSupport()&&!+s.get("disable_mutli")&&n>=d.minFileSize&&!window._DISABLE_MUTLI_&&supportSetting()?!0:!1},_mutli_support_setting:function(){var n=navigator.userAgent,e=/chrome\/(\d+\.\d+)/i.test(navigator.userAgent)?+RegExp.$1:void 0,t=new RegExp("baidu|bidu|maxthon","i");return!t.test(n)&&e>=28?!0:!1},originalDownload:function(n){location.href=n,a.lang.eventCenter.dispatchEvent("download.realStart")},getEl:function(){return this.el||this._initEl(),this.el},_initTutorial:function(n){n=n||{};var e=[],t=o(".j_downloader-position");e.push('<div class="f-tutorial">','<div class="ft-icon"><div class="ft-rocket"></div></div>','<div class="ft-title">\u6587\u5e93\u5168\u65b0\u6781\u901f\u4e0b\u8f7d\u529f\u80fd</div>','<div class="ft-sub-title">\u8d85\u5927\u6587\u6863\u4e0b\u8f7d\u901f\u5ea6\u63d0\u5347<span style="color:#ff7f18;font-size:1.3em;">3</span>\u500d</div>','<a href="###" class="ft-submit">\u7acb\u5373\u4f53\u9a8c</a>',"</div>"),t.html(e.join(""));var i=t.find(".ft-rocket").removeClass("frame0 frame1 frame2"),s=0,a=setInterval(function(){i.removeClass("frame"+s%3).addClass("frame"+ ++s%3)},120);t.find(".ft-icon").on("click",function(){i.hasClass("launch-rocket")||(i.addClass("launch-rocket"),setTimeout(function(){i.removeClass("launch-rocket")},2e3))}),t.find(".ft-submit").click(function(){clearInterval(a),t.find(".ft-submit").off(),t.find(".ft-icon").off(),t.html(""),n.complete&&n.complete()})},_initDownload:function(n){if(!d.instance){var e=0;Math.random()>.5&&(e=1),d.instance=new r({url:n.url,title:n.title,fileType:n.fileType,threads:e?1:3,complete:function(t,i){d.instance=null;var r="";d.getEl().hide();var p=o.extend({single:e,errno:t},i);l.send("down","mutli_download_end",p),t?1==t||(2==t?s.set("disable_mutli",1,{path:"/",expires:864e8}):3==t&&d.originalDownload(n.url)):(i&&"number"==typeof i.speedRank&&(r="&speedrank="+i.speedRank),setTimeout(function(){a.lang.eventCenter.dispatchEvent("download.realStart",{disableBlank:!0,query:r})},400)),n.complete&&n.complete(t)}})}return d.instance},_initEl:function(){var n=o('<div class="downloader-position-wp" style="display:none;"><div class="dp-inner"><div class="j_downloader-position downloader-position"></div></div><div class="dp-mask"></div><style type="text/css">\n@-webkit-keyframes downloading\n{\n0%{margin-top:-25px;}\n12%{margin-top:-22px}\n24%{margin-top:-19px}\n36%{margin-top:-16px}\n48%{margin-top:-13px;}\n70%{margin-top:0px;}\n}\n</style><style type="text/css">\n@-webkit-keyframes launch_rocket\n{\n0%{-webkit-transform: translate(0, 0);}\n35%{-webkit-transform: translate(0, -350px);}\n40%{-webkit-transform: translate(-350px, -350px);}\n50%{-webkit-transform: translate(-350px, 350px);}\n55%{-webkit-transform: translate(0, 350px);}\n100%{-webkit-transform: translate(0, 0px);}\n}\n</style></div>');n.appendTo("body"),this.el=n}};t.exports=d});
;define("wkview:widget/ui/nsTypeMap/nsTypeMap.js",function(e){var i=e("wkcommon:widget/lib/fis/data/data.js"),w={"view.album":"01000001","view.bg1":"01000002","view.bg2":"01000003","view.bg3":"01000004","view.bg4":"01000005","view.bg5":"01000006","view.big":"01000007","view.bookmark":"01000008","view.bookmark_click":"01000009","view.bookmark_view":"01000010","view.browse":"01000011","view.contentload":"01000012","view.copylogin":"01000013","view.copywords":"01000014","view.doc_link":"01001015","down.docdownload":"01001016","view.docInfo":"01001017","view.double":"01000018","down.download":"01001019","view.dragbtnclick":"01000020","view.dragdrop":"01000021","view.flashkeydown":"01000022","view.flashkeyleft":"01000023","view.flashkeyright":"01000024","view.flashkeyup":"01000025","view.flashload":"01000026","view.fontload":"01000027","view.fullscreen":"01000028","view.getwords":"01000029","view.htmlload":"01000030","view.htmlread":"01000031","view.htmlview":"01001032","lec.index":"01001033","view.keycodeleft":"01001034","view.keycoderight":"01001035","lec.list":"01001036","view.load":"01000037","view.middle":"01000038","view.more_link":"01001039","org.org_list":"01001040","view.otherLikeDoc":"01001041","view.pagedown":"01000042","view.pageup":"01000043","view.pageviewtime":"01000044","view.payview":"01000045","view.price":"01001046","view.reader":"01000047","view.relateAlblum":"01001048","view.relateDoc":"01001049","view.sameSeriesDoc":"01001050","view.save":"01001051","view.scrolldown":"01000052","view.scrollup":"01000053","view.search":"01000054","api.share":"01001055","view.share":"01001056","view.sharedone":"01000057","view.sharewords":"01000058","view.show":"01001059","view.single":"01000060","view.small":"01000061","submit.submit":"01001062","view.tag_link":"01001063","view.toolbarClick":"01000064","view.userEvaluation":"01001065","lec.view":"01001066","view.viewload":"01000067","view.zoomin":"01000068","view.zoomout":"01000069","view.page_vary_all":"01000070","view.cealingSearchboxShow":"01000071","view.cealingSearchboxUse":"01000072","view.transfer543":"01001073","view.nav.click":"01001074","test.hit":"098000001"};i.set("nsTypeMap",w)});
;define("wkview:widget/ui/doc_business/doc_business.js",function(i,e,s){function o(i){this.options=t.extend({doc_title:"",doc_size:"",content:"",resize:function(){},open:function(){},firstOpen:function(){},close:function(){}},i||{}),this.init()}{var t=i("wkcommon:widget/ui/lib/jquery/jquery.js"),n=i("wkcommon:widget/lib/tangram/base/base.js"),a=i("wkcommon:widget/lib/fis/data/data.js"),d=(i("wkcommon:widget/ui/js_core/log/log.js"),a.get("WkInfo"));a.get("userFlowGroup")}o.prototype={init:function(){var i=this;i.creat(),i.bindEvent(),this.isChrome=n.browser.chrome},reset:function(){t(this.el).remove(),t(".dialog-container-iframe").remove(),this.init()},creat:function(){var i=null,e=document.body;docTitle=n.string.getByteLength(d.DocInfo.title)<26?d.DocInfo.title:n.string.subByte(d.DocInfo.title,26,"...");var s='<iframe class="dialog-container-iframe" allowTransparency="true" src="" frameborder="0" scrolling="no"></iframe>',o=['<div class="dialog-container dialog-org border-none">','<div class="close-btn"></div>','<div class="dialog-top">','<p class="doc-title">'+docTitle+"</p>",'<p class="doc-size">('+(d.DocInfo.size/1024+"").replace(/^(\d+\.\d)\d+$/,"$1")+"K)</p>","</div>",'<div class="dialog-inner">','<p class="ticket-num-msg msg0 error-sure hide">\u7cfb\u7edf\u9519\u8bef\uff0c\u8bf7\u5728\u9875\u9762\u5237\u65b0\u540e\u91cd\u65b0\u4e0b\u8f7d</p>','<p class="ticket-num-msg msg1 org">\u6240\u9700\u4e0b\u8f7d\u5238\uff1a7</p>','<p class="ticket-detail-msg msg2 org">\u60a8\u6301\u67091\u4e0b\u8f7d\u5238.\u8d22\u5bcc\u503c\u4e0d\u8db3\uff0c\u65e0\u6cd5\u5151\u6362\u4e0b\u8f7d\u5238</p>','<p class="ticket-detail-msg msg3 org hide">(\u4f01\u4e1a\u8d26\u53f7\u4ec5\u652f\u6301\u4e0b\u8f7d\u4ef7\u683c\u572850\u5143\u4ee5\u5185\u7684\u6587\u6863)</p>','<p class="ticket-detail-msg warning org hide">\u672c\u6587\u6863\u4ec5\u652f\u6301\u5728\u7ebf\u9605\u8bfb\uff0c\u8d2d\u4e70\u540e\u53ef\u9605\u8bfb\u5168\u6587</p>','<div class="dialog-down-load-btn-center dialog-gray"><a class="dialog-down-load-btn btn-green btn-l btn-small" href="javascript:void(0);">\u5207\u6362\u81f3\u4e2a\u4eba\u8d26\u53f7\u4e0b\u8f7d</a></div>','<div class="dialog-down-load-btn-center dialog-green"><a class="dialog-down-load-btn btn-green btn-l" href="javascript:void(0);">\u7acb\u5373\u4e0b\u8f7d</a></div>','<div class="dialog-down-load-btn-center error-sure hide"><a class="dialog-down-load-btn btn-green btn-l" href="javascript:void(0);">\u786e\u5b9a</a></div>','<div class="dialog-down-load-btn-center close-sure hide"><a class="dialog-down-load-btn',' btn-green btn-l" href="javascript:void(0);">\u5173\u95ed</a></div>','<div class="dialog-bottom">','<p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"</div>","</div>"].join("");i=document.createElement("div"),i.id="WkDialogDownDoc",i.style.display="none",i.innerHTML=o,e.insertBefore(i,e.firstChild),t(i).after(s),t(i).addClass("hide"),t(i).addClass("WkDialogDownDoc"),this.el=i},creat_2:function(){var i=null,e=document.body,s=(n.string.getByteLength(d.DocInfo.title)<26?d.DocInfo.title:n.string.subByte(d.DocInfo.title,26,"..."),'<iframe class="dialog-container-iframe" allowTransparency="true" src="" frameborder="0" scrolling="no"></iframe>'),o=['<div class="dialog-container dialog-org">','<div class="close-btn"></div>','<div class="dialog-inner dialog-inner_s">','<div style="padding:0 39px;">','<h1>\u60a8\u6700\u8fd1\u4f7f\u7528\u7684\u4f01\u4e1a\u8d26\u53f7: <span class="org_name">\u5357\u65b9\u7535\u7f51 </span>\u5df2\u5931\u6548\uff0c\u8bf7\u91cd\u65b0\u83b7\u5f97\u6388\u6743:</h1>','<p class="ticket-num-msg msg1 org">\u7b2c\u4e00\u6b65 : \u8bbf\u95ee <a href="http://10.91.3.106:8001/Pages/Index.html" target="_blank"><span class="org_name">\u5357\u65b9\u7535\u7f51</span>\u60c5\u62a5\u4e2d\u5fc3;</a></p>','<p class="ticket-detail-msg msg2 org">\u7b2c\u4e8c\u6b65 : \u5728\u60c5\u62a5\u4e2d\u5fc3\u641c\u7d22\u60a8\u9700\u8981\u7684\u6587\u6863\uff0c\u5e76\u70b9\u51fb\u8fdb\u5165\u767e\u5ea6\u6587\u5e93\uff0c\u5373\u53ef\u6b63\u5e38\u4e0b\u8f7d;</p>','<div class="wealth-5-container">','<a href="javascript:;" class="org-sure btn-gray btn-m">\u786e\u5b9a</a>','<a href="javascript:;" class="org-gr-download btn-green btn-m dialog-gray"><i class="btn-ico"></i><span>\u4f7f\u7528\u4e2a\u4eba\u8d26\u53f7\u4e0b\u8f7d</span></a>',"</div>","</div>",'<div class="dialog-bottom">','<p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"</div>","</div>"].join("");i=document.createElement("div"),i.id="WkDialogDownDoc",i.style.display="none",i.innerHTML=o,e.insertBefore(i,e.firstChild),t(i).after(s),t(i).addClass("hide"),t(i).addClass("WkDialogDownDoc"),this.el=i},vcodeOk:function(){t(".vcode-box .vcode-right").css("visibility","visible"),t(".vcode-box .error-tip").css("height","0px")},vcodeError:function(){t(".vcode-box .error-tip").css("height","16px"),t(".vcode-box .vcode-right").css("visibility","hidden")},vcodeImg:function(){var i=this;t.get("/vcode?t="+(new Date).getTime(),function(e){t(".vcode-box img").attr("src",e.imgurl),i.vcodeValue=e.vcode_str,window.postVcode=i.vcodeValue})},bindEvent:function(){var i=this;t(".close-btn").click(function(){i.close()}),t(".close-sure").click(function(){i.close()}),t(".org-sure").on("click",function(){i.close(),console.log("\u60a8\u70b9\u51fb\u4e86\u786e\u5b9a!")}),t(".error-sure").on("click",function(){location.reload(!0)})},bindDownLoadBtton:function(i){var e=this;t(".dialog-green").on("click",function(){e.close(),i()})},bindChangePerson:function(i){var e=this;t(".dialog-gray").on("click",function(){e.close(),i()})},setVcode:function(i){this.vcodeFlag=i},getVcode:function(){return this.vcodeFlag},setMessage:function(i){this.useMessageData=i},show:function(){var i=this,e=t(window).height(),s=t(document).scrollTop();t(this.el).css("display","block"),t(".dialog-container-iframe").css({display:"block",height:t("body").height()}),i.getVcode()&&t(".ticket-no-wealth-container").hasClass("hide")&&(i.vcodePass=!0,t(".vcode-box").show(),i.vcodeImg()),t("#WkDialogDownDoc").css("top",s+e/2-150),t("#doc_reader")&&!this.isChrome&&t("#doc_reader").css("visibility","hidden")},close:function(){t(this.el).css("display","none"),t(".dialog-container-iframe").css("display","none"),t("#doc_reader")&&t("#doc_reader").css("visibility","visible")},setContent:function(){},set0Msg:function(){t(this.el).find(".msg0").removeClass("hide"),t(this.el).find(".msg1").addClass("hide"),t(this.el).find(".msg2").addClass("hide"),t(this.el).find(".error-sure").removeClass("hide"),t(this.el).find(".dialog-green").addClass("hide"),t(this.el).find(".dialog-gray").addClass("hide")},set1Msg:function(i){t(this.el).find(".msg1").html(i)},set2Msg:function(i,e){t(this.el).find(".msg2").html(i),e&&t(this.el).find(".msg2").addClass(e)},set3Msg:function(i){t(this.el).find(".msg3").html(i).removeClass("hide")},setWarning:function(){t(this.el).find(".warning").removeClass("hide")},setBtnMsg:function(i){t(this.el).find(".dialog-down-load-btn").text(i),"\u5207\u6362\u81f3\u4e2a\u4eba\u8d26\u53f7\u4e0b\u8f7d"==i||"\u4f7f\u7528\u4e2a\u4eba\u8d26\u53f7\u8d2d\u4e70"==i?t(".dialog-green").addClass("hide"):"\u5173\u95ed"===i?(t(".dialog-green").addClass("hide"),t(".dialog-gray").addClass("hide"),t(".close-sure").show()):t(".dialog-gray").addClass("hide")},setBtnWay:function(i){t(".dialog-gray span").html(i)},setBottomMsg:function(i){t(this.el).find("#bottom-btn").text(i)},setWealth5:function(){t(".btn-green").addClass("hide")},reset:function(){t(this.el).remove(),t(".dialog-container-iframe").remove(),this.init()}},s.exports=o});
;define("wkview:widget/ui/dialog_down_doc/dialog_down_doc.js",function(e,t,i){function a(e){this.options=s.extend({doc_title:"",doc_size:"",content:"",resize:function(){},open:function(){},firstOpen:function(){},close:function(){}},e||{}),this.init()}var s=e("wkcommon:widget/ui/lib/jquery/jquery.js"),o=e("wkcommon:widget/lib/tangram/base/base.js"),n=e("wkcommon:widget/lib/fis/data/data.js"),c=e("wkcommon:widget/ui/js_core/log/log.js"),d=n.get("WkInfo"),l=(n.get("userFlowGroup"),e("wkview:widget/ui/file_downloader_ui/file_downloader_ui.js")),r=e("wkcommon:widget/ui/js_core/dialog/dialog.js"),u=function(){var e=null;return function(){return e||(e=r.dialogCreate()),e}}();a.prototype={init:function(){var e=this;e.vcodePass=!1,e.getVipInfo(),e.getIsVipDoc(),e.dialogAdWrap(),e.creat(),e.bindEvent(),this.isChrome=o.browser.chrome},initPublicTpl:function(){var e=this;e.publicTpl={dialogAdWrap:['<div class="dialog-ad '+e.diaolgAdWrap.className+'">','   <div class="dialog-ad-hd">'+e.diaolgAdWrap.hdTpl+"</div>"].join("")}},dialogAdWrap:function(){var e=n.get("mitidialogtitle")||"",t=n.get("mitidialogfontsize")||"";this.diaolgAdWrap={},this.diaolgAdWrap.className="dialog-ad-miti",this.diaolgAdWrap.hdTpl=['<span class="dialog-ad-logo"></span>','<h4 class="dialog-ad-title" style="font-size:'+t+'px">'+e+"</h4>",'<a target="_blank" href="http://wenku.baidu.com/miti" ','class="dialog-ad-more log-xsend" data-logxsend="[1, 100448]">',"\u514d\u8d39\u5b89\u88c5&gt;&gt;","</a>"].join(""),this.initPublicTpl()},getVipInfo:function(){var e=this;s.ajax({type:"get",async:!0,cache:!1,url:"/user/interface/getuserinfo",success:function(t){t&&0==t.status.code&&t.data.vipinfo.type>0&&(e.isVip=!0)}})},getIsVipDoc:function(){var e=this;void 0==n.get("VipFreeDoc")?s.ajax({type:"get",async:!0,cache:!1,url:"/user/interface/getvipfreedoc?doc_id="+d.DocInfo.docId,success:function(t){var i=!1;t&&0==t.status.code&&t.data.is_vip_free_doc&&(i=!0),n.set("VipFreeDoc",i),e.isVipDoc=i}}):n.get("VipFreeDoc")&&(e.isVipDoc=n.get("VipFreeDoc"))},getDate:function(){var e=new Date;return{day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear(),today:e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}},creat:function(){var e=null,t=document.body,i=o.string.getByteLength(d.DocInfo.title)<26?d.DocInfo.title:o.string.subByte(d.DocInfo.title,26,"..."),a='<iframe class="dialog-container-iframe" allowTransparency="true" src="" frameborder="0" scrolling="no"></iframe>';if(this.isVipDoc&&this.isVip){var l=[this.publicTpl.dialogAdWrap,'<div class="dialog-container vip-freedoc">','   <div class="close-btn"></div>','   <div class="dialog-top">','       <p class="doc-title">'+i+"</p>",'       <p class="doc-size">('+(d.DocInfo.size/1024+"").replace(/^(\d+\.\d)\d+$/,"$1")+"K)</p>","   </div>",'   <div class="dialog-inner">','       <div class="vip-freedoc-container">','           <p class="vip-freedoc-tips">\u672c\u6587\u4e3a\u6587\u5e93VIP\u514d\u8d39\u6587\u6863\uff0c\u60a8\u53ef\u76f4\u63a5\u4e0b\u8f7d</p>','           <a href="javascript:;" class="ui-bz-btn-senior btn-vip-freedoc-download"><b class="ui-bz-btn-p-40 ui-bz-btc">\u7acb\u5373\u4e0b\u8f7d</b></a>',"       </div>","   </div>",'   <div class="dialog-bottom">','       <p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"   </div>","</div>","</div>"].join("");c.xsend(1,100273)}else var l=[this.publicTpl.dialogAdWrap,'<div class="dialog-container">','   <div class="close-btn"></div>','   <div class="dialog-left-greenbar"></div>','   <div class="dialog-top">','       <p class="doc-title">'+i+"</p>",'       <p class="doc-size">('+(d.DocInfo.size/1024+"").replace(/^(\d+\.\d)\d+$/,"$1")+"K)</p>","   </div>",'   <div class="dialog-inner">','       <p class="ticket-num-msg msg1"></p>','       <p class="ticket-detail-msg msg2"></p>','       <div class="wealth-5-container hide">','           <a href="javascript:;" class="wealth-5-btn-use-down-load-ticket btn-gray btn-m">\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d</a>','           <a href="javascript:;" class="wealth-5-btn-use-free btn-green btn-m"><i class="btn-ico"></i><span>\u514d\u4e0b\u8f7d\u5238\u4e0b\u8f7d</span></a>',"       </div>",'<div class="ticket-no-wealth-container hide">','   <div class="ticket-btn-container ticket-btn-container-vip"><a href="javascript:;" class="btn-green btn-m ticket-exchange-btn">\u5151\u6362\u540e\u4e0b\u8f7d</a> <a href="javascript:;" class="btn-gray btn-m ticket-user-free-download-btn">\u514d\u4e0b\u8f7d\u5238\u4e0b\u8f7d</a></div>','   <div class="clear"></div>','   <div class="ticket-raido-container hidden">','       <div class="ticket-raido-bg">','                <span class="ticket-radio-tips">\u60a8\u5171\u6709<i>100</i>\u8d22\u5bcc\u503c\uff0c\u53ef\u5151\u6362\uff1a</span>',"                <ul>",'                    <li class="disable"><span class="sel-option" data-value="3"></span>3\u4e0b\u8f7d\u5238</li>','                    <li class="disable"><span class="sel-option" data-value="5"></span>5\u4e0b\u8f7d\u5238</li>','                    <li class="disable"><span class="sel-option" data-value="10"></span>10\u4e0b\u8f7d\u5238</li>','                    <li class="disable"><span class="sel-option" data-value="30"></span>30\u4e0b\u8f7d\u5238</li>','                    <li class="disable"><span class="sel-option" data-value="50"></span>50\u4e0b\u8f7d\u5238</li>','                    <li class="other"><span class="sel-option"></span><input type="text" placeholder="\u5176\u4ed6" class="other-input"/>\u4e0b\u8f7d\u5238</li>',"                </ul>",'                <div class="ticket-tips">','                   <div class="ticket-tips-item w6 ticket-num">\u5151\u6362\u540e\u83b7\u5f97\uff1a<em></em>\u4e0b\u8f7d\u5238<span class="ticket_gift_tips">+\u8d603\u4e0b\u8f7d\u5238</span></div><div class="ticket-tips-item w4">\u5171\u6d88\u8017\uff1a<em class="ticket-wealth"></em>\u8d22\u5bcc\u503c</div>','                   <div class="tikcet-tips-notice w4">\u4e0b\u8f7d\u5238\u6709\u6548\u671f\uff1a<em>30\u5929</em></div>',"                </div>","       </div>",'       <a class="btn-green btn-l ticket-exchange-download-btn ticket-exchange-download-btn-disable" href="javascript:;">\u5151\u6362\u5e76\u4e0b\u8f7d</a>',"   </div>","</div>",'<div class="vip-getback hide">','       <a href="javascript:;" class="ui-bz-btn-senior btn-vip-ticket-download"><b class="ui-bz-btn-p-16 ui-bz-btc">\u82b1\u8d39\u4e0b\u8f7d\u5238\u4e0b\u8f7d</b></a>\u3000','       <a href="###" class="ui-bz-btn"><b class="ui-bz-btn-p-16 ui-bz-btc">\u7eed\u8d39VIP<i>/\u8d605\u6b21\u4e0b\u8f7d\u7279\u6743</i></b></a>',"</div>",'<div class="user-dialog-download-btn-center hide"><a class="dialog-down-load-btn btn-green btn-l" href="javascript:void(0);">\u7eed\u8d39VIP</a><a class="btn-orange btn-l ml24" href="/user/mydocs?check_new_user_gift=1"><b class="gift-icon"></b>\u9886\u53d6\u65b0\u624b\u793c\u5305</a></div>','<div class="dialog-down-load-btn-center"><a class="dialog-down-load-btn btn-green btn-l" href="javascript:void(0);">\u7eed\u8d39VIP</a></div>','<div class="vcode-box vcode-disable">','<input type="text" class="vcode-ipt" />','<img src="" />','<span class="vcode-change">\u6362\u4e00\u6362</span>','<b class="vcode-right"></b>','<p class="error-tip"><b class="vcode-error"></b><span>\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801\uff01</span></p>',"</div>",'<div class="download-btn-others">',function(){var e=n.get("WkInfo").DocInfo.docId;return'<a href="/cashier/browse/dispatch?doc_id='+e+'" target="_blank" class="download-btn-tip">'}(),"\u7eed\u8d393\u6708\u5373\u9001\u4e0b\u8f7d\u7279\u6743","</a>","</div>","</div>",'<div class="dialog-bottom">','<p id="bottom-btn" class="bottom-btn">\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d</p>','<p id="price10-bottom-btn" class="price10-bottom-btn hide" style="text-decoration: none;">\u7531\u4e8e\u6587\u6863\u4ef7\u683c\u8f83\u9ad8\uff0c\u5efa\u8bae\u60a8\u4f7f\u7528<span style="text-decoration: underline; color: #139f72;">\u4e0b\u8f7d\u7279\u6743</span>\u4e0b\u8f7d</p>','<p class="bottom-msg">\u56e0\u672c\u6b21\u4e0b\u8f7d\u800c\u4ea7\u751f\u7684\u8d22\u5bcc\u5c06\u7531\u767e\u5ea6\u6587\u5e93\u4ee5\u4e00\u5b9a\u65b9\u5f0f\u8f6c\u4ea4\u7248\u6743\u4eba</p>',"</div>","</div>","</div>"].join("");e=document.createElement("div"),e.id="WkDialogDownDoc",e.style.display="none",e.innerHTML=l,t.insertBefore(e,t.firstChild),s(e).after(a),s(e).addClass("hide"),this.el=e},setIsVipBackBtn:function(){s(".dialog-down-load-btn-center").hide(),s(".download-btn-others").hide(),s(".vip-getback").show()},setNewUserGift:function(){s(".dialog-down-load-btn-center").hide(),s(".user-dialog-download-btn-center").show()},vcodeOk:function(){s(".vcode-box .vcode-right").css("visibility","visible"),s(".vcode-box .error-tip").css("height","0px")},vcodeError:function(){s(".vcode-box .error-tip").css("height","16px"),s(".vcode-box .vcode-right").css("visibility","hidden")},vcodeImg:function(){var e=this;s.get("/vcode?t="+(new Date).getTime(),function(t){s(".vcode-box img").attr("src",t.imgurl),e.vcodeValue=t.vcode_str,window.postVcode=e.vcodeValue})},bindEvent:function(){var e=this;s(".close-btn").click(function(){e.close()}),s(".vcode-change").on("click",function(){e.vcodeImg()}),s(".vcode-ipt").on("input propertychange",function(){if(s(this).val().length>5)e.vcodeError();else if(4==s(this).val().length){var t=s(this).val();s.get("/user/interface/vcodefordownload?m=check&&v_code="+e.vcodeValue+"&v_input="+t+"&t="+(new Date).getTime(),function(i){i.errno?e.vcodeError():(e.vcodeOk(),e.vcodePass=!1,window.postVcode=e.vcodeValue,window.postVinput=t)})}else s(".vcode-box .vcode-right").css("visibility","hidden"),s(".vcode-box .error-tip").css("height","0px")}),document.downloadForm.storage.value=1,document.downloadForm.useTicket.value=0,s(".dialog-down-load-btn").click(function(){if(e.vcodePass)return e.vcodeError(),!1;var t=s(this).text();if("\u7acb\u5373\u4e0b\u8f7d"==t||"\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d"==t)document.downloadForm.useTicket.value="\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d"==t?1:0,e.close(),o.lang.eventCenter.dispatchEvent("download.toGetFile"),c.xsend(1,100036);else if("VIP\u514d\u4e0b\u8f7d\u5238\u4e0b\u8f7d"==t){var i=n.get("isDownloadTongJi");switch(i){case 0:i="31_8_13_15";break;case 1:i="31_8_13_16";break;case 2:i="31_8_13_17"}var a=n.get("WkInfo").DocInfo.docId;window.open("/cashier/browse/dispatch?doc_id="+a+"&dqStatCode="+i)}else if("\u7f34\u8d39VIP"==t){var a=n.get("WkInfo").DocInfo.docId;window.open("/cashier/browse/dispatch?doc_id="+a)}else if("\u7eed\u8d39VIP"==t){var d="";d="\u60a8\u5269\u4f59\u4e0b\u8f7d\u7279\u6743\uff1a0"==s(e.el).find(".msg1").text()?"11021007":"11021005";var a=n.get("WkInfo").DocInfo.docId;window.open("/cashier/browse/dispatch?doc_id="+a)}else"VIP\u793c\u5305\u8d60\u7279\u6743"==t&&window.open("http://yuedu.baidu.com/coupon/browse/buydownloadticket?dqStatCode=31_23_38_39&from_doc="+n.get("WkInfo").DocInfo.docId)}),s(".ticket-exchange-download-btn").on("click",function(){return e.vcodePass?(e.vcodeError(),!1):void(s(this).hasClass("ticket-exchange-download-btn-disable")||(document.downloadForm.useTicket.value=0,e.close(),o.lang.eventCenter.dispatchEvent("download.toGetFile"),c.xsend(1,100036)))}),s(".wealth-5-btn-use-down-load-ticket").click(function(){e.close(),document.downloadForm.useTicket.value=0,o.lang.eventCenter.dispatchEvent("download.toGetFile")}),s(".wealth-5-btn-use-free").click(function(){var e=n.get("WkInfo").DocInfo.docId;window.open("/cashier/browse/dispatch?doc_id="+e+"&dqStatCode=31_8_13_19")}),s(".ticket-user-free-download-btn").click(function(){var e=n.get("WkInfo").DocInfo.docId;window.open("/cashier/browse/dispatch?doc_id="+e+"&dqStatCode=31_8_13_16")}),s("#price10-bottom-btn").click(function(){var e=n.get("WkInfo").DocInfo.docId;window.open("/cashier/browse/dispatch?doc_id="+e+"&dqStatCode=31_8_13_18")}),s(".bottom-btn").click(function(){var t=s(this).text();if("\u505a\u4efb\u52a1\u8d5a\u53d6\u8d22\u5bcc\u503c\u548c\u4e0b\u8f7d\u5238"==t)window.open("http://wenku.baidu.com/task/browse/reward");else if("\u52a0\u5165\u6587\u5e93VIP,\u514d\u8d39\u4e0b\u8f7d\u6587\u6863,\u8fd8\u6709\u66f4\u591aVIP\u7279\u6743"==t){var i=n.get("WkInfo").DocInfo.docId;window.open("/cashier/browse/dispatch?doc_id="+i+"&dqStatCode=31_8_13_14")}else"\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d"==t?(o.lang.eventCenter.dispatchEvent("download.toUseU"),e.changeUseU()):"\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d"==t&&(o.lang.eventCenter.dispatchEvent("download.toUseT"),e.changeUseT())}),s(".btn-vip-freedoc-download").on("click",function(){return e.vcodePass?(e.vcodeError(),!1):(u().confirm({title:"\u4e0b\u8f7d\u6587\u6863",content:'<iframe width="460" height="220" name="runDown" frameborder="0"></iframe>',width:500,height:220,onRendered:function(){document.downloadForm.useTicket.value=0,document.downloadForm.req_vip_free_doc.value=1,e.close();var t=(d.DocInfo.size/1024+"").replace(/^(\d+\.\d)\d+$/,"$1");if(l.isSupport(t)){var i={},a=s(document.downloadForm);s.each(a.serializeArray(),function(e,t){i[t.name]=t.value}),i.v_code=window.postVcode||0,i.v_input=window.postVinput||0,i.method="async",s.post(a.attr("action"),i,function(i){l.download({url:i.url,title:e.WkInfo.DocInfo.title,fileSize:t,fileType:docType})},"json")}else{var n=window.postVcode||0,r=window.postVinput||0;s(document.downloadForm).find("input[name=v_code]").val(n),s(document.downloadForm).find("input[name=v_input]").val(r),o.lang.eventCenter.dispatchEvent("download.realStart"),document.downloadForm.submit()}c.xsend(1,100274)}}),void u().hide())}),s(".ticket-exchange-btn").on("click",function(){s(".ticket-btn-container").addClass("hidden"),s(".ticket-raido-container").removeClass("hidden"),c.xsend(1,100194,{isVip:e.useMessageData.isvip}),e.getVcode()&&(e.vcodePass=!0,s(".vcode-box").show(),e.vcodeImg())})},setVcode:function(e){this.vcodeFlag=e},getVcode:function(){return this.vcodeFlag},changeUseU:function(){var e=this;if(e.useMessageData.needUticket<=e.useMessageData.UticketCount)return e.set1Msg("\u6240\u9700\u4e0b\u8f7d\u5238\uff1a"+e.useMessageData.needUticket),e.set2Msg("\u60a8\u6301\u6709\u7684\u4e0b\u8f7d\u5238\uff1a"+e.useMessageData.UticketCount),e.setBtnMsg("\u7acb\u5373\u4e0b\u8f7d"),e.setBottomMsg("\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d"),void c.xsend(1,100118);if(e.useMessageData.UticketCount<e.useMessageData.needUticket&&e.useMessageData.canUticket+e.useMessageData.UticketCount>=e.useMessageData.needUticket){var t=e.useMessageData.needUticket-e.useMessageData.UticketCount;return e.set1Msg("\u6240\u9700\u4e0b\u8f7d\u5238\uff1a"+e.useMessageData.needUticket),e.set2Msg("\u60a8\u6301\u6709"+e.useMessageData.UticketCount+"\u4e0b\u8f7d\u5238,\u53ef\u7528"+t*e.useMessageData.exchangeRate+"\u8d22\u5bcc\u503c\u5151\u6362"+t+"\u4e0b\u8f7d\u5238"),e.setBottomMsg("\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d"),e.batchDownloadDoc({UticketCount:e.useMessageData.UticketCount,needUticket:e.useMessageData.needUticket,wealth:e.useMessageData.wealth,exchangeRate:e.useMessageData.exchangeRate,canUticket:e.useMessageData.canUticket,NTicket:t}),e.setBatchDownloadDoc(),void c.xsend(1,100193,{isVip:e.useMessageData.isvip})}return e.useMessageData.ticketCount>0&&e.useMessageData.UticketCount<e.useMessageData.needUticket&&e.useMessageData.canUticket+e.useMessageData.UticketCount<e.useMessageData.needUticket?(e.set1Msg("\u6240\u9700\u4e0b\u8f7d\u5238\uff1a"+e.useMessageData.needUticket),e.set2Msg("\u60a8\u6301\u6709"+e.useMessageData.UticketCount+"\u4e0b\u8f7d\u5238\uff0c\u8d22\u5bcc\u503c\u4e0d\u8db3\uff0c\u65e0\u6cd5\u5151\u6362\u4e0b\u8f7d\u5238"),e.setBtnMsg("\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d"),e.setBottomMsg("\u505a\u4efb\u52a1\u8d5a\u53d6\u8d22\u5bcc\u503c\u548c\u4e0b\u8f7d\u5238"),void c.xsend(1,100120)):e.useMessageData.UticketCount<e.useMessageData.needUticket&&e.useMessageData.canUticket+e.useMessageData.UticketCount<e.useMessageData.needUticket?(e.set1Msg("\u6240\u9700\u4e0b\u8f7d\u5238\uff1a"+e.useMessageData.needUticket),e.set2Msg("\u60a8\u6301\u6709"+e.useMessageData.UticketCount+"\u4e0b\u8f7d\u5238\uff0c\u8d22\u5bcc\u503c\u4e0d\u8db3\uff0c\u65e0\u6cd5\u5151\u6362\u4e0b\u8f7d\u5238"),e.setBtnMsg("VIP\u793c\u5305\u8d60\u7279\u6743"),e.setBottomMsg("\u505a\u4efb\u52a1\u8d5a\u53d6\u8d22\u5bcc\u503c\u548c\u4e0b\u8f7d\u5238"),void c.xsend(1,100121)):void 0},changeUseT:function(){var e=this;e.useMessageData.ticketCount>1&&(e.set1Msg("\u60a8\u5269\u4f59\u4e0b\u8f7d\u7279\u6743\uff1a"+e.useMessageData.ticketCount),e.set2Msg(""),e.setBtnMsg("\u4f7f\u7528\u4e0b\u8f7d\u7279\u6743\u4e0b\u8f7d"),e.setBottomMsg("\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d"),c.xsend(1,100122)),e.useMessageData.ticketCount<1&&(e.set1Msg("\u60a8\u5269\u4f59\u4e0b\u8f7d\u7279\u6743\uff1a0"),e.set2Msg(""),e.setBtnMsg("VIP\u793c\u5305\u8d60\u7279\u6743"),e.setBottomMsg("\u4f7f\u7528\u4e0b\u8f7d\u5238\u4e0b\u8f7d"),c.xsend(1,100123)),e.closeBatchDownloadDoc()},setMessage:function(e){this.useMessageData=e},show:function(){var e=this,t=s(window).height(),i=s(document).scrollTop();s(this.el).css("display","block"),s(".dialog-container-iframe").css({display:"block",height:s("body").height()}),e.getVcode()&&s(".ticket-no-wealth-container").hasClass("hide")&&(e.vcodePass=!0,s(".vcode-box").show(),e.vcodeImg()),s("#WkDialogDownDoc").css("top",i+t/2-150),s("#doc_reader")&&!this.isChrome&&s("#doc_reader").css("visibility","hidden")},close:function(){s(this.el).css("display","none"),s(".dialog-container-iframe").css("display","none"),s("#doc_reader")&&s("#doc_reader").css("visibility","visible")},setContent:function(){},set1Msg:function(e){s(this.el).find(".msg1").html(e)},set2Msg:function(e){s(this.el).find(".msg2").html(e)},setBtnMsg:function(e){s(this.el).find(".dialog-down-load-btn").text(e),"\u7f34\u8d39VIP"==e||"\u7eed\u8d39VIP"==e?s(".download-btn-tip").css("visibility","visible"):s(".download-btn-tip").css("visibility","hidden")},setBottomMsg:function(e){s(this.el).find("#bottom-btn").text(e)},setWealth5:function(){s(".dialog-down-load-btn-center").addClass("hide"),s(".download-btn-others").addClass("hide"),s(".wealth-5-container").removeClass("hide")},setPrice10:function(){s(this.el).find(".bottom-btn").addClass("hide");var e=s(this.el).find("#price10-bottom-btn");s(e).removeClass("hide")},setBatchDownloadDoc:function(){s(".dialog-down-load-btn-center").add(s(".download-btn-others")).addClass("hide"),s(".ticket-no-wealth-container").removeClass("hide")},closeBatchDownloadDoc:function(){s(".dialog-down-load-btn-center").add(s(".download-btn-others")).removeClass("hide"),s(".ticket-no-wealth-container").addClass("hide")},batchDownloadDoc:function(e){var t=s(this.el).find(".ticket-raido-container ul"),i=s(this.el).find(".ticket-num"),a=s(this.el).find(".ticket-wealth"),o=(s(this.el).find(".ticket_gift_tips"),s(this.el).find(".other-input")),n=s(this.el).find(".ticket-tips"),d=0,l=s(this.el).find(".ticket-exchange-download-btn"),r=this,u=[3,5,10,30,50];this.timer=null,e&&e.wealth&&s(this.el).find(".ticket-radio-tips i").html(e.wealth);for(var g=0,v=u.length;v>g;g++)e.canUticket>=u[g]&&t.find('[data-value="'+u[g]+'"]').parent().removeClass("disable");var p=t.find("li:not(.disable)"),h=p.find(".sel-option"),f=function(){h.on("click",function(){if(h.removeClass("sel-option-cur"),s(this).addClass("sel-option-cur"),s(this).parent().hasClass("other")){var t=0;r.timer=setInterval(function(){return o.prev(".sel-option").hasClass("sel-option-cur")?(t=o.val()||0,void(!isNaN(t)&&b(t)&&w(t)&&m(t))):void clearInterval(r.timer)},300),c.xsend(1,100196,{data:0})}else{var i=+s(this).attr("data-value");switch(clearInterval(r.timer),w(i)&&(m(i),b(i)),i){case 3:c.xsend(1,100196,{data:1,isVip:e.isvip});break;case 5:c.xsend(1,100196,{data:2,isVip:e.isvip});break;case 10:c.xsend(1,100196,{data:3,isVip:e.isvip});break;case 30:c.xsend(1,100196,{data:4,isVip:e.isvip});break;case 50:c.xsend(1,100196,{data:5,isVip:e.isvip})}}}),o.on("keyup",function(){this.value=this.value.replace(/\D/g,"")}).on("focus",function(){s(this).prev(".sel-option").trigger("click")}).on("focusout",function(){clearInterval(r.timer)})},b=function(t){var s=0;return t>e.canUticket?(n.addClass("ticket-tips-wrong"),i.html("\u8d22\u5bcc\u503c\u4e0d\u8db3\uff0c\u8bf7\u51cf\u5c11\u60a8\u5151\u6362\u7684\u4e0b\u8f7d\u5238\u603b\u91cf\u3002")):t>1e3?(n.addClass("ticket-tips-wrong"),i.html("\u522b\u592a\u8d2a\u5fc3\u54e6\uff0c\u5355\u6b21\u5151\u6362\u91cf\u8bf7\u52ff\u8d85\u8fc71000\u4e0b\u8f7d\u5238\u3002")):(n.removeClass("ticket-tips-wrong"),t>=50&&(s=5),50>t&&t>=30&&(s=3),i.html(s>0?"\u5151\u6362\u540e\u83b7\u5f97\uff1a<em>"+t+'</em>\u4e0b\u8f7d\u5238<span class="ticket_gift_tips">+\u8d60'+s+"\u4e0b\u8f7d\u5238</span>":"\u5151\u6362\u540e\u83b7\u5f97\uff1a<em>"+t+"</em>\u4e0b\u8f7d\u5238"),a.html(e.exchangeRate*t)),!0},k=function(){return l.removeClass("ticket-exchange-download-btn-disable"),e.canUticket>=50&&e.NTicket<=50?(t.find('[data-value="50"]').trigger("click"),void m(50)):e.canUticket>=30&&e.NTicket<=30?(t.find('[data-value="30"]').trigger("click"),void m(30)):e.canUticket>=10&&e.NTicket<=10?(t.find('[data-value="10"]').trigger("click"),void m(10)):e.canUticket>=5&&e.NTicket<=5?(t.find('[data-value="5"]').trigger("click"),void m(5)):e.canUticket>=3&&e.NTicket<=3?(t.find('[data-value="3"]').trigger("click"),void m(3)):(e.NTicket>0&&(t.find(".other .sel-option").trigger("click"),o.val(e.NTicket),m(e.NTicket)),e.NTicket>e.canUticket&&l.addClass("ticket-exchange-download-btn-disable"),s(".ticket-btn-container").removeClass("hidden"),void s(".ticket-raido-container").addClass("hidden"))},w=function(t){return t=+t,t&&!(t>e.canUticket||0==t||t>1e3||t+e.UticketCount<e.needUticket)?(l.removeClass("ticket-exchange-download-btn-disable"),!0):(l.addClass("ticket-exchange-download-btn-disable"),!1)},m=function(e){d=e,s('input[name="target_uticket_num"]').val(d)},D=function(){f(),k(),r.setBatchDownloadDoc()};D()},reset:function(){s(this.el).remove(),s(".dialog-container-iframe").remove(),this.init()}},i.exports=a});
;define("wkview:widget/pay/tousu/tousu.js",function(t){var o,e=t("wkcommon:widget/lib/tangram/base/base.js"),i=t("wkcommon:widget/ui/js_core/_dialog/_dialog.js"),u=t("wkcommon:widget/ui/js_core/login/login.js").login,n=function(t,o,i){var u=e.dom,n=u.addClass,s=u.removeClass,l=["alert","hint","ok"],r=0,a=l.length;for(i=i||"alert";a>r;r+=1)s(t,l[r]);n(t,i),(t=e.g(t))&&(t.innerHTML=o)},s=function(){var t=/^(https?\:\/\/)?wenku.baidu.com\/view\/\w{24}(.html)?(\?.*|$)/.test(e.g("tousu-url").value);return n("tousu-url-tip",t?"":"\u8bf7\u68c0\u67e5\u7f51\u5740\u662f\u5426\u6709\u8bef"),t},l=function(){var t=!!e.string.trim(e.g("tousu-describe").value).length;return n("tousu-describe-tip",t?"":"\u63cf\u8ff0\u4e0d\u80fd\u4e3a\u7a7a\u54e6~"),t},r=function(){return/^[\d-]*$/.test(e.g("tousu-tel")).value},a=function(){var t,o,u,n=e.g("tousu-iframe"),s=180;switch(n&&n.contentWindow.document?(o=n.contentWindow.document.getElementById("result-no"),t=o?+o.innerHTML:-1):t=-1,t){case 0:u=['<div id="tousu-result">','<div class="success-tip">',"<p>\u60a8\u7684\u6295\u8bc9\u5df2\u6536\u5230\uff0c\u6211\u4eec\u4f1a\u5c3d\u5feb\u8fdb\u884c\u6838\u5b9e\u5904\u7406\u3002\u8bf7\u60a8\u5173\u6ce8\u9875\u9762\u53f3\u4e0a\u65b9\u7684\u6587\u5e93\u6d88\u606f\u3002</p>","</div>","</div>"].join(""),s=200;break;case 1:u=['<div id="tousu-result">','<div class="failed-tip">\u63d0\u4ea4\u5931\u8d25\uff0c\u8bf7\u5148\u767b\u5f55\uff01</div>',"</div>"].join("");break;case 2:default:u=['<div id="tousu-result">','<div class="failed-tip">\u63d0\u4ea4\u5931\u8d25\uff0c\u7cfb\u7edf\u9519\u8bef\uff01</div>',"</div>"].join("")}i.dialogCreate({innerId:"tousu-result-dialog",title:"\u63d0\u793a",width:425,height:s,content:u,buttons:['<div class="result-dialog-footer">','<a href="###" class="result-dialog-close dialog-close">\u5173\u95ed</a>',"</div>"].join("")})};e.on("tousu-btn","click",function(t){u.verlogin(function(){o?(o.show(),o.center()):(o=i.confirm({width:560,height:520,innerId:"pay-tousu-dialog",title:"\u8bf7\u63cf\u8ff0\u60a8\u9047\u5230\u7684\u95ee\u9898\uff0c\u6211\u4eec\u5c06\u4f1a\u5c3d\u5feb\u7ed9\u60a8\u56de\u590d\u3002",content:e.g("tpl-tousu-form").value,onHideAfter:function(){e.g("tousu-form").reset()},onCloseBefore:function(t){this.stop(t),this.hide()},onConfirmBefore:function(t){return s()&l()?(e.g("tousu-describe").value=encodeURIComponent(e.g("tousu-describe").value),void e.g("tousu-form").submit()):void this.stop(t)}}),e.on("tousu-url","blur",s),e.on("tousu-describe","blur",l),e.on("tousu-tel-tip","blur",r),e.on("tousu-upload-btn","change",function(){var t=this.value;return t.length?/\.(png|gif|jpg|jpeg)$/i.test(t)?(n("tousu-upload-tip",t.split(/\\|\//).pop(),"ok"),!0):(n("tousu-upload-tip","\u8bf7\u9009\u62e9\u683c\u5f0f\u5408\u6cd5\u7684\u56fe\u7247","alert"),this.value="",!1):!0}))},null,null,{},!1);var d=e.g("tousu-iframe");d&&(d.attachEvent?d.attachEvent("onload",function(){a()}):d.onload=function(){a()}),e.event.stop(t)})});
;define("wkview:widget/comment/js/model/star.js",function(e,t,s){var i=(e("wkcommon:widget/ui/lib/jquery/jquery.js"),e("wkview:widget/ui/underscore/underscore.js"),e("wkcommon:widget/lib/fis/data/data.js")),r=e("wkcommon:widget/ui/js_core/log/log.js"),a=e("wkview:widget/ui/backbone/backbone.js"),o=a.Model.extend({url:"/doc/submit/value",saved:!1,defaults:{doc_id:null,value_score:0,ct:"20009"},initialize:function(){var e=i.get("WkInfo")||{},t=e.DocInfo&&e.DocInfo.docId;this.set({doc_id:t})},starChange:function(e){this.set({value_score:e.changed.star});var t=(this.get("star"),this);this.saved||this.save({},{success:function(e,s){var i;switch(+s.errno){case 0:t.trigger("star-success"),r.xsend(1,100030);break;case 45:i="\u4e0d\u80fd\u8bc4\u4ef7\u81ea\u5df2\u7684\u6587\u6863\uff01";break;case 6:i="\u60a8\u4e4b\u524d\u5df2\u7ecf\u8bc4\u4ef7\u8fc7\u4e86\uff01";break;case 4:i="\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\uff01";break;case 5:i="\u4f11\u606f\u4e00\u4e0b\u518d\u8bc4\u4ef7\u5427\uff01";break;default:i="\u7cfb\u7edf\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01"}t.saved=!0,t.trigger("star-error",{tip:i})}})},idAttribute:"doc_id"});s.exports.getStarModel=function(){var e;return function(){return e?e:e=new o}}()});
;define("wkview:widget/comment/js/view/commentItem.js",function(e,t,n){var i=e("wkcommon:widget/ui/lib/jquery/jquery.js"),m=e("wkview:widget/ui/underscore/underscore.js"),o=e("wkview:widget/ui/backbone/backbone.js"),l=o.View.extend({tagName:"li",className:"ct-item",template:m.template(i("#comment-item-tpl").html()),events:{},initialize:function(e){i.extend(this,e||{});this.listenTo(this.model,"all",function(e){console.log("comment event: "+e)}),this.listenTo(this.model,"change:content",i.proxy(this.render,this))},render:function(){var e={};if(i.extend(e,this.model.attributes),e.oInfo.org_name){var t=e.oInfo;e.url="/org/view?org="+t.eng_name,e.tname=t.org_name}else e.title?(e.url="/p/"+e.uname,e.tname=e.tname,e.field&&8==e.v_type&&(e.title=e.field+" "+e.title)):(e.url="/u/"+e.uname+"?from=wenku",e.tname=e.uname);return i(this.el).html(this.template(e)),this}});n.exports=l});
;define("wkview:widget/comment/js/model/comment.js",function(e,t,i){var a=(e("wkcommon:widget/ui/lib/jquery/jquery.js"),e("wkcommon:widget/ui/lib/date/date.js").format),n=(e("wkview:widget/ui/underscore/underscore.js"),e("wkcommon:widget/lib/fis/data/data.js")),r=(e("wkview:widget/comment/js/model/star.js").getStarModel(),e("wkview:widget/ui/backbone/backbone.js")),d=n.get("WkInfo")||{},o=d&&d.DocInfo,c=r.Model.extend({url:"/browse/interface/addcomment",defaults:{errno:0,parentid:"",uname:"",avatar:"",star:0,content:"",create_time:"",reply_count:0,title:""},initialize:function(){this.set({docid:o.docId})},parse:function(e){var e=e,t=e.uInfo,i=e.vInfo,n=e.oInfo,r={},d=e.errno||0;return 0==d&&(r={errno:d,reply_id:e.reply_id,parentid:e.parent_id,star:e.reserved1,content:e.content,create_time:a(new Date(1e3*e.create_time),"yyyy-MM-dd"),reply_count:e.reply_count||0,uname:t.uname,tname:i.tname,avatar:n.avatarSmall||i.avatarSmall||t.avatarSmall||t.headicon,title:i.title||"",field:i.field||"",v_type:i.verify_type||0,oInfo:n,is_uid_admin:e.is_uid_admin||0}),r},clear:function(){var e=this.get("docid"),t=this.get("reply_id");this.destroy({url:"/browse/interface/delcomment",data:{docid:e,commentid:t}})},idAttribute:"reply_id"});i.exports=c});
;define("wkview:widget/comment/js/collections/commentList.js",function(e,n,t){var o=e("wkcommon:widget/ui/lib/jquery/jquery.js"),i=(e("wkcommon:widget/ui/lib/date/date.js"),e("wkview:widget/ui/underscore/underscore.js"),e("wkview:widget/ui/backbone/backbone.js")),r=e("wkcommon:widget/lib/fis/data/data.js"),a=e("wkview:widget/comment/js/model/comment.js"),m=e("wkcommon:widget/lib/tangram/base/base.js"),s=r.get("WkInfo")||{},c=s&&s.DocInfo,u=i.Collection.extend({model:a,url:"/browse/interface/getcomment",initialize:function(e){o.extend(this,e||{})},parse:function(e){var n=[],t=e.commentList||[];if(0==e.errno)for(var o=0,i=t.length;i>o;o++){{var r=t[o];r.uInfo,r.vInfo}n.push({reply_id:r.reply_id,parent_id:r.parent_id,uInfo:r.uInfo,vInfo:r.vInfo,oInfo:r.oInfo,reserved1:r.reserved1,content:r.content,create_time:r.create_time,reply_count:r.reply_count,is_uid_admin:r.is_uid_admin})}return n},resetModels:function(e){var n=this;this.fetch({data:{parentid:this.pid||0,docid:c.docId,pn:e||1},success:function(e,t){n.trigger("resetModels",t),m.lang.eventCenter.dispatchEvent("getcomments.response",t)},error:function(){}})},getCommentList:function(){var e=[];return o.each(this.models,function(n,t){var i={};if(o.extend(i,t.attributes),console.log(i),i.uname=i.uname.replace(/"/g,"&quot;"),i.uname=i.uname.replace(/</g,"&lt;"),i.uname=i.uname.replace(/>/g,"&gt;"),i.oInfo.org_name){var r=i.oInfo;i.url="/org/view?org="+r.eng_name,i.tname=r.org_name}else i.title?(i.url="/p/"+i.uname,i.tname=i.tname,i.field&&8==i.v_type&&(i.title=i.field+" "+i.title)):(i.url="/u/"+i.uname+"?from=wenku",i.tname=i.uname);e.push(i)}),e}});t.exports=u});
;define("wkview:widget/comment/js/view/commentApp.js",function(t,e,i){var n=t("wkcommon:widget/ui/lib/jquery/jquery.js"),o=(t("wkcommon:widget/ui/lib/date/date.js"),t("wkcommon:widget/ui/js_core/_dialog/_dialog.js")),r=t("wkcommon:widget/ui/js_core/pager/pager.js").pagerCreate,s=(t("wkcommon:widget/ui/lib/string/string.js"),t("wkview:widget/comment/js/model/star.js").getStarModel()),a=t("wkcommon:widget/ui/js_core/login/login.js").login,l=t("wkcommon:widget/ui/js_core/log/log.js"),c=t("wkview:widget/ui/underscore/underscore.js"),m=t("wkview:widget/ui/backbone/backbone.js"),h=t("wkcommon:widget/lib/tangram/base/base.js"),p=t("wkview:widget/comment/js/view/commentItem.js"),d=t("wkview:widget/comment/js/collections/commentList.js"),g=["","\u5f88\u5dee","\u8f83\u5dee","\u8fd8\u884c","\u63a8\u8350","\u529b\u8350"],u={MAX_LENGTH:240,notEmpty:"*\u8bc4\u8bba\u4e0d\u80fd\u4e3a\u7a7a",tooLarge:"*\u8bc4\u8bba\u5df2\u8d85240\u5b57\u9650\u5236",notStar:"*\u611f\u8c22\u652f\u6301\uff0c\u7ed9\u6587\u6863\u8bc4\u4e2a\u661f\u5427\uff01",emptyVcode:"*\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",serverErrorTip:{3:"*\u4ed8\u8d39\u6587\u6863\u8d2d\u4e70\u540e\u53ef\u8bc4\u8bba\uff01",4:"*\u8bc4\u8bba\u5df2\u8d85240\u5b57\u9650\u5236",6:"*\u5bf9\u4e0d\u8d77\uff0c\u60a8\u662f\u53d7\u9650\u7528\u6237\uff08\u88ab\u5c01\u7981\u6216\u7528\u6237\u540d\u4e3a\u7a7a\uff09\uff0c\u65e0\u6cd5\u8bc4\u8bba",7:"*\u4e0d\u80fd\u8bc4\u8bba\u81ea\u5df1\u7684\u6587\u6863",5:"*\u8bc4\u8bba\u5185\u5bb9\u6d89\u5acc\u654f\u611f\u4fe1\u606f\uff0c\u8bf7\u4fee\u6539\u540e\u53d1\u5e03",40:"*\u8bc4\u8bba\u5185\u5bb9\u6d89\u5acc\u654f\u611f\u4fe1\u606f\uff0c\u8bf7\u4fee\u6539\u540e\u53d1\u5e03",8:"*\u8bc4\u8bba\u6b21\u6570\u5df2\u8d85\u9650\uff0c\u8bf7\u660e\u5929\u518d\u6765\u5427\uff0c\u8c22\u8c22\uff01",41:"*\u8bc4\u8bba\u64cd\u4f5c\u8fc7\u4e8e\u9891\u7e41\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01",42:"*\u4f11\u606f\u4e00\u4e0b\uff0c\u6bcf\u65e5\u9650\u91cf\u53d1\u5e03\u8bc4\u8bba\u54df\uff01",43:"*\u8fd9\u7bc7\u6587\u6863\u60a8\u5df2\u8bc4\u4ef7\u8fc7\u76f8\u540c\u5185\u5bb9\u5566\uff01",systemError:"*\u7cfb\u7edf\u9519\u8bef\uff0c\u7a0d\u540e\u518d\u8bd5"}},f=function(){var t={sel_captcha:"#captcha",sel_code:"#v_code",sel_input:"#v_input",sel_change:".change-captcha"},e={set:function(i,n){return t[i]=n,e},get:function(e){return t[e]},get_captcha:function(){n(t.sel_captcha).parent().css({display:"inline-block","float":"right"}),n.get("/vcode?t="+Math.random(),function(e){n(t.sel_captcha).attr("src",e.imgurl),n(t.sel_code).val(e.vcode_str),n(t.sel_input).val("")})}};return n(document).on("click",t.sel_change,e.get_captcha),e},y=m.View.extend({el:"#doc-comment",events:{"keyup .post-comment-ipt":"updateRemainLength","propertychange .post-comment-ipt":"updateRemainLength","input .post-comment-ipt":"updateRemainLength","click .post-comment-btn":"createComment","click .reply-btn":"toogleReply","keypress .post-reply-ipt":"createReplyOnEnter","click .post-reply-btn":"createReply","click .delete-btn":"deleteAct","focus .post-comment-ipt":"highlightIpt","blur .post-comment-ipt":"cancelHighlightIpt","focus .post-reply-ipt":"highlightIpt","blur .post-reply-ipt":"cancelHighlightIpt"},initialize:function(t){n.extend(this,t||{}),this.$starEl=n(".star-act"),this.$addCmtEl=n(".add-ct-wrap"),this.$addCmtBtn=n(".post-comment-btn"),this.commentStar=0,this.initStar(),this.commentList=new d,this.commentList.resetModels(),this.listenTo(this.commentList,"all",function(){}),this.commentList.on("change:reply_id",n.proxy(this.addOneComment,this)),this.commentList.on("resetModels",n.proxy(this.renderCommentList,this)),this.commentList.on("remove",n.proxy(this.removeItem,this))},vcode:new f,initStar:function(){var t=this,e=null,i=n(this.el).find("span.tip"),o=this.$starEl.find(".value-star");o.each(function(o,r){var a=n(r);a.hover(function(){e&&clearTimeout(e),i.hide(),!t.commentStar&&t.setStar(o+1)},function(){!t.commentStar&&(e=setTimeout(function(){t.setStar(0)},50))}),a.click(function(){t.commentStar||(t.commentStar=o+1,s.starChange({changed:{star:t.commentStar}}),t.setStar(t.commentStar))})})},setStar:function(t){var e=this.$starEl.find(".value-star"),i=this.$starEl.siblings(".f-star");e.each(function(e,i){t>e?n(i).removeClass("ic-star-off").addClass("ic-star-on"):n(i).addClass("ic-star-off").removeClass("ic-star-on")}),i.html(g[t])},resetStar:function(){this.commentStar=0,this.setStar(0)},addOneComment:function(t){var e=new p({model:t}),i=n(e.render().el),o=0,r=t.get("reply_id");i.attr({"data-reply-id":r,id:"item-"+r}),i.insertBefore(n("#comment-list li").first()),o=i.height(),i.css("height",0),i.animate({height:o}),this._insReplyList(r),this.totalCommentCount++,this._resetCommentNum()},addOneReply:function(t){var e=this,i=t.collection.pid,o=n("#item-"+i),r=o.find(".reply-list"),s=r.find("li").first(),a=new p({model:t,className:"ry-item clearfix",template:c.template(n("#reply-item-tpl").html())}),l=n(a.render().el),m=0,h=o.find(".reply-wrap"),d=t.get("reply_id");l.attr({"data-reply-id":d,id:"item-"+d}),h.css("height","auto"),s.length?l.insertBefore(s):(r.append(l),l.addClass("last")),m=l.height(),l.css("height",0),l.animate({height:m}),e["totalReplyCount"+i]++,e._resetReplyNum(i)},_validateComment:function(){var t=this,e=n(this.el).find("span.tip"),i=n(this.el).find(".post-comment-ipt").val(),o=i.length;return t.commentStar?0==o?(this._showCommentError(u.notEmpty),!1):o>u.MAX_LENGTH?(this._showCommentError(u.tooLarge),!1):n(this.vcode.get("sel_input")).val()?!0:(this._showCommentError(u.emptyVcode),!1):(e.css("display","inline-block"),!1)},_showCommentError:function(t){var e=this,t=t||u.serverErrorTip.systemError,i=e.$addCmtEl.siblings(".tip");i.css({display:"inline-block"}),i.text(t),t&&(e.$addCmtEl.errAniTimer&&clearInterval(e.$addCmtEl.errAniTimer),e.$addCmtEl.errFlashCount=0,e.$addCmtEl.find(">p:eq(0)").css({backgroundColor:""}),e.$addCmtEl.errAniTimer=setInterval(function(){e.$addCmtEl.find(">p:eq(0)").css(e.$addCmtEl.errFlashCount++%2==0?{backgroundColor:"#fffad1"}:{backgroundColor:""}),e.$addCmtEl.errFlashCount>=6&&clearInterval(e.$addCmtEl.errAniTimer)},220))},updateRemainLength:function(t){var e=this,i=n(t.target),o=n(this.el).find(".length-tip"),r=i.val().length,s=u.MAX_LENGTH-r;s>=0?o.text(s):(e._showCommentError(u.tooLarge),o.text(""))},createComment:function(){var t=this,e=t.$addCmtEl.find("textarea"),i=n(this.el).find(".length-tip"),o=n(this.el).find(".tip");h.lang.eventCenter.dispatchEvent("triggerStars.response"),a.verlogin(function(){a.check(function(){t._validateComment()&&t.commentList.create({content:e.val(),star:t.commentStar,v_input:n("#v_input").val(),v_code:n("#v_code").val()},{success:function(n,r){0==r.errno?(t.resetStar(),e.val(""),i.text(u.MAX_LENGTH),o.hide(),t.vcode.get_captcha(),l.xsend(1,100146)):(t._showCommentError(u.serverErrorTip[r.errno]),t.vcode.get_captcha())},error:function(){t._showCommentError(u.serverErrorTip[res.errno]),t.vcode.get_captcha()}})})})},createReply:function(t){var e=this,i=n(t.target).parents("li.ct-item"),o=i.data("reply-id"),r=i.find(".post-reply-ipt"),s=i.find(".reply-wrap .error-tip"),c=r.val();a.verlogin(function(){a.check(function(){e._validateReply(i)&&e["replyList"+o].create({content:c,star:5,parentid:o},{success:function(t,i){0!=i.errno?e._showReplyError(s,u.serverErrorTip[i.errno]):(r.val(""),l.xsend(1,100147))},error:function(){e._showReplyError(s,u.serverErrorTip.systemError)}})})})},createReplyOnEnter:function(t){var e=this;13==t.which&&e.createReply(t)},_validateReply:function(t){var e=t.find(".post-reply-ipt").val(),i=e.length,n=t.find(".error-tip"),o=!0;return 0==i&&(this._showReplyError(n,u.notEmpty),o=!1),i>u.MAX_LENGTH&&(this._showReplyError(n,u.tooLarge),o=!1),o},_showReplyError:function(t,e){t.show(),t.html(e)},_initReplyList:function(){var t=this;n.each(this.commentList.models,function(e,i){var n=i.id;t._insReplyList(n)})},_insReplyList:function(t){this["replyList"+t]=new d({pid:t}),this["replyList"+t].on("resetModels",n.proxy(this.renderReplyList,this,this["replyList"+t])),this["replyList"+t].on("change:reply_id",n.proxy(this.addOneReply,this)),this["replyList"+t].on("remove",n.proxy(this.removeItem,this)),this["replyList"+t].on("add remove",n.proxy(this.resetReplyNum,this))},renderCommentList:function(t){var e=this;this.toogleLoading(),this.totalCommentCount=t.totalCount||0,e.totalPage=Math.ceil(this.totalCommentCount/10),n("#comment-list").html(c.template(n("#comment-list-tpl").html(),{commentList:e.commentList.getCommentList()})),this._initPage(),this._initReplyList(),this._resetCommentNum()},_initPage:function(){var t=this,e=n("#pager")[0];this.pageIns?this.pageIns.show({total:t.totalPage,current:t.currentPage}):(this.pageIns=r({el:e,total:t.totalPage,displayNumber:8,current:1,onclick:function(e){t.toogleLoading("loading"),t.commentList.resetModels(e),t.currentPage=e}}),this.pageIns.show())},toogleReply:function(t){var e=n(t.target).parents("li.ct-item"),i=e.data("reply-id");e.hasClass("ct-reply-unfold")?this._toogleReply(e):this["replyList"+i].resetModels()},renderReplyList:function(t,e){var i=this,o=t.pid,r=n("#item-"+o),s=r.find(".reply-list");s.html(c.template(n("#reply-list-tpl").html(),{replyList:t.getCommentList()})),i._toogleReply(r),i["totalReplyCount"+o]=e.totalCount,i._resetReplyNum(o)},_toogleReply:function(t){function e(){t.addClass("ct-reply-unfold"),t.css("height","auto"),n.css({display:"block",height:0}),n.animate({height:o},"normal",function(){n.css("height","auto")})}function i(){t.removeClass("ct-reply-unfold"),n.animate({height:0},"normal",function(){n.css({display:"none",height:"auto"})})}var n=t.find(".reply-wrap"),o=n.height();t.hasClass("ct-reply-unfold")?i():e()},deleteAct:function(t){var e=this,i=n(t.target),r=i.parents("li.ct-item"),s=r.data("reply-id");if(i.hasClass("delete-reply-btn"))var a=i.parents("li.ry-item"),l=a.data("reply-id");o.confirm({title:"\u63d0\u793a",content:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u8bc4\u8bba\u5417\uff1f",innerId:"comment-action-dlg",draggable:!1,width:390,height:215,onConfirmBefore:function(){l?e["replyList"+s].get(l).clear():e.commentList.get(s).clear()}})},removeItem:function(t){var e=this,i=t.collection.pid,o=n("#item-"+t.id);o.parents(".reply-wrap").css("height","auto"),o.animate({height:0},"normal",function(){o.remove()}),i?(e["totalReplyCount"+i]--,e._resetReplyNum(i)):(this.totalCommentCount--,this._resetCommentNum())},_resetCommentNum:function(){var t=this.totalCommentCount,e=n(this.el).find(".no-comment"),i=n(this.el).find(".ct-num");t>0?(i.html("("+t+")"),e.hide()):(i.html(""),e.show())},_resetReplyNum:function(t){var e=this,i=n("#item-"+t),o=i.find(".reply-num"),r=e["totalReplyCount"+t];i.find(".ry-num").html(r),r>0?(o.show(),o.html("\u5171"+r+"\u6761\u56de\u590d")):o.hide()},toogleLoading:function(t){var e=n(this.el).find(".loading"),i=n("#comment-list");"loading"==t?(e.show(),i.hide()):(e.hide(),i.show())},toogleLoading:function(t){var e=n(this.el).find(".loading"),i=n("#comment-list");"loading"==t?(e.show(),i.hide()):(e.hide(),i.show())},highlightIpt:function(t){var e=n(t.target),i=this,o=this._getHighlightEl(e),r=o.hlEl,s=o.errorEl;r.addClass("hightlight-ipt"),s.hide(),a.verlogin(function(){a.check(function(){n(i.vcode.get("sel_captcha")).attr("src")||i.vcode.get_captcha()})})},cancelHighlightIpt:function(t){var e=n(t.target),i=this._getHighlightEl(e),o=i.hlEl;o.removeClass("hightlight-ipt")},_getHighlightEl:function(t){var e=t,i=null;return t.hasClass("post-comment-ipt")?(e=t.parents(".add-ct-wrap"),i=e.next(".tip")):i=e.parents(".reply-wrap").find(".error-tip"),{hlEl:e,errorEl:i}}});i.exports=y});
;define("wkview:widget/comment/comment.js",function(e){var i=e("wkcommon:widget/ui/lib/jquery/jquery.js"),t=e("wkcommon:widget/lib/tangram/base/base.js"),n=e("wkview:widget/comment/js/view/commentApp.js"),s={init:function(){new n,this.adjustResize(),t.lang.eventCenter.addEventListener("Reader.zoomChange",this.adjustResize),i(window).on("resize",i.proxy(this.adjustResize,this))},adjustResize:function(){var e=i("#doc-comment"),t=e.width();890>t?e.addClass("s-comment"):e.removeClass("s-comment")}};s.init()});
;define("wkview:widget/daily_recom/daily_rec.js",function(e){var i=e("wkcommon:widget/ui/lib/jquery/jquery.js"),r=e("wkview:widget/crmAd/crmAd2.js");i(function(){new r({ele:i("#daily-recom"),pid:48,limit:3,cb:function(){var e=function(){var e=i(".daily-recom-wrap"),r=i(".reader-container").width()||i("#doc_reader").width();window.console.log("reader-container resize to: ",r," & window resize to: ",i(window).width()),900>r?e.addClass("small-wrap"):e.removeClass("small-wrap")};e(),i(window).on("resize",e)}})})});
;define("wkview:widget/daily_recom/daily_recom.js",function(){});
;define("wkview:widget/ui/util/util.js",function(e,t,n){function i(e){this.win=e,this.init()}var o=e("wkcommon:widget/lib/tangram/base/base.js"),r=!1,s=function(e){if(!r){r=!0;var t=o.page.getScrollTop(),n=o.dom.getPosition(e).top,i=30,s=n>t?"down":"up",a={down:function(){if(0>=n-t)return void(r=!1);var e=i;i>n-t&&(e=1),window.scrollTo(0,t+=e)},up:function(){if(n-t>=0)return void(r=!1);var e=i;i>t-n&&(e=1),window.scrollTo(0,t-=e)}},c=function(){setTimeout(function(){a[s](),c()},0)};c()}};n.exports.scrollToEl=s;var a=function(e){var t=/((\w+=\d+)(\|?))(?!\|?-?\d+&?)/g;return-1===e.indexOf("&")&&(e=e.replace(t,function(e,t,n,i){return n+"|0"+(i?"&":"")})),e},c=function(e){if(!e)return"0";var t=o.cookie.get("viewedPg");if(!t)return"0";-1===t.indexOf("&")&&(t=a(t));var n=new RegExp(e+"=((\\d+)\\|-?\\d+)&?");return n.exec(t)?n.exec(t)[1]:"0"};n.exports.getViewedPage=c;var u=function(e){e=e||0;var t={0:"",1:"doc",2:"xls",3:"ppt",4:"docx",5:"xlsx",6:"pptx",7:"pdf",8:"txt",9:"wps",10:"et",11:"dps",12:"vsd",13:"rtf",14:"pot",15:"pps",16:"epub"};return t[e]};n.exports.docTypeNumToString=u;var d=function(e,t,n){if(e&&t&&!(1>t)){var i=o.cookie.get("viewedPg");if(i)if("0"!=c(e)){i=a(i);var r=new RegExp(e+"=\\d+\\|-?\\d+&?");i=i.replace(r,""),i=i.replace(/&$/,""),i+=((i+"").length<1||"&"===i.charAt((i+"").length-1)?"":"&")+e+"="+t+"|"+n}else i=a(i),i.split("&").length>=10&&(i=i.split("&").slice(-9).join("&")),i+="&"+e+"="+t+"|"+n;else i=e+"="+t+"|"+n;var s=location.pathname,u=s.substr(0,s.lastIndexOf("/")+1);o.cookie.set("viewedPg",i,{path:u,expires:31536e6})}};n.exports.saveViewedPage=d,i.prototype.init=function(){var e=this,t=function(t){t.source==e.win&&(e.onmessage||function(){}).call(e,t.data)};window.addEventListener?window.addEventListener("message",t,!1):window.attachEvent&&window.attachEvent("onmessage",t)},i.prototype.send=function(e){this.win.postMessage(e,"*")},i.initInParent=function(e){return new this(e.contentWindow)},i.initInIframe=function(){return new this(window.parent)},!window.postMessage&&window.attachEvent&&(i.prototype.init=function(){var e=!1;try{e=!!this.win.location.href}catch(t){}return e?(this.send=this.sendForSameOrigin,void this.initForSameOrigin()):(this.queue=[],void(window.parent==this.win?this.initForParent():this.initForFrame()))},i.prototype.initForSameOrigin=function(){var e=this;document.attachEvent("ondataavailable",function(t){t.eventType&&"message"===t.eventType&&t.eventSource==e.win&&(e.onmessage||function(){}).call(e,t.eventData)})},i.prototype.sendForSameOrigin=function(e){var t=this;setTimeout(function(){var n=t.win.document.createEventObject();n.eventType="message",n.eventSource=window,n.eventData=e,t.win.document.fireEvent("ondataavailable",n)})},i.prototype.initForParent=function(){var e=document.createDocumentFragment(),t="width: 1px; height: 1px; position: absolute; left: -999px; top: -999px;",n=document.createElement("iframe");n.style.cssText=t,e.appendChild(n);var i=document.createElement("iframe");i.style.cssText=t,e.appendChild(i),document.body.insertBefore(e,document.body.firstChild),this.senderWin=n.contentWindow,this.receiverWin=i.contentWindow,this.startReceive()},i.prototype.initForFrame=function(){this.senderWin=null,this.receiverWin=null;var e=this;this.timerId=setInterval(function(){e.waitForFrame()},50)},i.prototype.waitForFrame=function(){var e,t;try{e=this.win[1],t=this.win[0]}catch(n){}e&&t&&(clearInterval(this.timerId),this.senderWin=e,this.receiverWin=t,this.queue.length&&this.flush(),this.startReceive())},i.prototype.startReceive=function(){var e=this;this.timerId=setInterval(function(){e.tryReceive()},50)},i.prototype.tryReceive=function(){try{return void this.receiverWin.name}catch(e){}this.receiverWin.location.replace("about:blank");var t=this;setTimeout(function(){t.receive()},0)},i.prototype.receive=function(){var e=null;try{e=this.receiverWin.name}catch(t){}if(e){this.receiverWin.name="";for(var n=this,i=e.substring(1).split("|"),o=0;o<i.length;o++)(function(){var e=decodeURIComponent(i[o]);setTimeout(function(){(n.onmessage||function(){}).call(n,e)},0)})()}},i.prototype.send=function(e){this.queue.push(e),this.senderWin&&this.flush()},i.prototype.flush=function(){for(var e=[],t=0;t<this.queue.length;t++)e[t]=encodeURIComponent(this.queue[t]);var n="|"+e.join("|");try{this.senderWin.name+=n,this.queue.length=0}catch(i){this.senderWin.location.replace("about:blank");var o=this;setTimeout(function(){o.flush()},0)}}),n.exports.Messenger=i});
;define("wkview:widget/ui/flashReaderCreater/flashReaderCreater.js",function(e,t,a){var r=e("wkcommon:widget/lib/tangram/base/base.js"),s=e("wkcommon:widget/ui/js_core/widget/widget.js").widget,i=e("wkcommon:widget/ui/js_core/log/log.js"),o=(e("wkcommon:widget/ui/js_core/util/util.js"),r.swf),n=r.browser,l=function(e){var t,a=o.version;if(a){if(t=a.slice(0,a.indexOf(".")),!(e>t))return i.send("view","flashload",{subtype:"jsrequest"}),!0;t=a}else t=0;return i.send("view","reader",{flashver:t}),!1},c=s({Options:{el:"",id:"reader",width:"100%",height:"100%",ver:"10.0.0",errorMessage:l(10)?"":'<p class="ml" style="text-align: center; margin-top:50px;line-height:26px; font-size: 14px;">\u6587\u6863\u9884\u89c8\u9700\u8981\u6700\u65b0\u7248\u672c\u7684Flash Player\u652f\u6301\u3002</p><p class="ml" style="text-align: center; font-size: 14px;">\u60a8\u5c1a\u672a\u5b89\u88c5\u6216\u7248\u672c\u8fc7\u4f4e\uff0c\u5efa\u8bae\u60a8<a id="downloadflash" href="https://get.adobe.com/cn/flashplayer/" target="_blank" class="log-xsend" data-logxsend="[1, 100898, {\'index\': 1}]" style="color:#19A97B;">\u70b9\u51fb\u6b64\u5904</a>\u5b89\u88c5\u6700\u65b0\u7248Flash Player\u3002</p>',url:"/static/flash/txtreader_new_b.swf",bgColor:"#FFFFFF",allowfullscreen:"true",vars:{docid:"txt",fpn:5,npn:5,bookmark:"0|0",ext:"txt",readertype:"internal",newMark:"0|0",catal:0,cid:"1",cid1:"1",cid2:"1",cid3:"1",title:document.title.replace("_\u767e\u5ea6\u6587\u5e93","")}},_init:function(){var e,t,a=this,s=a.vars,i=s.ext,l="txt"==i?50:5,c=l;"course"==a.templateType?t=e="http://wenku.baidu.com/course/docplay/"+a.sectionId:(e="txt"==i?"http://wenku.baidu.com/play":"http://ai.wenku.baidu.com/play",t="txt"==i?"http://txt.wenku.baidu.com/play":"http://ai.wenku.baidu.com/play"),location.href.search(/localhost|127\.0\.0\.1/)>=0&&(e=e.replace(/(ai\.)?wenku\.baidu\.com/,location.host),t=t.replace(/((ai\.)|(txt\.))?wenku\.baidu\.com/,location.host)),a.options=r.object.merge(a.options,{url:"/static/flash/"+a._getReaderFileName(i),wmode:n.firefox&&!r.platform.isX11||a._isBugChrome()?"opaque":"window",vars:{docurl:e,cdnurl:t,fpn:l,npn:c,isChrome:a._isBugChrome(),title:document.title.replace("_\u767e\u5ea6\u6587\u5e93","")}},{overwrite:!0,recursive:!0});var d=r.object.merge(a.Options,a.options,{overwrite:!0,recursive:!0});delete d.el,r.lang.eventCenter.dispatchEvent("flashReaderCreater.before",{options:d,el:a.el}),o.create(d,a.el),r.lang.eventCenter.dispatchEvent("flashReaderCreater.after",{options:d,el:a.el})},_isBugChrome:function(){return+(-1!=r.array.indexOf([21,22,23],Number(n.chrome)))},_getReaderFileName:function(e){var t="";switch(e){case"txt":t="txtreader_new_b";break;case"":case"doc":case"xls":case"ppt":case"docx":case"xlsx":case"pptx":case"pdf":case"wps":case"et":case"dps":case"vsd":case"rtf":case"pot":case"pps":case"epub":t="reader_new_b";break;default:t="txtreader_new_b"}return t+".swf"}},{type:"reader"}),d=function(e){var t=new c(e);return t.fire("onload"),t};a.exports.flashReaderCreater=d});
;define("wkview:widget/ui/pagenation/pagenation.js",function(n,e,a){var t,o=n("wkcommon:widget/lib/tangram/base/base.js"),i=n("wkcommon:widget/ui/js_core/util/util.js"),s=n("wkcommon:widget/ui/js_core/widget/widget.js").widget,r=s({Options:{el:null,pn:0,rn:0,total:0,showPrev:!1,showNext:!1,ref:null,callback:function(){}},_init:function(){var n=this,e=n.options.el||null;i.delegate(e,"a.no","click",function(e){var a=this.href.match(/\#(\d+)/),t=n.options.callback;return t(a?+a[1]:0),o.event.stop(e),!1})},gotoPage:function(n){var e=this,a=e.options.el||null,i=e.options.rn,s=e.options.total;a&&(t&&(o.dom.remove(t),t=null),e.options.pn=n,a.appendChild(t=e.getPagenation(n,i,s)))},getPagenation:function(n,e,a){var t=Math.ceil(a/e),o=this,s=['<div class="ui-pager pager-center"><div class="pager"><div class="pager-inner">'];if(o.Options.showPrev&&s.push(n-1>=0?'<a href="#'+(n-1)+'" class="pre no">\u4e0a\u4e00\u9875</a>':""),10>=t)for(var r=0;t>r;r++)s.push(n==r?'<span class="cur no">'+(r+1)+"</span>":'<a href="#'+r+'" class="no">'+(r+1)+"</a>");else for(var l=Math.min(n-5>0?n-5:0,t-10-1),r=l;10>=r-l;r++)s.push(n==r?'<span class="cur no">'+(r+1)+"</span>":'<a href="#'+r+'" class="no">'+(r+1)+"</a>");return o.Options.showNext&&s.push(t-1>=n-0+1?'<a href="#'+(n-0+1)+'" class="next no">\u4e0b\u4e00\u9875</a>':""),s.push("</div> </div></div>"),i.createDom(s.join(""))}});a.exports.pagenation=function(){var n;return function(e){return n?n:n=new r(e)}}()});
;define("wkview:widget/ui/backbone/backbone.js",function(t,e,i){var n=(t("wkview:widget/ui/underscore/underscore.js"),t("wkcommon:widget/ui/lib/jquery/jquery.js"));!function(s,r){if("function"==typeof define&&define.amd)define(["underscore","jquery","module.exports"],function(t,e){s.Backbone=r(s,i.exports,t,e)});else if("undefined"!=typeof e){var a=t("wkview:widget/ui/underscore/underscore.js");r(s,i.exports,a,n)}else s.Backbone=r(s,{},s._,s.jQuery||s.Zepto||s.ender||s.$)}(this,function(t,e,i,n){{var s=t.Backbone,r=[],a=(r.push,r.slice);r.splice}e.VERSION="1.1.2",e.$=n,e.noConflict=function(){return t.Backbone=s,this},e.emulateHTTP=!1,e.emulateJSON=!1,e.reqKeyValue=!0;var o=e.Events={on:function(t,e,i){if(!u(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,n){if(!u(this,"once",t,[e,n])||!e)return this;var s=this,r=i.once(function(){s.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,n)},off:function(t,e,n){var s,r,a,o,h,c,l,d;if(!this._events||!u(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events=void 0,this;for(o=t?[t]:i.keys(this._events),h=0,c=o.length;c>h;h++)if(t=o[h],a=this._events[t]){if(this._events[t]=s=[],e||n)for(l=0,d=a.length;d>l;l++)r=a[l],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&s.push(r);s.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!u(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&c(i,e),n&&c(n,arguments),this},stopListening:function(t,e,n){var s=this._listeningTo;if(!s)return this;var r=!e&&!n;n||"object"!=typeof e||(n=this),t&&((s={})[t._listenId]=t);for(var a in s)t=s[a],t.off(e,n,this),(r||i.isEmpty(t._events))&&delete this._listeningTo[a];return this}},h=/\s+/,u=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var s in i)t[e].apply(t,[s,i[s]].concat(n));return!1}if(h.test(i)){for(var r=i.split(h),a=0,o=r.length;o>a;a++)t[e].apply(t,[r[a]].concat(n));return!1}return!0},c=function(t,e){var i,n=-1,s=t.length,r=e[0],a=e[1],o=e[2];switch(e.length){case 0:for(;++n<s;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,a);return;case 3:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,a,o);return;default:for(;++n<s;)(i=t[n]).callback.apply(i.ctx,e);return}},l={listenTo:"on",listenToOnce:"once"};i.each(l,function(t,e){o[e]=function(e,n,s){var r=this._listeningTo||(this._listeningTo={}),a=e._listenId||(e._listenId=i.uniqueId("l"));return r[a]=e,s||"object"!=typeof n||(s=this),e[t](n,s,this),this}}),o.bind=o.on,o.unbind=o.off,i.extend(e,o);var d=e.Model=function(t,e){var n=t||{};e||(e={}),this.cid=i.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(d.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var s,r,a,o,h,u,c,l;if(null==t)return this;if("object"==typeof t?(r=t,n=e):(r={})[t]=e,n||(n={}),!this._validate(r,n))return!1;a=n.unset,h=n.silent,o=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=i.clone(this.attributes),this.changed={}),l=this.attributes,c=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(s in r)e=r[s],i.isEqual(l[s],e)||o.push(s),i.isEqual(c[s],e)?delete this.changed[s]:this.changed[s]=e,a?delete l[s]:l[s]=e;if(!h){o.length&&(this._pending=n);for(var d=0,f=o.length;f>d;d++)this.trigger("change:"+o[d],this,l[o[d]],n)}if(u)return this;if(!h)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?i.clone(this.changed):!1;var e,n=!1,s=this._changing?this._previousAttributes:this.attributes;for(var r in t)i.isEqual(s[r],e=t[r])||((n||(n={}))[r]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(i){return e.set(e.parse(i,t),t)?(n&&n(e,i,t),void e.trigger("sync",e,i,t)):!1},C(this,t),this.sync("read",this,t)},save:function(t,e,n){var s,r,a,o=this.attributes;if(null==t||"object"==typeof t?(s=t,n=e):(s={})[t]=e,n=i.extend({validate:!0},n),s&&!n.wait){if(!this.set(s,n))return!1}else if(!this._validate(s,n))return!1;s&&n.wait&&(this.attributes=i.extend({},o,s)),void 0===n.parse&&(n.parse=!0);var h=this,u=n.success;return n.success=function(t){h.attributes=o;var e=h.parse(t,n);return n.wait&&(e=i.extend(s||{},e)),i.isObject(e)&&!h.set(e,n)?!1:(u&&u(h,t,n),void h.trigger("sync",h,t,n))},C(this,n),r=this.isNew()?"create":n.patch?"patch":"update","patch"===r&&(n.attrs=s),a=this.sync(r,this,n),s&&n.wait&&(this.attributes=o),a},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,s=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(i){(t.wait||e.isNew())&&s(),n&&n(e,i,t),e.isNew()||e.trigger("sync",e,i,t)},this.isNew())return t.success(),!1;C(this,t);var r=this.sync("delete",this,t);return t.wait||s(),r},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||q();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1):!0}});var f=["keys","values","pairs","invert","pick","omit"];i.each(f,function(t){d.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.attributes),i[t].apply(i,e)}});var p=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},g={add:!0,remove:!0,merge:!0},v={add:!0,remove:!1};i.extend(p.prototype,o,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,v))},remove:function(t,e){var n=!i.isArray(t);t=n?[t]:i.clone(t),e||(e={});var s,r,a,o;for(s=0,r=t.length;r>s;s++)o=t[s]=this.get(t[s]),o&&(delete this._byId[o.id],delete this._byId[o.cid],a=this.indexOf(o),this.models.splice(a,1),this.length--,e.silent||(e.index=a,o.trigger("remove",o,this,e)),this._removeReference(o,e));return n?t[0]:t},set:function(t,e){e=i.defaults({},e,g),e.parse&&(t=this.parse(t,e));var n=!i.isArray(t);t=n?t?[t]:[]:i.clone(t);var s,r,a,o,h,u,c,l=e.at,f=this.model,p=this.comparator&&null==l&&e.sort!==!1,v=i.isString(this.comparator)?this.comparator:null,m=[],y=[],_={},w=e.add,b=e.merge,x=e.remove,E=!p&&w&&x?[]:!1;for(s=0,r=t.length;r>s;s++){if(h=t[s]||{},a=h instanceof d?o=h:h[f.prototype.idAttribute||"id"],u=this.get(a))x&&(_[u.cid]=!0),b&&(h=h===o?o.attributes:h,e.parse&&(h=u.parse(h,e)),u.set(h,e),p&&!c&&u.hasChanged(v)&&(c=!0)),t[s]=u;else if(w){if(o=t[s]=this._prepareModel(h,e),!o)continue;m.push(o),this._addReference(o,e)}o=u||o,!E||!o.isNew()&&_[o.id]||E.push(o),_[o.id]=!0}if(x){for(s=0,r=this.length;r>s;++s)_[(o=this.models[s]).cid]||y.push(o);y.length&&this.remove(y,e)}if(m.length||E&&E.length)if(p&&(c=!0),this.length+=m.length,null!=l)for(s=0,r=m.length;r>s;s++)this.models.splice(l+s,0,m[s]);else{E&&(this.models.length=0);var k=E||m;for(s=0,r=k.length;r>s;s++)this.models.push(k[s])}if(c&&this.sort({silent:!0}),!e.silent){for(s=0,r=m.length;r>s;s++)(o=m[s]).trigger("add",o,this,e);(c||E&&E.length)&&this.trigger("sort",this,e)}return n?t[0]:t},reset:function(t,e){e||(e={});for(var n=0,s=this.models.length;s>n;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return a.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return i.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return i.invoke(this.models,"get",t)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,n=this;return t.success=function(i){var s=t.reset?"reset":"set";n[s](i,t),e&&e(n,i,t),n.trigger("sync",n,i,t)},C(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?i.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,s=e.success;return e.success=function(t,i){e.wait&&n.add(t,e),s&&s(t,i,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof d)return t;e=e?i.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_addReference:function(t){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var m=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(m,function(t){p.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),i[t].apply(i,e)}});var y=["groupBy","countBy","sortBy","indexBy"];i.each(y,function(t){p.prototype[t]=function(e,n){var s=i.isFunction(e)?e:function(t){return t.get(e)};return i[t](this.models,s,n)}});var _=e.View=function(t){this.cid=i.uniqueId("view"),t||(t={}),i.extend(this,i.pick(t,b)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,b=["model","collection","el","id","attributes","className","tagName","events"];i.extend(_.prototype,o,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=i.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[t[e]]),n){var s=e.match(w),r=s[1],a=s[2];n=i.bind(n,this),r+=".delegateEvents"+this.cid,""===a?this.$el.on(r,n):this.$el.on(r,a,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t["class"]=i.result(this,"className"));var n=e.$("<"+i.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}}),e.sync=function(t,n,s){var r=E[t];i.defaults(s||(s={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON,reqKeyValue:e.reqKeyValue});var a={type:r,dataType:"json"};if(s.url||(a.url=i.result(n,"url")||q()),null!=s.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=s.attrs||n.toJSON(s),s.reqKeyValue||(a.data=JSON.stringify(a.data))),s.emulateJSON&&!s.reqKeyValue&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),s.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){a.type="POST",s.emulateJSON&&(a.data._method=r);var o=s.beforeSend;s.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",r),o?o.apply(this,arguments):void 0}}if(s.reqKeyValue){a.type="POST",a.contentType="application/x-www-form-urlencoded";for(var h in a.data)"string"!=typeof a.data[h]&&(a.data[h]=JSON.stringify(a.data[h]))}"GET"===a.type||s.emulateJSON||s.reqKeyValue||(a.processData=!1),"PATCH"===a.type&&x&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var u=s.xhr=e.ajax(i.extend(a,s));return n.trigger("request",n,u,s),u};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),E={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var k=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},T=/\((.*?)\)/g,S=/(\(\?)?:\w+/g,$=/\*\w+/g,H=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(k.prototype,o,{initialize:function(){},route:function(t,n,s){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(s=n,n=""),s||(s=this[n]);var r=this;return e.history.route(t,function(i){var a=r._extractParameters(t,i);r.execute(s,a),r.trigger.apply(r,["route:"+n].concat(a)),r.trigger("route",n,a),e.history.trigger("route",r,n,a)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(H,"\\$&").replace(T,"(?:$1)?").replace(S,function(t,e){return e?t:"([^/?]+)"}).replace($,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var A=e.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},I=/^[#\/]|\s+$/g,N=/^\/+|\/+$/g,j=/msie [\w.]+/,O=/\/$/,P=/#.*$/;A.started=!1,i.extend(A.prototype,o,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(O,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace(I,"")},start:function(t){if(A.started)throw new Error("Backbone.history has already been started");A.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),s=document.documentMode,r=j.exec(navigator.userAgent.toLowerCase())&&(!s||7>=s);if(this.root=("/"+this.root+"/").replace(N,"/"),r&&this._wantsHashChange){var a=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=a.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var o=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&o.hash&&(this.fragment=this.getHash().replace(I,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),A.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),i.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!A.started)return!1;e&&e!==!0||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(P,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new A;var R=function(t,e){var n,s=this;n=t&&i.has(t,"constructor")?t.constructor:function(){return s.apply(this,arguments)},i.extend(n,s,e);var r=function(){this.constructor=n};return r.prototype=s.prototype,n.prototype=new r,t&&i.extend(n.prototype,t),n.__super__=s.prototype,n};d.extend=p.extend=k.extend=_.extend=A.extend=R;var q=function(){throw new Error('A "url" property or function must be specified')},C=function(t,e){var i=e.error;e.error=function(n){i&&i(t,n,e),t.trigger("error",t,n,e)}};return e})});
;define("wkview:widget/ui/UIaddToAlbum/UIaddToAlbum.js",function(require,exports,module){var T=require("wkcommon:widget/lib/tangram/base/base.js"),WkInfo=require("wkcommon:widget/lib/fis/data/data.js").get("WkInfo");module.exports.UIaddAlbum=function(e){var _VCT={view:{noAlbum:{title:"\u63d0\u793a",style:{width:260,height:70},tpl:'<p class="noalbum">\u60a8\u8fd8\u6ca1\u6709\u6587\u8f91\uff0c\u8bf7<a href="/album/new">\u521b\u5efa\u6587\u8f91</a></p>',dom:function(e){return e.tpl}},hasAlbum:{title:"\u52a0\u5165\u6587\u8f91",style:{width:358,height:222},tpl:'<div><dl class="addAblum"><dt>{title}</dt><dd><form method="post" id="form-AddAblum" action="/album/submit/albumAddDoc">{viewDom}<input type="hidden" value="20017" name="ct" /><input type="hidden" value="http://wenku.baidu.com/view/{docid}.html" name="docs[0]"><input type="hidden" name="radio" value="" /><input type="hidden" name="newtype" value="1" /></form></dd></dl><div class="reader_tools_tips_btn_wrap"><a href="###" class="bt ui-btn ui-btn-26-green mr10" data-btn-event="album.resolve"><b class="btc" data-btn-event="album.resolve"><b class="btText" data-btn-event="album.resolve">\u52a0\u5165</b></b></a><a href="###" class="bt ui-btn ui-btn-26-light mr10 reader_tips_close"><b class="btc reader_tips_close"><b class="btText reader_tips_close">\u5173\u95ed</b></b></a></div></div>',itemTpl:'<p><input id="album-{ablumId}" value ="{ablumId}" name="album_id" type="radio" {checked} />{albumTitle}</p>',dom:function(e,t){var a="";T.array.each(t,function(l,i){var n=0==i?'checked="checked"':"";a+=e.itemTpl.replace(/{ablumId}/g,t[i].album_id).replace("{albumTitle}",t[i].title).replace("{checked}",n)});var l=WkInfo.DocInfo.title;return l=T.string.getByteLength(l)<20?l:T.string.subByte(l,20,"..."),e.tpl=e.tpl.replace("{title}","\u628a&nbsp;&nbsp;<strong>"+l+"&nbsp;&nbsp;</strong>\u6587\u6863\u52a0\u5165\u6587\u8f91").replace("{viewDom}",a).replace("{docid}",WkInfo.DocInfo.docId),e.tpl}},alertCon:'<div class="addAblum-alert"><strong>{con}</strong><a href="###" class="bt ui-btn ui-btn-26-light mr10 reader_tips_close"><b class="btc reader_tips_close"><b class="btText reader_tips_close">\u5173\u95ed</b></b></a></div>'},cases:function(){WkInfo.UserInfo.userGradeNum<1?_VCT.tasks.gradeError():_VCT.tasks.getAblumList()},tasks:{gradeError:function(){e.show({title:"\u51fa\u9519\u5566\uff01",content:_VCT.view.alertCon.replace("{con}","\u4e00\u7ea7\u7528\u6237\u6682\u65f6\u8fd8\u4e0d\u80fd\u521b\u5efa\u6587\u8f91<br/>\u518d\u52a0\u628a\u6cb9\u54e6\uff01"),width:260,height:120})},getAblumList:function(){T.ajax.post("/album/interface/albumasync","type=user_album",function(xhr,responseText){var ablbumList=eval("("+responseText+")");_VCT.tasks.selcetAblum(ablbumList)})},selcetAblum:function(t){var a=0==t.length?"noAlbum":"hasAlbum",l=_VCT.view[a];if(0==t.length)e.show({title:l.title,content:l.dom(l,t),width:l.style.width,height:l.style.height});else{e.show({title:l.title,content:l.dom(l,t),width:l.style.width,height:l.style.height,btnText:["\u52a0\u5165","\u53d6\u6d88"]});var i=function(){_VCT.tasks.post(),T.lang.eventCenter.removeEventListener("album.resolve",i)};T.lang.eventCenter.addEventListener("album.resolve",i)}},post:function(){T.ajax.form(T.g("form-AddAblum"),{async:!0,onsuccess:function(t,a){var l={};try{l=T.json.parse(a)}catch(i){}var n="0"==l.errno?0:1,s=[{title:"\u52a0\u5165\u6587\u8f91\u6210\u529f",content:"<div class='mh10'><b class=\"ic-addToAblum-sucess ic\"></b>\u52a0\u5165\u6587\u8f91\u6210\u529f</div>",width:200,height:120},{title:"\u52a0\u5165\u6587\u8f91\u5931\u8d25",content:"<div class='mh10'>\u8be5\u6587\u6863\u5df2\u7ecf\u52a0\u5165\u5230\u8be5\u6587\u8f91<br/>\u4e0d\u80fd\u91cd\u590d\u6dfb\u52a0</div>",width:260,height:150}];e.show({title:s[n].title,content:_VCT.view.alertCon.replace("{con}",s[n].content),width:s[n].width,height:s[n].height,btnText:["\u786e\u5b9a"]})}})}}};_VCT.cases()}});
;define("wkview:widget/ui/underscore/underscore.js",function(n,t,r){(function(){var n=this,t=n._,e={},u=Array.prototype,i=Object.prototype,a=Function.prototype,o=u.push,c=u.slice,l=u.concat,f=i.toString,s=i.hasOwnProperty,p=Array.isArray,h=Object.keys,v=a.bind,g=function(n){return n instanceof g?n:this instanceof g?void(this._wrapped=n):new g(n)};"undefined"!=typeof r.exports?r.exports=g:n._=g,g.VERSION="1.6.0",g.each=g.forEach=function(n,t,r){if(null==n)return n;if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(r,n[u],u,n)===e)return}else for(var a=g.keys(n),u=0,i=a.length;i>u;u++)if(t.call(r,n[a[u]],a[u],n)===e)return;return n},g.map=g.collect=function(n,t,r){var e=[];return null==n?e:(g.each(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var m="Reduce of empty array with no initial value";g.reduce=g.foldl=g.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),g.each(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(m);return r},g.reduceRight=g.foldr=function(n,t,r,e){var u=arguments.length>2;null==n&&(n=[]);var i=n.length;if(i!==+i){var a=g.keys(n);i=a.length}if(g.each(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(m);return r},g.find=g.detect=function(n,t,r){var e;return g.some(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},g.filter=g.select=function(n,t,r){var e=[];return null==n?e:(g.each(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},g.reject=function(n,t,r){return g.filter(n,g.negate(t),r)},g.every=g.all=function(n,t,r){t||(t=g.identity);var u=!0;return null==n?u:(g.each(n,function(n,i,a){return(u=u&&t.call(r,n,i,a))?void 0:e}),!!u)},g.some=g.any=function(n,t,r){t||(t=g.identity);var u=!1;return null==n?u:(g.each(n,function(n,i,a){return u||(u=t.call(r,n,i,a))?e:void 0}),!!u)},g.contains=g.include=function(n,t){return null==n?!1:n.length===+n.length?g.indexOf(n,t)>=0:g.some(n,function(n){return n===t})},g.invoke=function(n,t){var r=c.call(arguments,2),e=g.isFunction(t);return g.map(n,function(n){return(e?t:n[t]).apply(n,r)})},g.pluck=function(n,t){return g.map(n,g.property(t))},g.where=function(n,t){return g.filter(n,g.matches(t))},g.findWhere=function(n,t){return g.find(n,g.matches(t))},g.max=function(n,t,r){var e,u,i=-1/0,a=-1/0;if(!t&&g.isArray(n))for(var o=0,c=n.length;c>o;o++)e=n[o],e>i&&(i=e);else g.each(n,function(n,e,o){u=t?t.call(r,n,e,o):n,u>a&&(i=n,a=u)});return i},g.min=function(n,t,r){var e,u,i=1/0,a=1/0;if(!t&&g.isArray(n))for(var o=0,c=n.length;c>o;o++)e=n[o],i>e&&(i=e);else g.each(n,function(n,e,o){u=t?t.call(r,n,e,o):n,a>u&&(i=n,a=u)});return i},g.shuffle=function(n){var t,r=0,e=[];return g.each(n,function(n){t=g.random(r++),e[r-1]=e[t],e[t]=n}),e},g.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=g.values(n)),n[g.random(n.length-1)]):g.shuffle(n).slice(0,Math.max(0,t))};var y=function(n,t){return null==n?g.identity:g.isFunction(n)?t?function(){return n.apply(t,arguments)}:n:g.property(n)};g.sortBy=function(n,t,r){return t=y(t,r),g.pluck(g.map(n,function(n,r,e){return{value:n,index:r,criteria:t(n,r,e)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return n.index-t.index}),"value")};var d=function(n){return function(t,r,e){var u={};return r=y(r,e),g.each(t,function(e,i){var a=r(e,i,t);n(u,a,e)}),u}};g.groupBy=d(function(n,t,r){g.has(n,t)?n[t].push(r):n[t]=[r]}),g.indexBy=d(function(n,t,r){n[t]=r}),g.countBy=d(function(n,t){g.has(n,t)?n[t]++:n[t]=1}),g.sortedIndex=function(n,t,r,e){r=y(r,e);for(var u=r(t),i=0,a=n.length;a>i;){var o=i+a>>>1;r(n[o])<u?i=o+1:a=o}return i},g.toArray=function(n){return n?g.isArray(n)?c.call(n):n.length===+n.length?g.map(n,g.identity):g.values(n):[]},g.size=function(n){return null==n?0:n.length===+n.length?n.length:g.keys(n).length},g.first=g.head=g.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:0>t?[]:c.call(n,0,t)},g.initial=function(n,t,r){return c.call(n,0,Math.max(0,n.length-(null==t||r?1:t)))},g.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:c.call(n,Math.max(n.length-t,0))},g.rest=g.tail=g.drop=function(n,t,r){return c.call(n,null==t||r?1:t)},g.compact=function(n){return g.filter(n,g.identity)};var w=function(n,t,r,e){if(t&&g.every(n,g.isArray))return l.apply(e,n);for(var u=0,i=n.length;i>u;u++){var a=n[u];g.isArray(a)||g.isArguments(a)?t?o.apply(e,a):w(a,t,r,e):r||e.push(a)}return e};g.flatten=function(n,t){return w(n,t,!1,[])},g.without=function(n){return g.difference(n,c.call(arguments,1))},g.partition=function(n,t,r){t=y(t,r);var e=[],u=[];return g.each(n,function(n){(t(n)?e:u).push(n)}),[e,u]},g.uniq=g.unique=function(n,t,r,e){if(null==n)return[];g.isFunction(t)&&(e=r,r=t,t=!1);for(var u=[],i=[],a=0,o=n.length;o>a;a++){var c=n[a];r&&(c=r.call(e,c,a,n)),(t?a&&i===c:g.contains(i,c))||(t?i=c:i.push(c),u.push(n[a]))}return u},g.union=function(){return g.uniq(w(arguments,!0,!0,[]))},g.intersection=function(n){if(null==n)return[];for(var t=[],r=arguments.length,e=0,u=n.length;u>e;e++){var i=n[e];if(!g.contains(t,i)){for(var a=1;r>a&&g.contains(arguments[a],i);a++);a===r&&t.push(i)}}return t},g.difference=function(n){var t=w(c.call(arguments,1),!0,!0,[]);return g.filter(n,function(n){return!g.contains(t,n)})},g.zip=function(){for(var n=g.max(g.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=g.pluck(arguments,""+r);return t},g.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},g.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=g.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}for(;u>e;e++)if(n[e]===t)return e;return-1},g.lastIndexOf=function(n,t,r){if(null==n)return-1;for(var e=null==r?n.length:r;e--;)if(n[e]===t)return e;return-1},g.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var b=function(){};g.bind=function(n,t){var r,e;if(v&&n.bind===v)return v.apply(n,c.call(arguments,1));if(!g.isFunction(n))throw new TypeError;return r=c.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(c.call(arguments)));b.prototype=n.prototype;var u=new b;b.prototype=null;var i=n.apply(u,r.concat(c.call(arguments)));return Object(i)===i?i:u}},g.partial=function(n){var t=c.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;i>u;u++)e[u]===g&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},g.bindAll=function(n){var t=c.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return g.each(t,function(t){n[t]=g.bind(n[t],n)}),n},g.memoize=function(n,t){var r={};return t||(t=g.identity),function(){var e=t.apply(this,arguments);return g.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},g.delay=function(n,t){var r=c.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},g.defer=function(n){return g.delay.apply(g,[n,1].concat(c.call(arguments,1)))},g.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:g.now(),a=null,i=n.apply(e,u),e=u=null};return function(){var l=g.now();o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f||f>t?(clearTimeout(a),a=null,o=l,i=n.apply(e,u),e=u=null):a||r.trailing===!1||(a=setTimeout(c,f)),i}},g.debounce=function(n,t,r){var e,u,i,a,o,c=function(){var l=g.now()-a;t>l&&l>0?e=setTimeout(c,t-l):(e=null,r||(o=n.apply(i,u),i=u=null))};return function(){i=this,u=arguments,a=g.now();var l=r&&!e;return e||(e=setTimeout(c,t)),l&&(o=n.apply(i,u),i=u=null),o}},g.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},g.wrap=function(n,t){return g.partial(t,n)},g.negate=function(n){return function(){return!n.apply(this,arguments)}},g.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},g.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},g.keys=function(n){if(!g.isObject(n))return[];if(h)return h(n);var t=[];for(var r in n)g.has(n,r)&&t.push(r);return t},g.values=function(n){for(var t=g.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},g.pairs=function(n){for(var t=g.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},g.invert=function(n){for(var t={},r=g.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},g.functions=g.methods=function(n){var t=[];for(var r in n)g.isFunction(n[r])&&t.push(r);return t.sort()},g.extend=function(n){return g.each(c.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},g.pick=function(n,t,r){var e={};if(g.isFunction(t))for(var u in n){var i=n[u];t.call(r,i,u,n)&&(e[u]=i)}else for(var a=l.apply([],c.call(arguments,1)),o=0,f=a.length;f>o;o++){var u=a[o];u in n&&(e[u]=n[u])}return e},g.omit=function(n,t,r){var e;return g.isFunction(t)?t=g.negate(t):(e=g.map(l.apply([],c.call(arguments,1)),String),t=function(n,t){return!g.contains(e,t)}),g.pick(n,t,r)},g.defaults=function(n){return g.each(c.call(arguments,1),function(t){if(t)for(var r in t)void 0===n[r]&&(n[r]=t[r])}),n},g.clone=function(n){return g.isObject(n)?g.isArray(n)?n.slice():g.extend({},n):n},g.tap=function(n,t){return t(n),n};var _=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof g&&(n=n._wrapped),t instanceof g&&(t=t._wrapped);var u=f.call(n);if(u!=f.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(g.isFunction(a)&&a instanceof a&&g.isFunction(o)&&o instanceof o)&&"constructor"in n&&"constructor"in t)return!1;r.push(n),e.push(t);var c=0,l=!0;if("[object Array]"==u){if(c=n.length,l=c==t.length)for(;c--&&(l=_(n[c],t[c],r,e)););}else{for(var s in n)if(g.has(n,s)&&(c++,!(l=g.has(t,s)&&_(n[s],t[s],r,e))))break;if(l){for(s in t)if(g.has(t,s)&&!c--)break;l=!c}}return r.pop(),e.pop(),l};g.isEqual=function(n,t){return _(n,t,[],[])},g.isEmpty=function(n){if(null==n)return!0;if(g.isArray(n)||g.isString(n)||g.isArguments(n))return 0===n.length;for(var t in n)if(g.has(n,t))return!1;return!0},g.isElement=function(n){return!(!n||1!==n.nodeType)},g.isArray=p||function(n){return"[object Array]"==f.call(n)},g.isObject=function(n){return n===Object(n)},g.each(["Arguments","Function","String","Number","Date","RegExp"],function(n){g["is"+n]=function(t){return f.call(t)=="[object "+n+"]"}}),g.isArguments(arguments)||(g.isArguments=function(n){return!(!n||!g.has(n,"callee"))}),"function"!=typeof/./&&(g.isFunction=function(n){return"function"==typeof n}),g.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},g.isNaN=function(n){return g.isNumber(n)&&n!=+n},g.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==f.call(n)},g.isNull=function(n){return null===n},g.isUndefined=function(n){return void 0===n},g.has=function(n,t){return s.call(n,t)},g.noConflict=function(){return n._=t,this},g.identity=function(n){return n},g.constant=function(n){return function(){return n}},g.noop=function(){},g.property=function(n){return function(t){return t[n]}},g.matches=function(n){return function(t){if(null==t)return g.isEmpty(n);if(t===n)return!0;for(var r in n)if(n[r]!==t[r])return!1;return!0}},g.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},g.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},g.now=Date.now||function(){return(new Date).getTime()};var j={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};j.unescape=g.invert(j.escape);var x={escape:new RegExp("["+g.keys(j.escape).join("")+"]","g"),unescape:new RegExp("("+g.keys(j.unescape).join("|")+")","g")};g.each(["escape","unescape"],function(n){g[n]=function(t){return null==t?"":(""+t).replace(x[n],function(t){return j[n][t]})}}),g.result=function(n,t){if(null==n)return void 0;var r=n[t];return g.isFunction(r)?n[t]():r},g.mixin=function(n){g.each(g.functions(n),function(t){var r=g[t]=n[t];g.prototype[t]=function(){var n=[this._wrapped];return o.apply(n,arguments),S.call(this,r.apply(g,n))}})};var A=0;g.uniqueId=function(n){var t=++A+"";return n?n+t:t},g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var k=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},E=/\\|'|\r|\n|\u2028|\u2029/g,O=function(n){return"\\"+F[n]};g.template=function(n,t,r){r=g.defaults({},r,g.templateSettings);var e=new RegExp([(r.escape||k).source,(r.interpolate||k).source,(r.evaluate||k).source].join("|")+"|$","g"),u=0,i="__p+='";n.replace(e,function(t,r,e,a,o){return i+=n.slice(u,o).replace(E,O),u=o+t.length,r?i+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":a&&(i+="';\n"+a+"\n__p+='"),t}),i+="';\n",r.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var a=new Function(r.variable||"obj","_",i)}catch(o){throw o.source=i,o}if(t)return a(t,g);var c=function(n){return a.call(this,n,g)},l=r.variable||"obj";return c.source="function("+l+"){\n"+i+"}",c},g.chain=function(n){return g(n).chain()};var S=function(n){return this._chain?g(n).chain():n};g.mixin(g),g.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=u[n];g.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],S.call(this,r)}}),g.each(["concat","join","slice"],function(n){var t=u[n];g.prototype[n]=function(){return S.call(this,t.apply(this._wrapped,arguments))}}),g.extend(g.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return g})}).call(this)});